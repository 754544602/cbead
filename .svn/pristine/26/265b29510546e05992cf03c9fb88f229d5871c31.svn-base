var beforeApprListQuery={thisDate:"",init:function(){$("#beforeApprListQuery").css("min-height",$(window).height()-16);beforeApprListQuery.events();$("#startDate").calendar({controlId:"startTime",nowData:true,upperLimit:$("#endDate"),speed:0,callback:function(){}});$("#endDate").calendar({controlId:"endTime",nowData:true,lowerLimit:$("#startDate"),speed:0,callback:function(){}});beforeApprListQuery.thisDate=$("#endDate").val();$("#startDate").val(beforeApprListQuery.thisDate.substring(0,beforeApprListQuery.thisDate.length-2)+"01");beforeApprListQuery.tablePage();beforeApprListQuery.goDetails()},events:function(){$(".sort-btn-list").on("click",".date-sort-btn",function(){var thisBtn=$(this);$(".sort-btn-list button").removeClass("sort-btn-style");thisBtn.toggleClass("sort-btn-style");});$(".sort-btn-list").on("click",".applymoney-sort-btn",function(){var thisBtn=$(this);$(".sort-btn-list button").removeClass("sort-btn-style");thisBtn.toggleClass("sort-btn-style");});$(".sort-btn-list").on("click",".adjustmoney-sort-btn",function(){var thisBtn=$(this);$(".sort-btn-list button").removeClass("sort-btn-style");thisBtn.toggleClass("sort-btn-style");});$(".radio-input-list .yt-radio input").change(function(){beforeApprListQuery.tablePage()});$(".sort-btn-list button").click(function(){var property="";property=$(this).val();beforeApprListQuery.tablePage(property)});$("#heardSearchBtn").click(function(){beforeApprListQuery.tablePage()});$("#resetBtn").click(function(){$(".query-text").val("");$("#startDate").val(beforeApprListQuery.thisDate.substring(0,beforeApprListQuery.thisDate.length-2)+"01");$("#endDate").val(beforeApprListQuery.thisDate);$(".date-sort-btn,.applymoney-sort-btn,.adjustmoney-sort-btn").removeClass("sort-btn-style");$(".radio-input-list input").parent("label").removeClass("check");$(".radio-input-list .yt-radio input:checked").val('');beforeApprListQuery.tablePage()})},tablePage:function(property){var inputCheck=$(".radio-input-list .yt-radio input:checked").val();var queryStateParams=$(".radio-input-list .yt-radio input:checked").val();var startDate=$("#startDate").val();var endDate=$("#endDate").val();var queryParams=$(".query-text").val();$('.before-table-page').pageInfo({pageIndex:1,pageNum:15,pageSize:5,url:"sz/advanceAppUpdate/getTotalAdvanceAppQueryByParams",type:"post",async:false,data:{queryStateParams:queryStateParams,queryParams:queryParams,startDate:startDate,endDate:endDate,property:property,direction:"DESC",costType:"TRAIN_APPLY"},success:function(data){var htmlTbody=$('.before-apply-table .yt-tbody');var trStr="";if(data.flag==0){var datas=data.data.rows;if(datas.length>0){$('.before-table-page').show();$("#allAmount").text($yt_baseElement.fmMoney(data.data.allAmount));$.each(datas,function(i,n){trStr+='<tr><td><a class="yt-link go-details">'+n.appNum+'</a><input type="hidden" class="hid-advance-id" value="'+n.appId+'"></td><td style="text-align: left;">'+n.appName+'</td><td>'+n.costTypeName+'</td><td style="text-align: right;">'+$yt_baseElement.fmMoney(n.totalAmount)+'</td><td>'+n.applicantUserName+'</td><td>'+n.applicantDept+'</td><td>'+n.applicateTime+'</td></tr>'});htmlTbody.html(trStr)}else{$('.before-table-page').hide();htmlTbody.html(sysCommon.noDataTrStr(9))}}},isSelPageNum:true })},goDetails:function(){$(".before-apply-table").off("click").on('click','.go-details',function(){$yt_baseElement.eventStopPageaction();var advanceId=$(this).parents('tr').find('.hid-advance-id').val();var pageUrl="view/system-sasac/expensesReim/module/beforehand/beforeApplyDetail.html?advanceId="+advanceId;$yt_baseElement.openNewPage(2,pageUrl)})}};$(function(){beforeApprListQuery.init()});