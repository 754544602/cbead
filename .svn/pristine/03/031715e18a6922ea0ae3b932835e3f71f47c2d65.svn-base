var ticketOpenInfo={init:function(){ticketOpenInfo.getClassInfo();$(".tab-title-list button").click(function(){$(this).addClass("active").siblings().removeClass("active");operate=$(this).text();if(operate=="• 项目开票"){$('.bill-div').show();$('.class-div').hide();ticketOpenInfo.getPlanListInfo();ticketOpenInfo.getPersonListInfo()};if(operate=="• 班级信息"){$('.class-div').show();$('.bill-div').hide();ticketOpenInfo.getClassInfo()}});$('.page-return-btn').on('click',function(){window.location.href="ticketOpenList.html"});$(".search-btn").click(function(){ticketOpenInfo.getPersonListInfo()});$('.edit-bill-info').click(function(){ticketOpenInfo.clearBillInfoAlert();ticketOpenInfo.trainOrcompanyIsCheck();$('#project-states').niceSelect();var checkTrueOrFalse=$('.hid-project-code').val();if(checkTrueOrFalse!=""){var allCheck;var projectCode=$('.hid-project-code').val();var types=$('.hid-types').val();if(types==1){allCheck=$('.company-list tbody').find('.check')}else{allCheck=$('.trainee-bill-table tbody').find('.check')}if(allCheck.length==1){var traineeOrGroupId=$('.hid-trainee-or-group-id').val();ticketOpenInfo.getCompanyInfo(projectCode,types,traineeOrGroupId);ticketOpenInfo.billingInfoAlert()}else{$yt_alert_Model.prompt("请选中一行数据进行操作",2000)}}else{$yt_alert_Model.prompt("请选中一行数据进行操作",2000)}});$('.write-bill-btn').click(function(){ticketOpenInfo.trainOrcompanyIsCheck();ticketOpenInfo.clearWriteBillAlert();$('.duty-invoiceOrder-type').niceSelect();var checkTrueOrFalse=$('.hid-project-code').val();var types=$('.hid-types').val();if(checkTrueOrFalse!=""){var allCheck;if(types==1){allCheck=$('.company-list tbody').find('.check')}else{allCheck=$('.trainee-bill-table tbody').find('.check')};if(allCheck.length==1){ticketOpenInfo.writeBillingAlert();$('#project-states').niceSelect()}else{$yt_alert_Model.prompt("请选中一行数据进行操作",2000)}}else{$yt_alert_Model.prompt("请选中一行数据进行操作",2000)}});$('.duty-sure-btn-table ').on('click','.duty-sure-btn',function(){var projectCode=$('.hid-project-code').val();var types=$('.hid-types').val();var traineeOrGroupId=$('.hid-trainee-or-group-id').val();var orderNum=$('.hid-order-num').val();ticketOpenInfo.addDutyInfo(projectCode,types,traineeOrGroupId,orderNum)});$('.iduty-invoice-number').blur(function(){var count=$('.iduty-invoice-number').val();var price=$('.iduty-invoice-unit-price').val();if(count!=""&&price!=""){ticketOpenInfo.getTaxRate()}});$('.iduty-invoice-unit-price').blur(function(){var count=$('.iduty-invoice-number').val();var price=$('.iduty-invoice-unit-price').val();if(count!=""&&price!=""){ticketOpenInfo.getTaxRate()}});$('.iduty-tuition').blur(function(){var tuition=$('.iduty-tuition').val();if(tuition!=""){ticketOpenInfo.getTaxRate()}});$('.duty-invoiceOrder-type').change(function(){ticketOpenInfo.getTaxRate()});$('.merge-bill-btn').click(function(){var btnType=$(this).find('.hid-merge').val();ticketOpenInfo.mergeBillFn(btnType)});$('.separate-bill-btn').click(function(){var btnType=$(this).find('.hid-separate').val();ticketOpenInfo.mergeBillFn(btnType);ticketOpenInfo.getPlanListInfo();ticketOpenInfo.getPersonListInfo()});$('.edit-remark-btn').click(function(){ticketOpenInfo.trainOrcompanyIsCheck();var types=$('.hid-types').val();var allCheck;if(types==1){allCheck=$('.company-list tbody input[type=checkbox]:checked')}else{allCheck=$('.trainee-bill-table tbody input[type=checkbox]:checked')};if(allCheck.length==1){var remark=allCheck.parent().parent().parent().find('.invoice-remarks');$('.edit-remark .remark-text').val(remark.text());ticketOpenInfo.editRemarkAlert()}else{$yt_alert_Model.prompt("请选中一行数据进行操作",2000)}});$(".bill-btn-div").on('click','.search-person-btn',function(){ticketOpenInfo.getPersonListInfo()});$('.remark-btn-box').on('click','.remark-sure-btn',function(){ticketOpenInfo.invoiceRemarksFn();ticketOpenInfo.getPlanListInfo();ticketOpenInfo.getPersonListInfo()});$('.company-list').on('click','.look-info',function(){var projectCode=$yt_common.GetQueryString("projectCode");var types=$(this).parent().parent().find('.types').val();var traineeOrGroupId=$(this).parent().parent().find('.trainee-or-group-id').val();ticketOpenInfo.lookBiilInfo(projectCode,types,traineeOrGroupId);ticketOpenInfo.lookBillingInfoAlert()});$('.class-tbody').off().on('click','.look-info',function(){var projectCode=$yt_common.GetQueryString("projectCode");var types=$(this).parent().parent().find('.types').val();var traineeOrGroupId=$(this).parent().parent().find('.trainee-or-group-id').val();ticketOpenInfo.lookBiilInfo(projectCode,types,traineeOrGroupId);ticketOpenInfo.lookBillingInfoAlert()});$(".invoice-export").on("click",function(){var projectCode=$('.hid-project-code').val();var selectParam=$('#keyword').val();var downUrl=$yt_option.base_path+"finance/projectInvoice/downloadProjectInvoice";$.ajaxDownloadFile({url:downUrl,data:{projectCode:projectCode,selectParam:selectParam,checkInState:"",isAdmission:"",invoiceStates:"",isDownload:true}})});$('.trainee-bill-table').off().on('click','.invoice-org-href',function(){var traineeId=$(this).parent().parent().find('.trainee-or-group-id').val();var headImg=new Image();var projectCode=$yt_common.GetQueryString("projectCode");$yt_baseElement.showLoading();$.ajax({type:"post",url:$yt_option.base_path+"finance/projectInvoice/getTraineeDetails",data:{traineeId:traineeId,projectId:projectCode},async:true,success:function(data){var htmlBody=$('.student-details-form .student-details-train-record tbody');var htmlTrs='';htmlBody.empty();if(data.flag==0){detailsMsg=data.data;detailsMsg.checkInDate=detailsMsg.checkInDate.split(" ")[0];if(detailsMsg.gender==1){detailsMsg.gender="男"}else{detailsMsg.gender="女"}if(detailsMsg.invoiceType==0){detailsMsg.invoiceType="暂不开票"}else if(detailsMsg.invoiceType==1){detailsMsg.invoiceType="普通发票"}else{detailsMsg.invoiceType="增值税发票"}if(detailsMsg.checkInState==0){detailsMsg.checkInState="未报到"}else{detailsMsg.checkInState="已报到"}if(detailsMsg.paymentState==0){detailsMsg.paymentState="未缴费"}else{detailsMsg.paymentState="已缴费"}if(detailsMsg.isOrderNum==0){detailsMsg.isOrderNum="未开票"}else{detailsMsg.isOrderNum="已开票"}$('.student-details-form .cont-edit-test').setDatas(detailsMsg);if(detailsMsg.headPortrait!=""){headImg.src=detailsMsg.headPortraitUrl;headImg.onload=function(){$('.student-details-img').attr('src',headImg.src);$('.student-details-img').jqthumb({width:89,height:130})}}else{$('.student-details-img').attr('src','../../resources/images/classStudent/student-picture.png');$('.student-details-img').jqthumb({width:89,height:130})}$yt_baseElement.hideLoading()}$yt_baseElement.hideLoading()}});$(".student-details-form").show();$yt_alert_Model.setFiexBoxHeight($(".student-details-form .yt-edit-alert-main"));$yt_alert_Model.getDivPosition($(".student-details-form"));$yt_model_drag.modelDragEvent($(".student-details-form .yt-edit-alert-title"));$('.student-details-form .yt-eidt-model-bottom .yt-model-sure-btn').off().on("click",function(){$(".student-details-form").hide()})});$(".yt-eidt-model-bottom").on('click','.sreduction-details-sure-btn',function(){ticketOpenInfo.savebillingInf()})},lookBiilInfo:function(projectCode,types,traineeOrGroupId){$.ajax({type:"post",url:$yt_option.base_path+"finance/projectInvoice/getInvoice",data:{projectCode:projectCode,types:types,traineeOrGroupId:traineeOrGroupId},success:function(data){if(data.flag==0){if(data.data!=null){$('.look-bill-info-table .invoice-model-info').text(data.data.invoiceModel);$('.look-bill-info-table .org-name-info').text(data.data.orgName);$('.look-bill-info-table .tax-number-info').text(data.data.taxNumber);$('.look-bill-info-table .address-info').text(data.data.address);$('.look-bill-info-table .telephone-info').text(data.data.telephone);$('.look-bill-info-table .registered-bank-info').text(data.data.registeredBank);$('.look-bill-info-table .account-info').text(data.data.account)}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading()}}})},invoiceRemarksFn:function(){var projectCode=$yt_common.GetQueryString("projectCode");var types=$('.hid-types').val();var traineeOrGroupIds=$('.hid-trainee-or-group-id').val();var invoiceRemarks=$('.edit-remark .remark-text').val();$yt_baseElement.showLoading();$.ajax({type:"post",url:$yt_option.base_path+"finance/projectInvoice/updateInvoiceRemarks",data:{projectCode:projectCode,types:types,traineeOrGroupId:traineeOrGroupIds,invoiceRemarks:invoiceRemarks},success:function(data){if(data.flag==0){$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading()}}})},mergeBillFn:function(btnType){ticketOpenInfo.trainOrcompanyIsCheck();var projectCode=$yt_common.GetQueryString("projectCode");var types=$('.hid-types').val();var traineeOrGroupIds=$('.hid-trainee-or-group-id').val();$yt_baseElement.showLoading();$.ajax({type:"post",url:$yt_option.base_path+"finance/projectInvoice/updateInvoiceOrderNum",data:{projectCode:projectCode,types:types,traineeOrGroupIds:traineeOrGroupIds,orderNumType:btnType},success:function(data){if(data.flag==0){$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading()}}})},clearBillInfoAlert:function(){$('#project-states').val("");$('.orgName').val("");$('.taxNumber').val();$('.address').val("");$('.telephone').val();$('.registeredBank').val("");$('.account').val("")},clearWriteBillAlert:function(){$('.duty-org-name').val("");$('.duty-tax-number').val("");$('.duty-telephone').val("");$('.duty-address').val("");$('.duty-registered-bank').val("");$('.duty-account').val("");$('.iduty-specification-model').val("");$('.iduty-invoice-group').val("");$('.iduty-invoice-number').val("");$('.iduty-invoice-unit-price').val("");$('.iduty-tuition').val("");$('.taxt-rat').text("");$('.taxt-rat-money').text("")},getTaxRate:function(){var invoiceOrderType=$('.duty-invoiceOrder-type').val();var count=$('.iduty-invoice-number').val();var price=$('.iduty-invoice-unit-price').val();var tuition=$('.iduty-tuition').val();if((count!=""&&price!="")||tuition!=""){if(tuition==""){$('.iduty-tuition').val(count*price);tuition=$('.iduty-tuition').val()}var ratMoney=$('.taxt-rat-money');if(invoiceOrderType==1){$('.taxt-rat').text("3%");$('.taxt-rat-money').text((0.03*tuition).toFixed(2))}else if(invoiceOrderType==2){$('.taxt-rat').text("6%");$('.taxt-rat-money').text((0.06*tuition).toFixed(2))}else if(invoiceOrderType==3){$('.taxt-rat').text("6%");$('.taxt-rat-money').text((0.06*tuition).toFixed(2))}else if(invoiceOrderType==4){$('.taxt-rat').text("3%");$('.taxt-rat-money').text((0.03*tuition).toFixed(2))}else if(invoiceOrderType==5){$('.taxt-rat').text("3%");$('.taxt-rat-money').text((0.03*tuition).toFixed(2))}else{$('.taxt-rat').text("6%");$('.taxt-rat-money').text((0.06*tuition).toFixed(2))}}},trainOrcompanyIsCheck:function(){var checkTrueOrFalse="";var check;var company=$('.company-list tbody tr').find('.check');var trainee=$('.trainee-bill-table tbody tr').find('.check');var companyLen=company.length;var traineeLen=trainee.length;if(companyLen>0){checkTrueOrFalse=1;check=company}else if(traineeLen>0){checkTrueOrFalse=1;check=trainee}else if(companyLen>0&&traineeLen>0){$yt_alert_Model.prompt("请选中一行数据进行操作",3000)}else{$yt_alert_Model.prompt("请选中一行数据进行操作",3000)}if(check!=undefined){var projectCode=$yt_common.GetQueryString("projectCode");var types=check.parent().find('.types').val();var orderNum=check.parent().find('.order-num').val();var traineeOrGroupId="";$.each(check,function(i,v){if(traineeOrGroupId==""){traineeOrGroupId=$(v).parent().find('.trainee-or-group-id').val()}else{traineeOrGroupId+=','+$(v).parent().find('.trainee-or-group-id').val()}});$('.hid-project-code').val(projectCode);$('.hid-types').val(types);$('.hid-order-num').val(orderNum);$('.hid-trainee-or-group-id').val(traineeOrGroupId);$('.hid-check-true-or-false').val(checkTrueOrFalse)}},addDutyInfo:function(projectCode,types,traineeOrGroupId,orderNum){var invoiceType=$('.write-bill-table .invoice-type-td').find('.check').children().val();var invoiceModel=$('.write-bill-table .invoice-model-td').find('.check').children().val();var orgName=$('.duty-org-name').val();var taxNumber=$('.duty-tax-number').val();var telephone=$('.duty-telephone').val();var address=$('.duty-address').val();var registeredBank=$('.duty-registered-bank').val();var account=$('.duty-account').val();var invoiceOrderType=$('.duty-invoiceOrder-type').val();var invoiceSpecificationModel=$('.iduty-specification-model').val();var invoiceGroup=$('.iduty-invoice-group').val();var invoiceNumber=$('.iduty-invoice-number').val();var invoiceUnitPrice=$('.iduty-invoice-unit-price').val();var tuition=$('.iduty-tuition').val();var orderReamrks="";$yt_baseElement.showLoading();$.ajax({type:"post",url:$yt_option.base_path+"finance/projectInvoice/addInvoice",data:{projectCode:projectCode,types:types,traineeOrGroupId:traineeOrGroupId,orderNum:orderNum,invoiceType:invoiceType,invoiceType:invoiceType,orgName:orgName,taxNumber:taxNumber,telephone:telephone,address:address,registeredBank:registeredBank,account:account,invoiceOrderType:invoiceOrderType,invoiceSpecificationModel:invoiceSpecificationModel,invoiceGroup:invoiceGroup,invoiceNumber:invoiceNumber,invoiceUnitPrice:invoiceUnitPrice,tuition:tuition,orderReamrks:orderReamrks},success:function(data){if(data.flag==0){$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading()}}})},writeBillingAlert:function(){$(".write-billing-alert").show();$yt_alert_Model.setFiexBoxHeight($(".write-billing-alert .alert-form"));$yt_alert_Model.getDivPosition($(".write-billing-alert"));$yt_model_drag.modelDragEvent($(".write-billing-alert .yt-edit-alert-title"));$('.write-billing-alert .yt-eidt-model-bottom .yt-model-canel-btn').off().on("click",function(){$(".write-billing-alert").hide();$("#pop-modle-alert").hide()});$('.write-billing-alert .yt-eidt-model-bottom .yt-model-sure-btn').off().on("click",function(){$(".write-billing-alert").hide();$("#pop-modle-alert").hide()})},getCompanyInfo:function(projectCode,types,traineeOrGroupId){$.ajax({type:"post",url:$yt_option.base_path+"finance/projectInvoice/getInvoice",data:{projectCode:projectCode,types:types,traineeOrGroupId:traineeOrGroupId},success:function(data){if(data.flag==0){if(data.data!=null){$('.write-bill-info-table .invoiceModel').setSelectVal(data.data.invoiceModel);$('.write-bill-info-table .orgName').val(data.data.orgName);$('.write-bill-info-table .taxNumber').val(data.data.taxNumber);$('.write-bill-info-table .address').val(data.data.address);$('.write-bill-info-table .telephone').val(data.data.telephone);$('.write-bill-info-table .registeredBank').val(data.data.registeredBank);$('.write-bill-info-table .account').val(data.data.account);$('.edit-bill-div .hid-invoice-id').val(data.data.invoiceId)}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading()}}})},savebillingInf:function(){$yt_baseElement.showLoading();var types=$('.hid-types').val();var projectCode=$yt_common.GetQueryString("projectCode");var invoiceModel=$('.write-bill-info-table .invoiceModel').val();var orgName=$('.write-bill-info-table .orgName').val();var taxNumber=$('.write-bill-info-table .taxNumber').val();var address=$('.write-bill-info-table .address').val();var telephone=$('.write-bill-info-table .telephone').val();var registeredBank=$('.write-bill-info-table .registeredBank').val();var account=$('.write-bill-info-table .account').val();var traineeOrGroupId=$('.hid-trainee-or-group-id').val();var invoiceId=$('.hid-invoice-id').val();$.ajax({type:"post",url:$yt_option.base_path+"finance/projectInvoice/updateInvoice",data:{projectCode:projectCode,types:types,traineeOrGroupId:traineeOrGroupId,invoiceId:invoiceId,invoiceModel:invoiceModel,orgName:orgName,taxNumber:taxNumber,address:address,telephone:telephone,registeredBank:registeredBank,account:account},success:function(data){if(data.flag==0){$yt_alert_Model.prompt("保存成功");$yt_baseElement.hideLoading()}else{$yt_alert_Model.prompt("保存失败");$yt_baseElement.hideLoading()}}})},editRemarkAlert:function(){$(".edit-remark-alert").show();$yt_alert_Model.setFiexBoxHeight($(".edit-remark-alert .alert-form"));$yt_alert_Model.getDivPosition($(".edit-remark-alert"));$yt_model_drag.modelDragEvent($(".edit-remark-alert .yt-edit-alert-title"));$('.edit-remark-alert .yt-eidt-model-bottom .yt-model-canel-btn').off().on("click",function(){$(".edit-remark-alert").hide();$("#pop-modle-alert").hide()});$('.edit-remark-alert .yt-eidt-model-bottom .yt-model-sure-btn').off().on("click",function(){$(".edit-remark-alert").hide();$("#pop-modle-alert").hide()})},lookBillingInfoAlert:function(){$(".look-billing-inf-alert").show();$yt_alert_Model.setFiexBoxHeight($(".look-billing-inf-alert .alert-form"));$yt_alert_Model.getDivPosition($(".look-billing-inf-alert"));$yt_model_drag.modelDragEvent($(".look-billing-inf-alert .yt-edit-alert-title"));$('.look-billing-inf-alert .yt-eidt-model-bottom .yt-model-canel-btn').off().on("click",function(){$(".look-billing-inf-alert").hide();$("#pop-modle-alert").hide()});$('.look-billing-inf-alert .yt-eidt-model-bottom .yt-model-sure-btn').off().on("click",function(){$(".look-billing-inf-alert").hide();$("#pop-modle-alert").hide()})},billingInfoAlert:function(){$(".billing-inf-alert").show();$yt_alert_Model.setFiexBoxHeight($(".billing-inf-alert .alert-form"));$yt_alert_Model.getDivPosition($(".billing-inf-alert"));$yt_model_drag.modelDragEvent($(".billing-inf-alert .yt-edit-alert-title"));$('.billing-inf-alert .yt-eidt-model-bottom .yt-model-canel-btn').off().on("click",function(){$(".billing-inf-alert").hide();$("#pop-modle-alert").hide()});$('.billing-inf-alert .yt-eidt-model-bottom .yt-model-sure-btn').off().on("click",function(){$(".billing-inf-alert").hide();$("#pop-modle-alert").hide()})},getPlanListInfo:function(){var projectCode=$yt_common.GetQueryString("projectCode");$.ajax({async:true,url:$yt_option.base_path+"finance/projectInvoice/getInvoiceToGroup",type:"post",data:{projectCode:projectCode},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){var htmlTbody=$('.ticket-open-tbody');var htmlTr='';var projectType;var orderNum="0";var rowSpanNum=1;var lastTr;if(data.data!=""){$(htmlTbody).empty();$.each(data.data,function(i,v){if(v.invoiceStates==1){v.invoiceStates="未开票"}else{v.invoiceStates="已开票"}if(v.isAdmission==0){v.isAdmission="未确认"}else{v.isAdmission="已确认"}htmlTr='<tr><td><input type="hidden" class="types" value="1"/><input type="hidden" class="order-num" value="'+v.orderNum+'"/><input type="hidden" class="trainee-or-group-id" value="'+v.groupId+'"/><label class="check-label yt-checkbox label-list"><input type="checkbox" name="test" class=""/></label></td><td class="groupName" style="text-align:left"><a style="color: #3c4687;" class="project-code-href">'+v.groupName+'</a></td><td class="trainingExpenseNegotiatedPrice list-td" style="text-align:right;">'+v.trainingExpenseNegotiatedPrice+'</td><td class="list-td"><a style="color: #3c4687;" class="look-info look-stu-info look">查看</a></td></tr>';if(orderNum!=v.orderNum){$('.class-tbody tr').eq(lastTr).find("td").eq(4).attr("rowSpan",rowSpanNum);$('.class-tbody tr').eq(lastTr).find("td").eq(5).attr("rowSpan",rowSpanNum);lastTr=i;orderNum=v.orderNum;htmlTr+='<td class="isAdmission">'+v.isAdmission+'</td><td class="invoiceStates invoice-states list-td">'+v.invoiceStates+'</td>';rowSpanNum=1}else{rowSpanNum+=1}htmlTr+='<td class="orderReamrks list-td" style="width: 118px;overflow: hidden;text-align: left;">'+v.orderReamrks+'</td></tr>';htmlTbody.append(htmlTr)});$('.class-tbody tr').eq(lastTr).find("td").eq(4).attr("rowSpan",rowSpanNum);$('.class-tbody tr').eq(lastTr).find("td").eq(5).attr("rowSpan",rowSpanNum)}else{$(htmlTbody).empty();htmlTr='<tr style="border:0px;background-color:#fff !important;" ><td colspan="7" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';htmlTbody.append(htmlTr)}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},})},getPersonListInfo:function(){var invoiceStates="";var checkBtn=$('.bill-btn-div .check-search input[type=checkbox]:checked');var len=checkBtn.length;if(len==1){invoiceStates=checkBtn.val()}var projectCode=$yt_common.GetQueryString("projectCode");var selectParam=$("#keyword").val();$('.class-page').pageInfo({async:true,pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"finance/projectInvoice/getInvoiceToTrainee",type:"post",data:{projectCode:projectCode,selectParam:selectParam,invoiceStates:invoiceStates},before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){var htmlTbody=$('.class-tbody');var htmlTr='';var invoiceType;var orderNum="0";var rowSpanNum=1;var lastTr;if(data.data.rows.length>0){$(htmlTbody).empty();$.each(data.data.rows,function(i,v){if(v.checkInState==0){v.checkInState="未报到"}else if(v.checkInState==1){v.checkInState="已报到"}else{v.checkInState=""}if(v.invoiceStates==1){v.invoiceStates="未开票"}else if(v.invoiceStates==2){v.invoiceStates="已开票"}else{v.invoiceStates=""}if(v.isAdmission==0){v.isAdmission="未对账"}else if(v.isAdmission==1){v.isAdmission="已对账"}else{v.isAdmission=""}htmlTr='<tr><td><input type="hidden" class="types" value="2"/><input type="hidden" class="trainee-or-group-id" value="'+v.traineeId+'"/><input type="hidden" class="order-num" value="'+v.orderNum+'"/><input type="hidden" class="project-code" value="'+v.projectCode+'"/><label class="check-label yt-checkbox label-list" style="margin-left:7px"><input type="checkbox" name="test"/></label></td><td class = "group-num"><input type="hidden" class="types" value="2"/>'+v.groupNum+'</td><td style="text-align:left;" class="real-name"><a style="color: #3c4687;" class="invoice-org-href">'+v.realName+'</a></td><td class="room-number">'+v.roomNumber+'</td><td class="phone" >'+v.phone+'</td><td class="group-name" style="text-align:left">'+v.groupName+'</td><td class="group-org-name" style="text-align:left">'+v.groupOrgName+'</td><td><a style="color: #3c4687;" class="look-info">查看</a></td>';if(orderNum!=v.orderNum){$('.class-tbody tr').eq(lastTr).find("td").eq(8).attr("rowSpan",rowSpanNum);$('.class-tbody tr').eq(lastTr).find("td").eq(9).attr("rowSpan",rowSpanNum);lastTr=i;orderNum=v.orderNum;htmlTr+='<td class="checkIn-state rowspan-td">'+v.checkInState+'</td><td class="is-admission rowspan-td">'+v.isAdmission+'</td>';rowSpanNum=1}else{rowSpanNum+=1}htmlTr+='<td class="invoice-states">'+v.invoiceStates+'</td><td class="invoice-remarks" style="width: 118px;overflow: hidden;text-align: left;">'+v.invoiceRemarks+'</td></tr>';htmlTbody.append(htmlTr)});$('.class-tbody tr').eq(lastTr).find("td").eq(8).attr("rowSpan",rowSpanNum);$('.class-tbody tr').eq(lastTr).find("td").eq(9).attr("rowSpan",rowSpanNum)}else{$(htmlTbody).empty();htmlTr='<tr style="border:0px;background-color:#fff !important;" ><td colspan="12" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';htmlTbody.append(htmlTr)}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},isNotEmpty:function(){var invoiceNumber=$('.invoice-number').val();var invoiceValue=$('.invoice-value').val();if(invoiceNumber==""&&invoiceValue==""){$yt_valid.validForm($(".edit-bill-info-table"))}else{}},getClassInfo:function(){var projectCode=$yt_common.GetQueryString("projectCode");$yt_baseElement.showLoading();$.ajax({type:"post",url:$yt_option.base_path+"class/getBeanByProjectCode",async:true,data:{projectCode:projectCode},objName:'data',success:function(data){if(data.flag==0){if(data.data.projectType==1){data.data.projectType="计划"}else if(data.data.projectType==2){data.data.projectType="委托"}else if(data.data.projectType==3){data.data.projectType="选学"}else if(data.data.projectType==4){data.data.projectType="调训"}$('.project-code').text(data.data.projectCode);$('.project-name').text(data.data.projectName);$('.project-type').text(data.data.projectType);$('.project-sell').text(data.data.projectSell);$('.start-date').text(data.data.startDate);$('.end-date').text(data.data.endDate);$('.train-date').text(data.data.trainDate);$('.customer-unit').text(data.data.customerUnit);$('.customer-dept').text(data.data.customerDept);$('.customer-linkman').text(data.data.customerLinkman);$('.customer-linkman-position').text(data.data.customerLinkmanPosition);$('.customer-linkman-phone').text(data.data.customerLinkmanPhone);$('.customer-linkman-cellphone').text(data.data.customerLinkmanCellphone);$('.customer-linkman-fax').text(data.data.customerLinkmanFax);$('.customer-linkman-email').text(data.data.customerLinkmanEmail);$('.customer-trainee-position').text(data.data.customerTraineePosition);$('.customer-trainee-sum').text(data.data.customerTraineeSum);$('.customer-trainee-age-structure').text(data.data.customerTraineeAgeStructure);$('.customer-target-demand').text(data.data.customerTargetDemand);$('.project-head').text(data.data.projectHead);$('.class-teacher').text(data.data.classTeacher);$('.project-aid').text(data.data.projectAid);$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}}})}};$(function(){ticketOpenInfo.init()});