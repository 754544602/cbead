/**
 * 满意度评分汇总（选学）
 */
var quList={init:function(){quList.getClassDetails();quList.demoSatisfaction();quList.getDetailsExportList();quList.getOriginalExportList();quList.look();quList.addContentText();$(".tab-title-list button").click(function(){$(this).addClass("active").siblings().removeClass("active");$(".details-box .original-box").hide().eq($(this).index()).show();if($(this).index()==0){quList.addContentText();$("div.pro-info-title,div.pro-info-content").show();$(".summary-box").show();$(".details-box").hide();$(".original-box").hide();quList.demoSatisfaction()}else if($(this).index()==1){$("div.pro-info-title,div.pro-info-content").hide();$(".details-box").show();$(".summary-box").hide();$(".original-box").hide();$("input[type=checkbox][name='test']").setCheckBoxState("check");quList.getDetailsList();}else if($(this).index()==2){$("div.pro-info-title,div.pro-info-content").hide();$(".original-box").show();$(".summary-box").hide();$(".details-box").hide();$("input[type=checkbox][name='test2']").setCheckBoxState("check");quList.getOriginalList();}});$('.page-return-btn').off().on('click',function(){window.location.href="projectQualityList.html"});$(".more-tab-btn-end").click(function(){var leftVal=parseInt($(".tab-title-box").css("margin-left"))-120;if($(".tab-title-box").parent().width()>($(".tab-title-box button").last().position().left-120)){$(".more-tab-btn-end").hide();leftVal=(120*$(".tab-title-box button").length-$(".tab-title-box").parent().width()+32)*-1}$(".tab-title-box").css("padding-left","32px").stop(true,true).animate({"margin-left":leftVal},100);$(".more-tab-btn-start").show()});$(".more-tab-btn-start").click(function(){var leftVal=parseInt($(".tab-title-box").css("margin-left"))+120;if(leftVal>=-120){$(this).hide();leftVal=0;$(".tab-title-box").css("padding-left","0")}console.log(leftVal);$(".tab-title-box").stop(true,true).animate({"margin-left":leftVal},100);$(".more-tab-btn-end").show()});$("#searchList").click(function(){quList.getDetailsList()});$("#searchList2").click(function(){quList.getOriginalList()});$(".effective").click(function(){var bool=quList.updateEffective($('.effective').val());if(bool){quList.refreshEffective()}});$(".invalid").click(function(){var bool=quList.updateEffective($('.invalid').val());if(bool){quList.refreshEffective()}});$('.details-box .search-btn-slect input[type=checkbox]').change(function(){quList.getDetailsList()});$('.original-box .search-btn-slect input[type=checkbox]').change(function(){quList.getOriginalList()});$('.class-tbody2').off('click').on('click','tr',function(){var thisClass=$(this)[0].className;$("."+thisClass).addClass('yt-table-active').siblings().removeClass('yt-table-active');console.log('thisClass',thisClass)})},getClassDetails:function(){var pkId=$yt_common.GetQueryString("pkId");$.ajax({type:"post",url:$yt_option.base_path+"project/getBeanById",data:{pkId:pkId},async:true,success:function(data){if(data.flag==0){if(data.data.projectType==1){data.data.projectType="计划"}else if(data.data.projectType==2){data.data.projectType="委托"}else if(data.data.projectType==3){data.data.projectType="选学"}else{data.data.projectType="调训"}$(".proje-details-div").setDatas(data.data)}else{}}})},look:function(){var projectCode=$yt_common.GetQueryString("projectCode");$.ajax({type:"post",url:$yt_option.base_path+"class/questionnaire/lookForAll",async:true,beforeSend:function(){$yt_baseElement.showLoading()},data:{selectParam:projectCode,pageIndexs:1,pageNum:15},success:function(data){$('.project-name').text(data.data.rows[0].projectName);$yt_baseElement.hideLoading()},error:function(data){$yt_baseElement.hideLoading();$yt_alert_Model.prompt('网络异常')}})},demoSatisfaction:function(){var xAxisList=[];var seriesList=[];var projectCode=$yt_common.GetQueryString("projectCode");var downUrl=$yt_option.base_path+"class/questionnaire/getChartBySelection";$yt_baseElement.showLoading();$.post(downUrl,{'projectCode':projectCode},function(data){if(data.flag==0){var wholeSatisfaction=0;if(data.data.satisfaction.wholeSatisfaction[0]!=undefined){$.each(data.data.satisfaction.wholeSatisfaction,function(i,n){wholeSatisfaction+=Number(n.enterpriseAverage)});wholeSatisfaction=(wholeSatisfaction/Number(data.data.satisfaction.wholeSatisfaction.length)).toFixed(2)}$.each(data.data.radarChart.columnCode,function(k,v){xAxisList.push({name:v,max:100})});seriesList=$.map(data.data.radarChart.columnFraction,function(n,i){return(Number(n).toFixed(2))});var myChart=echarts.init($('.drawing-1').get(0));$('#wholeSatisfaction').html(wholeSatisfaction);var option={backgroundColor:'#ffffff',title:{text:'总体满意度',textStyle:{color:'#111111',fontSize:18,fontWeight:100}},tooltip:{formatter:function(v){var h=v.seriesName+'<br/>';$.each(xAxisList,function(i,n){h+=n.name+':'+v.value[i]+'<br/>'});return h}},legend:{x:'center',top:'10%',textStyle:{color:'#5B5B5B'}},radar:{name:{textStyle:{color:'#333333',fontSize:14}},indicator:xAxisList},series:[{name:'满意度统计',type:'radar',itemStyle:{color:'#847ccf',borderColor:'#847ccf'},lineStyle:{color:'#847ccf'},areaStyle:{color:'#847ccf',opacity:0.5},data:[{value:seriesList}]}]};myChart.setOption(option);quList.demoTrain(data.data);quList.demoTrain2(data.data);quList.demoTrain3(data.data);quList.demoTrain4(data.data);quList.demoTrain5(data.data);quList.demoTrain6(data.data);quList.demoTrain7(data.data);quList.demoTrain8(data.data);setTimeout($yt_baseElement.hideLoading(),500)}});$yt_baseElement.hideLoading()},demoTrain:function(data){var dataList=data.pieChart;var nameList=[];$.each(dataList,function(k,v){nameList.push(v.name)});var myChart=echarts.init($('.drawing-2').get(0));option={backgroundColor:'#ffffff',title:{text:'企业类型人数统计',textStyle:{color:'#111111',fontSize:18,fontWeight:100}},tooltip:{trigger:'item',formatter:"{a} <br/>{b} : {c} ({d}%)"},color:['#847ccf','#df94e0','#b8b3e2'],legend:{orient:'vertical',itemWidth:10,itemHeight:10,top:140,right:50,data:nameList},series:[{name:'企业类型人数统计',type:'pie',radius:['50%','70%'],data:dataList,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:'rgba(0, 0, 0, 0.5)'}},itemStyle:{normal:{label:{show:true,formatter:'{b} : {c} ({d}%)'}},labelLine:{show:true}}}]};myChart.setOption(option)},demoTrain2:function(data){var list1=data.designImplementation.enterpriseData;var list2=data.designImplementation.designImplementationData;var enterpriseName=[];var enterpriseCharts=[];var enterpriseType=[];$.each(list1,function(k,v){enterpriseType.push(v.enterpriseType);enterpriseName.push(v.enterpriseType+":"+v.average);enterpriseCharts.push(v.enterpriseType+"平均满意度："+ +v.userCount+"分")});var chartsType=list2.designImplementationYAxis;var chartsData=list2.designImplementationXAxis;var resultData=[];var colorList=['#847ccf','#df94e0','#b8b3e2'];console.log(list1);$('.every-part:nth-child(4) .average').empty();$.each(list1,function(j,m){$('.every-part:nth-child(4) .average').append('<span class="userCount">'+m.enterpriseType+'平均满意度：<label class="userCount-label">'+m.average+'</label>分</span>')});$.each(chartsData,function(k,v){resultData.push({name:v.enterpriseType,type:'bar',barMaxWidth:17,itemStyle:{normal:{show:true,color:colorList[k]}},label:{show:true,position:'right',color:'#000'},barWidth:17,barGap:"0%",barCategoryGap:"60px",itemStyle:{barBorderRadius:[0,8,8,0]},data:v.enterpriseAverage=$.map(v.enterpriseAverage,function(n,i){return Number(n).toFixed(2)})})});var myChart=echarts.init($('.drawing-3').get(0));option={backgroundColor:'#ffffff',title:{text:'一、学员对培训设计与实施的平均满意度',textStyle:{color:'#111111',fontSize:18,fontWeight:100},top:10,left:'left'},legend:{orient:'vertical',y:'bottom',right:40,itemWidth:10,itemHeight:10,textStyle:{fontSize:14,color:'#555555'},data:enterpriseType},color:['#847ccf','#df94e0','#b8b3e2'],grid:{left:'3%',right:'4%',containLabel:true},tooltip:{show:"true",trigger:'axis',axisPointer:{type:'shadow'}},xAxis:{type:'value',axisTick:{show:true},axisLine:{show:true,lineStyle:{color:'#000'}}},splitLine:{show:true},yAxis:[{type:'category',axisTick:{show:false},axisLine:{show:true,lineStyle:{color:'#000000'}},data:chartsType,axisLabel:{show:true,formatter:function(params){return quList.formatter(params,10)}}},{type:'category',axisLine:{show:false},axisTick:{show:false},axisLabel:{show:false},splitArea:{show:false},splitLine:{show:false},data:chartsType}],series:resultData};myChart.setOption(option)},demoTrain3:function(data){var list1=data.teachingEffect.enterpriseData;var list2=data.teachingEffect.teachingEffectData;var enterpriseName=[];var enterpriseCharts=[];var enterpriseType=[];$.each(list1,function(k,v){enterpriseType.push(v.enterpriseType);enterpriseName.push(v.enterpriseType+":"+v.average);enterpriseCharts.push(v.enterpriseType+v.userCount+"名学员")});var chartsType=list2.teachingEffectYAxis;var chartsData=list2.teachingEffectXAxis;var resultData=[];var colorList=['#847ccf','#df94e0','#b8b3e2'];$('.every-part:nth-child(5) .average').empty();$.each(list1,function(j,m){$('.every-part:nth-child(5) .average').append('<span class="userCount">'+m.enterpriseType+'平均满意度：<label class="userCount-label">'+m.average+'</label>分</span>')});$.each(chartsData,function(k,v){resultData.push({name:v.enterpriseType,type:'bar',barMaxWidth:40,itemStyle:{normal:{show:true,color:colorList[k]}},label:{show:true,position:'right',color:'#000'},barWidth:17,barGap:"0%",barCategoryGap:"60px",itemStyle:{barBorderRadius:[0,8,8,0]},data:v.enterpriseAverage})});var myChart=echarts.init($('.drawing-4').get(0));option={backgroundColor:'#ffffff',title:{text:'二、学员对教师授课效果的平均满意度',textStyle:{color:'#111111',fontSize:18,fontWeight:100},left:'left',top:10},color:['#847ccf','#df94e0','#b8b3e2'],legend:{y:'bottom',right:40,itemWidth:10,itemHeight:10,textStyle:{fontSize:14,color:'#555555'},data:enterpriseType},grid:{left:'3%',right:'4%',containLabel:true},tooltip:{show:"true",trigger:'axis',axisPointer:{type:'shadow'}},xAxis:{type:'value',axisTick:{show:true},axisLine:{show:true,lineStyle:{color:'#000'}},splitLine:{show:true}},yAxis:[{type:'category',axisTick:{show:false},axisLine:{show:true,lineStyle:{color:'#000000'}},axisLabel:{show:true,formatter:function(params){return quList.formatter(params,10)}},data:chartsType},{type:'category',axisLine:{show:false},axisTick:{show:false},axisLabel:{show:false},splitArea:{show:false},splitLine:{show:false},data:chartsType}],series:resultData};myChart.setOption(option)},demoTrain4:function(data){var list1=data.teachingActivites.enterpriseData;var list2=data.teachingActivites.teachingActivitesData;var enterpriseName=[];var enterpriseCharts=[];var enterpriseType=[];$.each(list1,function(k,v){enterpriseType.push(v.enterpriseType);enterpriseName.push(v.enterpriseType+":"+v.average);enterpriseCharts.push(v.enterpriseType+v.userCount+"名学员")});var chartsType=list2.courseName;var chartsData=list2.teachingActivitesXAxis;var resultData=[];var colorList=['#847ccf','#df94e0','#b8b3e2'];$('.every-part:nth-child(6) .average').empty();$.each(list1,function(j,m){$('.every-part:nth-child(6) .average').append('<span class="userCount">'+m.enterpriseType+'平均满意度：<label class="userCount-label">'+m.average+'</label>分</span>')});$.each(chartsData,function(k,v){resultData.push({name:v.enterpriseType,type:'bar',barMaxWidth:40,itemStyle:{normal:{show:true,color:colorList[k]}},label:{show:true,position:'right',color:'#000'},barWidth:17,barGap:"0%",barCategoryGap:"60px",itemStyle:{barBorderRadius:[0,8,8,0]},data:v.enterpriseAverage})});var myChart=echarts.init($('.drawing-5').get(0));option={backgroundColor:'#ffffff',title:{text:'三、学员对教学活动的平均满意度',textStyle:{color:'#111111',fontSize:18,fontWeight:100},top:10,left:'left'},legend:{y:'bottom',right:40,itemWidth:10,itemHeight:10,textStyle:{fontSize:14,color:'#555555'},data:enterpriseType},color:['#847ccf','#df94e0','#b8b3e2'],grid:{left:'3%',right:'4%',containLabel:true},tooltip:{show:"true",trigger:'axis',axisPointer:{type:'shadow'}},xAxis:{type:'value',axisTick:{show:true},axisLine:{show:true,lineStyle:{color:'#000'}},splitLine:{show:true}},yAxis:[{type:'category',axisTick:{show:false},axisLine:{show:true,lineStyle:{color:'#000000'}},axisLabel:{show:true,formatter:function(params){return quList.formatter(params,10)}},data:chartsType},{type:'category',axisLine:{show:false},axisTick:{show:false},axisLabel:{show:false},splitArea:{show:false},splitLine:{show:false},data:chartsType}],series:resultData};myChart.setOption(option)},demoTrain5:function(data){var list1=data.towsls.enterpriseData;var list2=data.towsls.towslsData;var enterpriseName=[];var enterpriseCharts=[];var enterpriseType=[];$.each(list1,function(k,v){enterpriseType.push(v.enterpriseType);enterpriseName.push(v.enterpriseType+":"+v.average);enterpriseCharts.push(v.enterpriseType+v.userCount+"名学员")});var chartsType=list2.towslsYAxis;var chartsData=list2.towslsXAxis;var resultData=[];var colorList=['#847ccf','#df94e0','#b8b3e2'];$('.every-part:nth-child(7) .average').empty();$.each(list1,function(j,m){$('.every-part:nth-child(7) .average').append('<span class="userCount">'+m.enterpriseType+'平均满意度：<label class="userCount-label">'+m.average+'</label>分</span>')});$.each(chartsData,function(k,v){resultData.push({name:v.enterpriseType,type:'bar',barMaxWidth:40,itemStyle:{normal:{show:true,color:colorList[k]}},label:{show:true,position:'right',color:'#000'},barWidth:17,barGap:"0%",barCategoryGap:"60px",itemStyle:{barBorderRadius:[0,8,8,0]},data:v.enterpriseAverage=$.map(v.enterpriseAverage,function(n,i){return Number(n).toFixed(2)})})});var myChart=echarts.init($('.drawing-6').get(0));option={backgroundColor:'#ffffff',title:{text:'四、学员对教学组织、学风院风、后勤服务的平均满意度',textStyle:{color:'#111111',fontSize:18,fontWeight:100},top:10,left:'left'},legend:{y:'bottom',right:40,itemWidth:10,itemHeight:10,textStyle:{fontSize:14,color:'#555555'},data:enterpriseType},grid:{left:'3%',right:'4%',containLabel:true},color:['#847ccf','#df94e0','#b8b3e2'],tooltip:{show:"true",trigger:'axis',axisPointer:{type:'shadow'}},xAxis:{type:'value',axisTick:{show:true},axisLine:{show:true,lineStyle:{color:'#000'}},splitLine:{show:true}},yAxis:[{type:'category',axisTick:{show:false},axisLine:{show:true,lineStyle:{color:'#000000'}},axisLabel:{show:true,formatter:function(params){return quList.formatter(params,10)}},data:chartsType},{type:'category',axisLine:{show:false},axisTick:{show:false},axisLabel:{show:false},splitArea:{show:false},splitLine:{show:false},data:chartsType}],series:resultData};myChart.setOption(option)},demoTrain6:function(data){var list1=data.learningeffect.enterpriseData;var list2=data.learningeffect.learningeffectData;var enterpriseName=[];var enterpriseCharts=[];var enterpriseType=[];$.each(list1,function(k,v){enterpriseType.push(v.enterpriseType);enterpriseName.push(v.enterpriseType+":"+v.average);enterpriseCharts.push(v.enterpriseType+v.userCount+"名学员")});var chartsType=list2.learningeffectYAxis;var chartsData=list2.learningeffectXAxis;var resultData=[];var colorList=['#847ccf','#df94e0','#b8b3e2'];$('.every-part:nth-child(8) .average').empty();$.each(list1,function(j,m){$('.every-part:nth-child(8) .average').append('<span class="userCount">'+m.enterpriseType+'平均满意度：<label class="userCount-label">'+m.average+'</label>分</span>')});$.each(chartsData,function(k,v){resultData.push({name:v.enterpriseType,type:'bar',barMaxWidth:40,itemStyle:{normal:{show:true,color:colorList[k]}},label:{show:true,position:'right',color:'#000'},barWidth:17,barGap:"0%",barCategoryGap:"60px",itemStyle:{barBorderRadius:[0,8,8,0]},data:v.enterpriseAverage=$.map(v.enterpriseAverage,function(n,i){return Number(n).toFixed(2)})})});var myChart=echarts.init($('.drawing-7').get(0));option={backgroundColor:'#ffffff',title:{text:'五、学员对培训学习效果的平均满意度',textStyle:{color:'#111111',fontSize:18,fontWeight:100},top:10,left:'left'},legend:{y:'bottom',right:40,itemWidth:10,itemHeight:10,textStyle:{fontSize:14,color:'#555555'},data:enterpriseType},grid:{left:'3%',right:'4%',containLabel:true},color:['#847ccf','#df94e0','#b8b3e2'],tooltip:{show:"true",trigger:'axis',axisPointer:{type:'shadow'}},xAxis:{type:'value',axisTick:{show:true},axisLine:{show:true,lineStyle:{color:'#000'}},splitLine:{show:true}},yAxis:[{type:'category',axisTick:{show:false},axisLine:{show:true,lineStyle:{color:'#000000'}},axisLabel:{show:true,formatter:function(params){return quList.formatter(params,10)}},data:chartsType},{type:'category',axisLine:{show:false},axisTick:{show:false},axisLabel:{show:false},splitArea:{show:false},splitLine:{show:false},data:chartsType}],series:resultData};myChart.setOption(option)},demoTrain7:function(data){var list1=data.satisfaction.wholeSatisfaction;var list2=data.satisfaction.averageSatisfaction;var enterpriseType1=[];console.log(list1,list2);var chartsType1=['总体满意度','平均满意度'];var chartsData1=list1;var resultData1=[];var colorList1=['#847ccf','#df94e0','#b8b3e2'];$('.every-part:nth-child(9) .average').empty();$.each(data.satisfaction.averageSatisfaction,function(j,m){$('.every-part:nth-child(9) .average').append('<span class="userCount">'+m.enterpriseType+'平均满意度：<label class="userCount-label">'+m.enterpriseAverage+'</label>分</span>')});$.each(chartsData1,function(k,v){var enterpriseAverage;$.each(list2,function(x,y){if(v.enterpriseType==y.enterpriseType){enterpriseAverage=y.enterpriseAverage}});resultData1.push({name:v.enterpriseType,type:'bar',barMaxWidth:40,itemStyle:{normal:{show:true,color:colorList1[k]}},label:{show:true,position:'right',color:'#000'},barWidth:17,barGap:"0%",barCategoryGap:"60px",itemStyle:{barBorderRadius:[0,8,8,0]},data:[v.enterpriseAverage,enterpriseAverage]})});var myChart1=echarts.init($('.drawing-8').get(0));option1={backgroundColor:'#ffffff',title:{text:'六、满意度 ',textStyle:{color:'#111111',fontSize:18,fontWeight:100},top:10,left:'left'},legend:{y:'bottom',right:40,itemWidth:10,itemHeight:10,textStyle:{fontSize:14,color:'#555555'}},grid:{left:'3%',right:'4%',containLabel:true},color:['#847ccf','#df94e0','#b8b3e2'],tooltip:{show:"true",trigger:'axis',axisPointer:{type:'shadow'}},xAxis:{type:'value',axisTick:{show:true},axisLine:{show:true,lineStyle:{color:'#000'}},splitLine:{show:true}},yAxis:[{type:'category',axisTick:{show:false},axisLine:{show:true,lineStyle:{color:'#000000'}},axisLabel:{show:true,formatter:function(params){return quList.formatter(params,10)}},data:chartsType1}],series:resultData1};myChart1.setOption(option1);},demoTrain8:function(data){var list1=data.schoolCharacteristic.singleElection;var list2=data.schoolCharacteristic.singleElectionXAxis;var enterpriseType=[];$.each(list1,function(k,m){$('.every-part:nth-child(10) .average').eq(0).append('<span class="userCount">'+m.enterpriseType+'平均满意度：<label class="userCount-label">'+m.enterpriseAverage[0]+'</label>分</span>')});var resultData=[];var colorList=['#847ccf','#df94e0','#b8b3e2'];$.each(list1,function(k,v){resultData.push({name:v.enterpriseType,type:'bar',barMaxWidth:40,itemStyle:{normal:{show:true,color:colorList[k]}},label:{show:true,position:'right',color:'#000'},barWidth:17,barGap:"0%",barCategoryGap:"60px",itemStyle:{barBorderRadius:[0,8,8,0]},data:v.enterpriseAverage})});var myChart1=echarts.init($('.drawing-9').get(0));var option1={backgroundColor:'#ffffff',title:{text:'七、办学特色',textStyle:{color:'#111111',fontSize:18,fontWeight:100},left:'left'},legend:{y:'bottom',right:40,itemWidth:10,itemHeight:10,textStyle:{fontSize:14,color:'#555555'},data:enterpriseType},grid:{left:'3%',right:'4%',containLabel:true},color:['#847ccf','#df94e0','#b8b3e2'],tooltip:{show:"true",trigger:'axis',axisPointer:{type:'shadow'}},xAxis:{type:'value',axisTick:{show:true},axisLine:{show:true,lineStyle:{color:'#000'}},splitLine:{show:true}},yAxis:[{type:'category',axisTick:{show:false},axisLine:{show:true,lineStyle:{color:'#000000'}},axisLabel:{show:true,formatter:function(params){return quList.formatter(params,10)}},data:list2},{type:'category',axisLine:{show:false},axisTick:{show:false},axisLabel:{show:false},splitArea:{show:false},splitLine:{show:false},data:list2}],series:resultData};myChart1.setOption(option1);var myChart2=echarts.init($('.drawing-10').get(0));var multiSelection=data.schoolCharacteristic.multiSelection;$.each(data.schoolCharacteristic.singleElectionUser,function(k,m){$('.every-part:nth-child(10) .average').eq(1).append('<span class="userCount">'+m.enterpriseType+'：<label class="userCount-label">'+m.enterpriseCount+'</label>人</span>')});if(multiSelection.length==0){$('.drawing-10').hide()}$.each(multiSelection,function(k,v){var nameList2=[];var dataList2=[];nameList2=v.multiIName;dataList2=v.multiPercentage;var option2={backgroundColor:'#ffffff',title:{text:'          ◆◆'+v.multiITitle+': ',textStyle:{color:'#111111',fontSize:18,fontWeight:100}},tooltip:{trigger:'axis',axisPointer:{type:'shadow'}},grid:{left:'3%',right:'4%',bottom:'3%',containLabel:true},color:['#847ccf','#df94e0','#b8b3e2'],xAxis:{type:'value',lineStyle:{color:'#000000'}},yAxis:{type:'category',data:nameList2,axisLabel:{show:true,formatter:function(params){return quList.formatter(params,10)}}},series:[{type:'bar',label:{normal:{show:true,position:'insideRight'}},label:{show:true,position:'right',color:'#000'},barWidth:17,barGap:"0%",barCategoryGap:"60px",itemStyle:{barBorderRadius:[0,8,8,0]},data:dataList2=$.map(dataList2,function(n,i){return Number(n).toFixed(2)})}]};myChart2.setOption(option2)})},formatter:function(params,num){var newParamsName="";var paramsNameNumber=params.length;var provideNumber=num;var rowNumber=Math.ceil(paramsNameNumber/provideNumber);if(paramsNameNumber>provideNumber){for(var p=0;p<rowNumber;p+=1){var tempStr="";var start=p*provideNumber;var end=start+provideNumber;if(p==rowNumber-1){tempStr=params.substring(start,paramsNameNumber)}else{tempStr=params.substring(start,end)+"\n"}newParamsName+=tempStr}}else if(paramsNameNumber<provideNumber){for(var j=0;j<provideNumber-paramsNameNumber;j+=1){params='   '+params}newParamsName=params}else{newParamsName=params}return newParamsName},detailsList:[],getDetailsList:function(){var me=this;$('.class-tbody').empty();var projectCode=$yt_common.GetQueryString("projectCode");var traineeName=$('#keyword1').val();var classCacsi=quList.getChecks();var isEffective='0';$('.page1').pageInfo({async:true,pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"class/questionnaire/getClassTraineeList",type:"post",data:{projectCode:projectCode,traineeName:traineeName,classCacsi:classCacsi,isEffective:isEffective},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){me.detailsList=data.data;if(data.flag==0){var htmlTbody=$('.class-tbody');htmlTbody.empty();var htmlTr='';if(data.data.rows.length>0){$('.page1').show();var num=1;$.each(data.data.rows,function(i,v){var type='';var classCacsi='';if(v.classCacsi==0){classCacsi='未评价';type='--'}if(v.classCacsi==1){classCacsi='已评价';type='<a class="yt-link lookDetails" id='+v.traineeId+'>查看</a>'}v.teacherRecommendation=JSON.parse(v.teacherRecommendation);if(v.teacherRecommendation.length!=0){$.each(v.teacherRecommendation,function(a,b){if(b.teacherName==""){b.teacherName="--"}if(b.contactWay==""){b.contactWay="--"}if(b.classTitle==""){b.classTitle="--"}if(b.orgName==""){b.orgName="--"}if(b.understandTeacher==""){b.understandTeacher="--"}if(a==0){htmlTr='<tr><td rowspan="'+v.teacherRecommendation.length+'">'+num++ +'</td><input type="hidden" value="'+v.traineeId+'"><td rowspan="'+v.teacherRecommendation.length+'" style="text-align:left;">'+v.traineeName+'</td><td rowspan="'+v.teacherRecommendation.length+'" class="text-overflow">'+v.designImplementation+'</td><td rowspan="'+v.teacherRecommendation.length+'" class="text-overflow">'+v.teachingEffect+'</td><td rowspan="'+v.teacherRecommendation.length+'">'+v.towsls+'</td><td rowspan="'+v.teacherRecommendation.length+'">'+v.learningEffect+'</td><td rowspan="'+v.teacherRecommendation.length+'">'+v.characteristic+'</td><td rowspan="'+v.teacherRecommendation.length+'">'+v.criticismSuggestion+'</td><td>'+b.teacherName+'</td><td>'+b.contactWay+'</td><td>'+b.classTitle+'</td><td>'+b.orgName+'</td><td>'+b.understandTeacher+'</td><td rowspan="'+v.teacherRecommendation.length+'">'+classCacsi+'</td><td rowspan="'+v.teacherRecommendation.length+'">'+type+'</td></tr>'}else{htmlTr+='<tr><td>'+b.teacherName+'</td><td>'+b.contactWay+'</td><td>'+b.classTitle+'</td><td>'+b.orgName+'</td><td>'+b.understandTeacher+'</td></tr>'}})}else{htmlTr='<tr><td>'+num++ +'</td><input type="hidden" value="'+v.traineeId+'"><td style="text-align:left;">'+v.traineeName+'</td><td class="text-overflow">'+v.designImplementation+'</td><td class="text-overflow">'+v.teachingEffect+'</td><td>'+v.towsls+'</td><td>'+v.learningEffect+'</td><td>'+v.characteristic+'</td><td>'+v.criticismSuggestion+'</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>'+classCacsi+'</td><td>'+type+'</td></tr>'}htmlTbody.append(htmlTr)});}else{$('.page1').hide();htmlTr+='<tr style="border:0px;background-color:#fff !important;" ><td colspan="15" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';htmlTbody.append(htmlTr)}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true });quList.lookDetails()},getDetailsExportList:function(){$(".exportList").on("click",function(){var projectCode=$yt_common.GetQueryString("projectCode");var traineeName=$('#keyword1').val();var classCacsi=quList.getChecks();var isEffective='0';var downUrl=$yt_option.base_path+"class/questionnaire/exportQuestionnaire";$.ajaxDownloadFile({url:downUrl,data:{projectCode:projectCode,traineeName:traineeName,classCacsi:classCacsi,isEffective:isEffective,selectionType:2,isDownload:true}})})},getChecks:function(){var classCacsi='';var checks=document.getElementsByName("test");for(k in checks){if(checks[k].checked){if(classCacsi==''){classCacsi+=checks[k].value}else{classCacsi+=','+checks[k].value}}}return classCacsi},lookDetails:function(classCacsi){var me=this;$('.details-box').off().on('click','.lookDetails',function(){quList.showAlert5();var j=$(this).parent().parent().index();quList.getScoreDetail(me.detailsList.rows[j].traineeId,success);$yt_baseElement.showLoading();function success(data){$yt_baseElement.hideLoading();console.log(data.data);$('#details-form').empty();$.each(data.data,function(i,n){if(i!=0){$('#details-form').append('<table style="margin-top: 5px"><tr><th><b>'+n.itemName+'</b></th></tr></table>')}else{$('#details-form').append('<table></table>')}$.each(n.itemsDetailsJson,function(x,y){$('#details-form table:nth-child('+(i+1)+')').append('<tr id="title"><td>'+y.title+'</td></tr>');if(y.types==1){var lastNum=5-y.titleVakue;$('#details-form table:nth-child('+(i+1)+')').append('<tr><td id="star"></td></tr>');for(let q=0;q<y.titleVakue;q+=1){$('#details-form table:nth-child('+(i+1)+') #star:eq('+x+')').append('<img src="../../resources/images/starImg/star-on.png"/>')}for(var a=0;a<lastNum;a+=1){$('#details-form table:nth-child('+(i+1)+') #star:eq('+x+')').append('<img src="../../resources/images/starImg/star-off.png"/>')}}if(y.types==2){$.each(y.itemDetailsSpecific,function(c,s){if(y.titleVakue==s.pkId){$('#details-form table:nth-child('+(i+1)+')').append('<tr><td>'+s.specificValue+'</td></tr>')}})}if(y.types==3){y.titleVakue=y.titleVakue.split(',');$.each(y.titleVakue,function(c,s){$.each(y.itemDetailsSpecific,function(p,u){if(u.specificValue==s){$('#details-form table:nth-child('+(i+1)+')').append('<tr><td>'+u.specificValue+'</td></tr>')}})})}if(y.types==5){}if(y.types==6){$.each(y.itemDetailsSpecific,function(c,s){$('#details-form table:nth-child('+(i+1)+')').append('<tr><td>'+s.identificationName+'</td><td>'+s.identificationValue+'</td></tr>')})}if(y.types==4){$('#details-form table:nth-child('+(i+1)+')').append('<tr><td>'+y.titleVakue+'</td></tr>')}})});$yt_alert_Model.setFiexBoxHeight($(".details-alert .yt-edit-alert-main"))}})},originalList:[],getOriginalList:function(){var me=this;$('.class-tbody2').empty();var projectCode=$yt_common.GetQueryString("projectCode");var traineeName2=$('#keyword2').val();var classCacsi2=quList.getChecks2();var isEffective2='1';$('.page2').pageInfo({async:true,pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"class/questionnaire/getClassTraineeList",type:"post",data:{projectCode:projectCode,traineeName:traineeName2,classCacsi:classCacsi2,isEffective:isEffective2},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){me.originalList=data.data;if(data.flag==0){var htmlTbody=$('.class-tbody2');var htmlTr='';htmlTbody.empty();if(data.data.rows.length>0){$('.page2').show();var num=1;$.each(data.data.rows,function(i,v){var type='';var classCacsi='';if(v.classCacsi==0){classCacsi='未评价';type='--';if(v.designImplementation=="0"){v.designImplementation='--'}if(v.teachingEffect=="0"){v.teachingEffect='--'}if(v.towsls=="0"){v.towsls='--'}if(v.learningEffect=="0"){v.learningEffect='--'}if(v.characteristic=="0"){v.characteristic='--'}}if(v.classCacsi==1){classCacsi='已评价';type='<a class="yt-link lookDetails" id='+v.traineeId+'>查看</a>'}if(v.classCacsi==2){classCacsi='<span style="color:red;">无效</span>';type='<a class="yt-link lookNoDetails lookDetails" id='+v.traineeId+'>查看</a>'}v.teacherRecommendation=JSON.parse(v.teacherRecommendation);if(v.teacherRecommendation.length!=0){$.each(v.teacherRecommendation,function(a,b){if(b.teacherName==""){b.teacherName="--"}if(b.contactWay==""){b.contactWay="--"}if(b.classTitle==""){b.classTitle="--"}if(b.orgName==""){b.orgName="--"}if(b.understandTeacher==""){b.understandTeacher="--"}if(a==0){htmlTr='<tr class="ex'+v.traineeId+'"><td rowspan="'+v.teacherRecommendation.length+'">'+num++ +'</td><input type="hidden" class="traineeId" value="'+v.traineeId+'"><td rowspan="'+v.teacherRecommendation.length+'">'+v.traineeName+'</td><td rowspan="'+v.teacherRecommendation.length+'" class="text-overflow">'+v.designImplementation+'</td><td rowspan="'+v.teacherRecommendation.length+'" class="text-overflow">'+v.teachingEffect+'</td><td rowspan="'+v.teacherRecommendation.length+'">'+v.towsls+'</td><td rowspan="'+v.teacherRecommendation.length+'">'+v.learningEffect+'</td><td rowspan="'+v.teacherRecommendation.length+'">'+v.characteristic+'</td><td rowspan="'+v.teacherRecommendation.length+'">'+v.criticismSuggestion+'</td><td>'+b.teacherName+'</td><td>'+b.contactWay+'</td><td>'+b.classTitle+'</td><td>'+b.orgName+'</td><td>'+b.understandTeacher+'</td><td rowspan="'+v.teacherRecommendation.length+'">'+classCacsi+'</td><td rowspan="'+v.teacherRecommendation.length+'">'+type+'</td></tr>'}else{htmlTr+='<tr class="ex'+v.traineeId+'"><td>'+b.teacherName+'</td><td>'+b.contactWay+'</td><td>'+b.classTitle+'</td><td>'+b.orgName+'</td><td>'+b.understandTeacher+'</td></tr>'}})}else{htmlTr='<tr class="ex'+v.traineeId+'"><td>'+num++ +'</td><input type="hidden" class="traineeId" value="'+v.traineeId+'"><td>'+v.traineeName+'</td><td class="text-overflow">'+v.designImplementation+'</td><td class="text-overflow">'+v.teachingEffect+'</td><td>'+v.towsls+'</td><td>'+v.learningEffect+'</td><td>'+v.characteristic+'</td><td>'+v.criticismSuggestion+'</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>'+classCacsi+'</td><td>'+type+'</td></tr>'}htmlTbody.append(htmlTr)});}else{$('.page2').hide();htmlTr+='<tr style="border:0px;background-color:#fff !important;" ><td colspan="15" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';htmlTbody.append(htmlTr)}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true });quList.lookDetails2()},getOriginalExportList:function(){$(".originalExportList").on("click",function(){var projectCode=$yt_common.GetQueryString("projectCode");var traineeName=$('#keyword2').val();var classCacsi=quList.getChecks2();var isEffective='1';var downUrl=$yt_option.base_path+"class/questionnaire/exportQuestionnaire";$.ajaxDownloadFile({url:downUrl,data:{projectCode:projectCode,traineeName:traineeName,classCacsi:classCacsi,isEffective:isEffective,selectionType:2,isDownload:true}})})},getScoreDetail:function(traineeIds,success){var projectCode=$yt_common.GetQueryString("projectCode");$.ajax({type:"post",url:$yt_option.base_path+"class/questionnaire/getTraineeQuestionnaire",async:true,data:{projectCode:projectCode,traineeId:traineeIds},success:function(data){success(data)}})},showAlert5:function(){$(".details-alert").show();$yt_alert_Model.setFiexBoxHeight($(".details-alert .yt-edit-alert-main"));$yt_model_drag.modelDragEvent($(".yt-edit-alert .yt-edit-alert-title"));$('.yt-edit-alert .yt-eidt-model-bottom .yt-model-canel-btn').off().on("click",function(){$(".yt-edit-alert,#heard-nav-bak").hide();$("#pop-modle-alert").hide()})},getChecks2:function(){var classCacsi='';var checks=document.getElementsByName("test2");for(k in checks){if(checks[k].checked){if(classCacsi==''){classCacsi+=checks[k].value}else{classCacsi+=','+checks[k].value}}}return classCacsi},lookDetails2:function(classCacsi){var me=this;$('.original-box').off().on('click','.lookDetails',function(){quList.showAlert5();var j=$(this).parent().parent().index();quList.getScoreDetail(me.originalList.rows[j].traineeId,success);$yt_baseElement.showLoading();function success(data){$yt_baseElement.hideLoading();console.log(data.data);$('#details-form').empty();$.each(data.data,function(i,n){if(i!=0){$('#details-form').append('<table style="margin-top: 5px"><tr><th><b>'+n.itemName+'</b></th></tr></table>')}else{$('#details-form').append('<table></table>')}$.each(n.itemsDetailsJson,function(x,y){$('#details-form table:nth-child('+(i+1)+')').append('<tr id="title"><td>'+y.title+'</td></tr>');if(y.types==1){var lastNum=5-y.titleVakue;$('#details-form table:nth-child('+(i+1)+')').append('<tr><td id="star"></td></tr>');for(let q=0;q<y.titleVakue;q+=1){$('#details-form table:nth-child('+(i+1)+') #star:eq('+x+')').append('<img src="../../resources/images/starImg/star-on.png"/>')}for(var a=0;a<lastNum;a+=1){$('#details-form table:nth-child('+(i+1)+') #star:eq('+x+')').append('<img src="../../resources/images/starImg/star-off.png"/>')}}if(y.types==2){$.each(y.itemDetailsSpecific,function(c,s){if(y.titleVakue==s.pkId){$('#details-form table:nth-child('+(i+1)+')').append('<tr><td>'+s.specificValue+'</td></tr>')}})}if(y.types==3){y.titleVakue=y.titleVakue.split(',');$.each(y.titleVakue,function(c,s){$.each(y.itemDetailsSpecific,function(p,u){if(u.specificValue==s){$('#details-form table:nth-child('+(i+1)+')').append('<tr><td>'+u.specificValue+'</td></tr>')}})})}if(y.types==5){}if(y.types==6){$.each(y.itemDetailsSpecific,function(c,s){$('#details-form table:nth-child('+(i+1)+')').append('<tr><td>'+s.identificationName+'</td><td>'+s.identificationValue+'</td></tr>')})}if(y.types==4){$('#details-form table:nth-child('+(i+1)+')').append('<tr><td>'+y.titleVakue+'</td></tr>')}})});$yt_alert_Model.setFiexBoxHeight($(".details-alert .yt-edit-alert-main"))}})},updateEffective:function(isEffective){var bool=true;var projectCode=$yt_common.GetQueryString("projectCode");var traineeId=$(".yt-table-active .traineeId").val();var downUrl=$yt_option.base_path+"class/questionnaire/updateEffective";if($("tr.yt-table-active").length!=0){$.ajax({url:downUrl,async:false,type:'post',data:{projectCode:projectCode,traineeId:traineeId,isEffective:isEffective},success:function(data){if(data.flag==0){$yt_alert_Model.prompt("标记成功")}else{$yt_alert_Model.prompt("标记失败")}}})}else{$yt_alert_Model.prompt("请选择要操作的数据");bool=false}return bool},refreshEffective:function(isEffective){$('.page2').pageInfo("refresh")},criticismSugg:function(){var projectCode=$yt_common.GetQueryString('projectCode');$yt_baseElement.showLoading();$.ajax({type:"post",url:$yt_option.base_path+"class/questionnaire/getProjectTeacherRecommend",async:false,data:{projectCode:projectCode},success:function(data){if(data.flag==0){var htmlTr='';var criticismSuggestion=data.data.criticismSuggestion;if(criticismSuggestion!=""){$(".cri-and-sug textarea").val(criticismSuggestion)}else{$(".cri-and-sug textarea").val("")}var teacherRecommend=data.data.teacherRecommend;$(".teacher-recommend table tbody").empty();if(teacherRecommend.length!=0){$(".teacher-recommend table").attr('teaTr',1);$.each(teacherRecommend,function(i,n){if(n.teacherName==undefined){n.teacherName=''}if(n.contactWay==undefined){n.contactWay=''}if(n.classTitle==undefined){n.classTitle=''}if(n.orgName==undefined){n.orgName=''}if(n.understandTeacher==undefined){n.understandTeacher=''}htmlTr='<tr><td style="text-align:center;"><span class="span-td">'+n.teacherName+'</span><input type="text" style="display:none;" class="yt-input input-td tea-name" value="'+n.teacherName+'"/></td><td style="text-align:center;"><span class="span-td">'+n.contactWay+'</span><input type="text" style="display:none;" class="yt-input input-td contact-way" value="'+n.contactWay+'"/></td><td style="text-align:center;"><span class="span-td">'+n.classTitle+'</span><input type="text" style="display:none;" class="yt-input input-td cla-title" value="'+n.classTitle+'"/></td><td><span class="span-td">'+n.orgName+'</span><input type="text" class="yt-input input-td org-name" style="display:none;" value="'+n.orgName+'"/></td><td><span class="span-td">'+n.understandTeacher+'</span><input type="text" style="display:none;" class="yt-input input-td understand-teacher" value="'+n.understandTeacher+'"/></td><td class="ope-td"><img class="del-icon" src="../../resources/images/icons/cost-level.png"/><img class="repair-icon" style="margin-left: 5px;" src="../../resources/images/icons/amend.png"/></td></tr>';$(".teacher-recommend table tbody").append(htmlTr)})}else{$(".teacher-recommend table").attr('teaTr',0);htmlTr='<tr class="add-tr"><td><input type="text" class="yt-input tea-name"/></td><td><input type="text" class="yt-input contact-way"/></td><td><input type="text" class="yt-input cla-title"/></td><td><input type="text" class="yt-input org-name"/></td><td><input type="text" class="yt-input understand-teacher"/></td><td><img class="del-icon" src="../../resources/images/icons/cost-level.png"/><img class="repair-icon" style="margin-left: 5px;" src="../../resources/images/icons/amend.png"/></td></tr>';$(".teacher-recommend table tbody").append(htmlTr)}}else{}$yt_baseElement.hideLoading()}})},addContentText:function(){quList.criticismSugg();var thisUser=$yt_common.GetQueryString('thisUrs');var teaTr=$(".teacher-recommend table").attr('teaTr');var criSug=$(".cri-and-sug textarea").val();console.log('thisUser',thisUser);if(thisUser!="300"){$('.yt-option-btn.original-info-btn').hide();if(teaTr!=1){$(".teacher-recommend").hide()}else{$(".teacher-recommend").show();$(".teacher-recommend table th.teach-th").hide();$(".teacher-recommend table tbody td.ope-td").hide();$(".teacher-recommend div.ope-tr").hide();$(".teacher-recommend div.bootom-btn").hide()}if(criSug==""){$(".cri-and-sug").hide()}else{$(".cri-and-sug").show();$(".cri-and-sug textarea").attr('readonly','readonly')}}$(".teacher-recommend .bootom-btn button").click(function(){quList.addTeacherRecommend()});$(".teacher-recommend table tbody").off().on('click','img.repair-icon,img.del-icon',function(e){if($(this)[0].className=='del-icon'){$(this).parents('tr').remove()}else{$(this).parents('tr').find('span.span-td').hide();$(this).parents('tr').find('input.input-td').show()}});$(".teacher-recommend div.ope-tr span.add-new-tr").click(function(){var htmlTr='<tr class="add-tr"><td><input type="text" class="yt-input tea-name"/></td><td><input type="text" class="yt-input contact-way"/></td><td><input type="text" class="yt-input cla-title"/></td><td><input type="text" class="yt-input org-name"/></td><td><input type="text" class="yt-input understand-teacher"/></td><td><img class="del-icon" src="../../resources/images/icons/cost-level.png"/><img class="repair-icon" style="margin-left: 5px;" src="../../resources/images/icons/amend.png"/></td></tr>';$(".teacher-recommend table tbody").append(htmlTr)})},addTeacherRecommend:function(){var teaName=true;var projectCode=$yt_common.GetQueryString('projectCode');var criticismSuggestion=$(".cri-and-sug textarea").val();var addTr=$(".teacher-recommend table tbody tr");console.log('addTr',addTr);var teacherRecommend=[];$.each(addTr,function(i,v){var teacherName=$(v).find('.tea-name').val();var contactWay=$(v).find('.contact-way').val();var classTitle=$(v).find('.cla-title').val();var orgName=$(v).find('.org-name').val();var understandTeacher=$(v).find('.understand-teacher').val();if(teacherName==""){teaName=false;$yt_alert_Model.prompt("请填写教师姓名");return false}var teacherRe={teacherName:teacherName,contactWay:contactWay,classTitle:classTitle,orgName:orgName,understandTeacher:understandTeacher};teacherRecommend.push(teacherRe)});teacherRecommend=JSON.stringify(teacherRecommend);console.log('teacherRecommend',teacherRecommend);if(teaName){$yt_baseElement.showLoading();$.ajax({type:"post",url:$yt_option.base_path+"class/questionnaire/addProjectTeacherRecommend",async:false,data:{projectCode:projectCode,criticismSuggestion:criticismSuggestion,teacherRecommend:teacherRecommend},success:function(data){if(data.flag==0){$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt('提交成功')});quList.criticismSugg()}}})}}};$(function(){$yt_baseElement.showLoading();quList.init()});