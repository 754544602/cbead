var teacherList={courseList:"",init:function(){$("select").niceSelect();teacherList.getTeacherInf();$(".tab-title-list button").click(function(){$(this).addClass("active").siblings().removeClass("active");$(".box-list .content-box").hide().eq($(this).index()).show();if($(this).index()==0){teacherList.getTeacherInf()}else if($(this).index()==1){teacherList.getTeachRecordsList()}else if($(this).index()==2){teacherList.getTeachCoursesList();$(".add-courses-list").parent().hide()}else if($(this).index()==3){teacherList.getTeachCourseWareList()}});$(".teacher-index-inf input").attr("disabled","disabled");$(".btn-return").click(function(){var projectCode=$yt_common.GetQueryString('projectCode');var back="teacherActive";window.location.href="classInfo.html?projectCode="+projectCode+"&back="+back});$(".add-courses-list").on('click',function(){$(".yt-edit-alert-title-msg").text("新增课程");teacherList.legalAdd();$(".alert-index .course-title").val("");$(".alert-index .course-details").val("");$('.yt-model-sure-btn').off('click').on('click',function(){teacherList.addCourseList();$(".alert-index").hide()})});$(".courses-tbody").on('click',".img-amend",function(){$(".yt-edit-alert-title-msg").text("修改");var courseTitle=$(this).parent().parent().data("courseData").courseTitle;var courseDetails=$(this).parent().parent().data("courseData").courseDetails;$(".alert-index .course-title").val(courseTitle);$(".alert-index .course-details").val(courseDetails);teacherList.legalAdd();var pkId=$(this).parent().parent().data("courseData").pkId;$('.yt-model-sure-btn').off('click').on('click',function(){teacherList.amendCourseList(pkId);$(".alert-index").hide()})});$(".courses-tbody").on('click',".img-del",function(){var pkId=$(this).parent().parent().data("courseData").pkId;teacherList.delCourseList(pkId)})},getTeacherInf:function(){$yt_baseElement.showLoading();var pkId=$yt_common.GetQueryString('pkId');var infoNum=$yt_common.GetQueryString('infoNum');$.ajax({type:"post",url:$yt_option.base_path+"teacher/getBeanById",data:{pkId:pkId},success:function(data){if(data.flag==0){if(infoNum==1){$(".teacher-index-inf").find("input").attr("placeholder"," ");if(data.data.papersType==1){data.data.papersType="身份证"}else if(data.data.papersType==2){data.data.papersType="护照"}else{data.data.papersType="港澳通行证"}$(".papersType").val(data.data.papersType);$('.btn-file').hide()}else{$(".papersType").setSelectVal(data.data.papersType);}$(".teacher-index-inf").setDatas(data.data);var teacherUl=$(".file-id");var teacherLi="";var fileIdsArr=$.parseJSON(data.data.fileIds);if(fileIdsArr.length>0){$.each(fileIdsArr,function(i,v){teacherLi+='<li><span class="file-name" style="margin-right: 50px;color:blue;cursor: pointer"><input type="hidden" class="file-span-id" value="'+v.pkId+'" >'+v.fileName+'</span><span class="cancal" style="cursor: pointer;">x</span></li>';teacherUl.html(teacherLi)});if(infoNum==1){$(".cancal").hide()}}$yt_baseElement.hideLoading()}else{$yt_alert_Model.prompt("获取失败");$yt_baseElement.hideLoading()}}})},getTeachRecordsList:function(){$yt_baseElement.showLoading();$('.record-info').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"teacher/getClassCourseData",type:"post",data:{},objName:'data',success:function(data){if(data.flag==0){var htmlTbody=$('.records-tbody');var htmlTr='';var num=1;if(data.data.rows.length>0){$(htmlTbody).empty();var fileNameArr="";$.each(data.data.rows,function(i,v){if(v.combinedScore==null){v.combinedScore=" "}fileNameArr="";var filesArr=$.parseJSON(v.files);$.each(filesArr,function(i,n){if(fileNameArr==""){fileNameArr=n.fileName}else{fileNameArr+=","+n.fileName}});htmlTr='<tr><td>'+num++ +'</td><td>'+v.courseDate+'</td><td style="text-align: left;">'+v.className+'</td><td style="text-align: left;">'+v.projectUserName+'</td><td style="text-align: left;">'+v.courseName+'</td><td style="text-align: left;">'+fileNameArr+'</td><td style="text-align: right;">'+v.combinedScore+'</td></tr>';htmlTbody.append($(htmlTr).data("legalData",v));$yt_baseElement.hideLoading()})}}else{$yt_alert_Model.prompt("查询失败");$yt_baseElement.hideLoading()}},isSelPageNum:true })},getTeachCoursesList:function(){$yt_baseElement.showLoading();var teacherId=$yt_common.GetQueryString('pkId');$('.course-info').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"teacher/lookForAllByCourse",type:"post",data:{teacherId:teacherId},objName:'data',success:function(data){if(data.flag==0){var htmlTbody=$('.courses-tbody');var htmlTr='';var num=1;if(data.data.rows.length>0){$(htmlTbody).empty();$.each(data.data.rows,function(i,v){htmlTr='<tr><td><input type="hidden" value="'+v.pkId+'" class="pkId">'+num++ +'</td><td>'+v.courseTitle+'</td><td>'+v.courseDetails+'</td><td style="font-weight:bold;color:#c9c9c9;"><img src="../../resources/images/icons/amend.png" style="margin" class="img-amend" alt="" />|<img src="../../resources/images/icons/t-del.png" class="img-del" alt="" /></tr>';htmlTbody.append($(htmlTr).data("courseData",v))})}$yt_baseElement.hideLoading()}else{$yt_alert_Model.prompt("查询失败");$yt_baseElement.hideLoading()}},isSelPageNum:true })},addCourseList:function(){var validFlag=$yt_valid.validForm($(".valid-tab"));if(validFlag){}else{}var teacherId=$yt_common.GetQueryString('pkId');var courseTitle=$(".alert-index .course-title").val();var courseDetails=$(".alert-index .course-details").val();$.ajax({type:"post",url:$yt_option.base_path+"teacher/addOrUpdateBeanByCourse",data:{teacherId:teacherId,courseTitle:courseTitle,courseDetails:courseDetails},success:function(data){if(data.flag==0){$yt_alert_Model.prompt("新增成功");$(".yt-edit-alert").hide();$('.course-info').pageInfo("refresh")}else{$yt_alert_Model.prompt("新增失败");$yt_baseElement.hideLoading()}}})},amendCourseList:function(pkId){var validFlag=$yt_valid.validForm($(".valid-tab"));if(validFlag){}else{}var teacherId=$yt_common.GetQueryString('pkId');var courseTitle=$(".alert-index .course-title").val();var courseDetails=$(".alert-index .course-details").val();$.ajax({type:"post",url:$yt_option.base_path+"teacher/addOrUpdateBeanByCourse",data:{pkId:pkId,teacherId:teacherId,courseTitle:courseTitle,courseDetails:courseDetails},success:function(data){if(data.flag==0){$yt_alert_Model.prompt("修改成功");$(".yt-edit-alert").hide();$('.course-info').pageInfo("refresh")}else{$yt_alert_Model.prompt("修改失败");$yt_baseElement.hideLoading()}}})},delCourseList:function(pkId){$yt_alert_Model.alertOne({haveCloseIcon:false,closeIconUrl:"",leftBtnName:"确定",rightBtnName:"取消",cancelFunction:"",alertMsg:"数据删除将无法恢复,确认删除吗?",confirmFunction:function(){$.ajax({type:"post",url:$yt_option.base_path+"teacher/deleteByCourseId",data:{pkId:pkId},success:function(data){if(data.flag==0){$yt_alert_Model.prompt("删除成功");teacherList.getTeachCoursesList()}else{$yt_alert_Model.prompt("删除失败")}}})}})},legalAdd:function(){$(".alert-index").show();$yt_alert_Model.getDivPosition($(".alert-index"));$yt_alert_Model.setFiexBoxHeight($(".add-course-alert form"));$yt_model_drag.modelDragEvent($(".lawyer-opinion-box .yt-edit-alert-title"));$('.alert-index .yt-eidt-model-bottom .yt-model-canel-btn').off().on("click",function(){$(".alert-index").hide();$("#pop-modle-alert").hide()})},getTeachCourseWareList:function(){$yt_baseElement.showLoading();$('.courseware-info').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"teacher/getClassCourseFileList",type:"post",data:{},objName:'data',success:function(data){if(data.flag==0){var htmlTbody=$('.courseware-tbody');var htmlTr='';var num=1;if(data.data.rows.length>0){$(htmlTbody).empty();$.each(data.data.rows,function(i,v){htmlTr='<tr><td><input type="hidden" value="'+v.pkId+'" class="pkId">'+num++ +'</td><td style="text-align: left;">'+v.fileName+'</td><td style="text-align: left;">'+v.createUserName+'</td><td>'+v.createTimeString+'</td><td style="text-align: left;">'+v.fileSize+'</td></tr>';htmlTbody.append($(htmlTr).data("courseWareData",v))})}$yt_baseElement.hideLoading()}else{$yt_alert_Model.prompt("查询失败");$yt_baseElement.hideLoading()}},isSelPageNum:true })}};$(function(){teacherList.init()});