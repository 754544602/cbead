var caList={init:function(){caList.lookForByBacklog();$('#operate-type').val(1);$(".pending-btn").click(function(){$('#operate-type').val(1);$(".pending-btn").addClass("active").siblings().removeClass("active");$(".approve-title").text("新闻稿待审批");caList.lookForByBacklog()});$(".approved-btn").click(function(){$('#operate-type').val(2);$(".approved-btn").addClass("active").siblings().removeClass("active");$(".approve-title").text("新闻稿审批记录");caList.lookForByApprove()});$('.list-tbody').off().on('click','.title',function(){var btnTpye=$('#operate-type').val();var pkId=$(this).parent().parent().find('.pkId').val();var taskName=$(this).parent().parent().find('.taskName').val();if(btnTpye==1){caList.getOneListInfo(pkId)}if(btnTpye==2){window.location.href="lookOneInfoApprove.html?pkId="+pkId+"&pageNum="+2}})},getOneListInfo:function(pkId){$.ajax({type:"post",url:$yt_option.base_path+"class/news/getBeanById",async:false,data:{pkId:pkId},objName:'data',success:function(data){if(data.flag==0){var flowLog=data.data.flowLog;if(flowLog.length!=0){var length=flowLog.length;var tastKeyType=flowLog[0].tastKey;var deleteReason=flowLog[0].deleteReason;var taskName=flowLog[0].taskName;if(length==0){window.location.href="addUpdatePage.html?pkId="+pkId+"&pageNum="+2}else if(tastKeyType=="activitiStartTask"||taskName=="草稿"||taskName=="未通过"){window.location.href="addUpdatePage.html?pkId="+pkId+"&pageNum="+2}else if(tastKeyType=="activitiEndTask"&&deleteReason=="completed"){window.location.href="lookOneInfoApprove.html?pkId="+pkId+"&pageNum="+2}else{window.location.href="addOrUpdateBean.html?pkId="+pkId+"&pageNum="+2}}}}})},lookForByBacklog:function(){$yt_baseElement.showLoading();var searchParameters=$('#keyword').val();$('.list-page').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"class/news/lookForByBacklog",type:"post",data:{searchParameters:searchParameters},objName:'data',success:function(data){$yt_baseElement.showLoading();if(data.flag==0){var htmlTbody=$('.class-tbody');var htmlTr='';var sequenceNumber;if(data.data.rows.length>0){$.each(data.data.rows,function(i,v){sequenceNumber=i+1;htmlTr+='<tr><input type="hidden" value="'+v.pkId+'" class="pkId"><td style="display:none;">'+sequenceNumber+'</td><td>'+sequenceNumber+'</td><td><a style="color:#3c4687;" class="title yt-link">'+v.title+'</a></td><td>'+v.projectName+'</td><td style="text-align:center;">'+v.createTimeString+'</td><td style="text-align:center;" class="text-overflow">'+v.createUserName+'</td><td style="text-align:center;">'+v.dealingWithPeople+'</td></tr>'})}else{htmlTr+='<tr style="border:0px;background-color:#fff !important;" ><td colspan="7" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>'}htmlTbody.html(htmlTr);$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},lookForByApprove:function(){$yt_baseElement.showLoading();var searchParameters=$('#keyword').val();$('.list-page').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"class/news/lookForByApprove",type:"post",data:{searchParameters:searchParameters},objName:'data',success:function(data){if(data.flag==0){var htmlTbody=$('.class-tbody');var htmlTr='';var sequenceNumber;if(data.data.rows.length>0){$.each(data.data.rows,function(i,v){sequenceNumber=i+1;htmlTr+='<tr><input type="hidden" value="'+v.pkId+'" class="pkId"><td style="text-align: center;">'+sequenceNumber+'</td><td><a style="color:#3c4687;" class="title yt-link">'+v.title+'</a></td><td>'+v.projectName+'</td><td>'+v.createTimeString+'</td><td class="text-overflow" style="text-align: center;">'+v.createUserName+'</td><td style="text-align: center;">'+v.dealingWithPeople+'</td></tr>'})}else{htmlTr+='<tr style="border:0px;background-color:#fff !important;" ><td colspan="7" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>'}htmlTbody.html(htmlTr);$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })}};$(function(){caList.init()});