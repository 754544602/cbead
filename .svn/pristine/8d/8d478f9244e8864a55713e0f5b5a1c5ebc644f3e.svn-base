/**
 * 班级信息
 */
var caList={init:function(){$("select").niceSelect();$(".start-time-start").calendar({controlId:"startDate",nowData:false,upperLimit:$(".start-time-end")});$(".start-time-end").calendar({controlId:"endDate",nowData:false,lowerLimit:$(".start-time-start")});$(".end-time-start").calendar({controlId:"startDate",nowData:false,upperLimit:$(".end-time-end")});$(".end-time-end").calendar({controlId:"endDate",nowData:false,lowerLimit:$(".end-time-start")});caList.getPlanListInfo();$('.list-table').on("click",".projectName",function(){var pkId=$(this).parents("tr").attr('project-id');var projectCode=$(this).parents("tr").find('.projectCode').val();var projectType=$(this).parents("tr").find('.project-type').val();var classProjectStates=$(this).parents("tr").data('data').projectStates;var url="classInfo.html?projectCode="+projectCode+"&projectType="+projectType+"&classProjectStates="+classProjectStates+"&pkId="+pkId;console.log(url);window.location.href=url});$(".pro-number").click(function(){var projectCode=$(this).attr('projectCode');if(projectCode=='true'){caList.getPlanListInfo("","project_code","ASC");$(this).attr('projectCode',false)}else{caList.getPlanListInfo("","project_code","DESC");$(this).attr('projectCode',true)}});$(".pro-star").click(function(){var start=$(this).attr('start');if(start=='true'){$(this).attr('start',false);caList.getPlanListInfo("","start_date","ASC")}else{$(this).attr('start',true);caList.getPlanListInfo("","start_date","DESC")}});$(".pro-end").click(function(){var end=$(this).attr('end');if(end=='true'){$(this).attr('end',false);caList.getPlanListInfo("","end_date","ASC")}else{$(this).attr('end',true);caList.getPlanListInfo("","end_date","DESC")}});$('.search-btn').click(function(){$('.project-code').val("");$('.project-name').val("");$('.project-sell').val("");$("#project-type").setSelectVal("");$("#project-states").setSelectVal("");$('.start-time-start').val("");$('.start-time-end').val("");$('.end-time-start').val("");$('.end-time-end').val("");caList.getPlanListInfo($("#keyword").val())});caList.hideSearch()},getPlanListInfo:function(selectParam,sort,orderType){var projectCode=$('.project-code').val();var projectName=$('.project-name').val();var projectType=$('#project-type').val();var projectSell=$('.project-sell').val();var projectHead=$('.project-head').val();var projectStates=$('#project-states').val();var startTimeStart=$('.start-time-start').val();var startTimeEnd=$('.start-time-end').val();var endTimeStart=$('.end-time-start').val();var endTimeEnd=$('.end-time-end').val();$('.list-page').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"class/lookForAll",type:"post",data:{selectParam:selectParam,projectCode:projectCode,projectName:projectName,projectType:projectType,projectSell:projectSell,projectHead:projectHead,projectStates:projectStates,startTimeStart:startTimeStart,startTimeEnd:startTimeEnd,endTimeStart:endTimeStart,endTimeEnd:endTimeEnd,sort:sort,orderType:orderType},objName:'data',async:true,before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){var htmlTbody=$('.class-tbody').empty();var htmlTr='';if(data.data.rows.length>0){$.each(data.data.rows,function(i,v){var projectType;switch(v.projectType){case '1':projectType='调训';break;case '2':projectType='委托';break;case '3':projectType='选学';break;case '4':projectType='中组部调训';break;case '5':projectType='国资委调训';break}v.projectStatesVal='';switch(v.projectStates){case '1':v.projectStatesVal='未开始';break;case '2':v.projectStatesVal='培训中';break;case '3':v.projectStatesVal='未结项';break;case '4':v.projectStatesVal='已结项';break}htmlTr='<tr project-id="'+v.pkId+'"><td>'+v.projectCode+'</td><input type="hidden" value="'+v.projectCode+'" class="projectCode"><input type="hidden" value="'+v.projectType+'" class="project-type"><td  style="text-align: left;"><a class="projectName" style="color:#3c4687;">'+v.projectName+'</a></td><td>'+projectType+'</td><td class="text-overflow" style="text-align:left;">'+v.projectSell+'</td><td class="text-overflow" style="text-align:left;">'+v.projectHead+'</td><td class="tl" style="text-align: center !important;">'+v.startDate+'</td><td class="tl" style="text-align: center !important;">'+v.endDate+'</td><td class="tr">'+v.traineeCount+'</td><td>'+v.projectStatesVal+'</td></tr>';htmlTr=$(htmlTr).data('data',v);htmlTbody.append(htmlTr)});$('.list-page').show()}else{$('.list-page').hide();htmlTr='<tr style="border:0px;background-color:#fff !important;" ><td colspan="9" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';htmlTbody.append(htmlTr)}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},hideSearch:function(){var clickNumber=0;$('.search-more').click(function(e){if(clickNumber%2==0){$('.search-box').show();$('.search-put').addClass('flipy')}else{$('.search-box').hide();$('.project-code').val("");$('.project-name').val("");$('.project-head').val("");$('.project-sell').val("");$('.project-state-box').each(function(){$(this).find("option:eq(0)").prop("selected","selected")});$('.project-type-box').each(function(){$(this).find("option:eq(0)").prop("selected","selected")});$('.start-time-start').val("");$('.start-time-end').val("");$('.end-time-start').val("");$('.end-time-end').val("");$('.search-put').removeClass('flipy')}clickNumber+=1;e.stopPropagation()});$('.yt-model-reset-btn').click(function(){$('.project-code').val("");$('.project-name').val("");$('.project-head').val("");$('.project-sell').val("");$("#project-type").setSelectVal("");$("#project-states").setSelectVal("");$('.start-time-start').val("");$('.start-time-end').val("");$('.end-time-start').val("");$('.end-time-end').val("")});$('.yt-model-sure-btn').click(function(){caList.getPlanListInfo($('.project-head').val())});$(document).click(function(e){clickNumber=0;$('.search-box').hide();$('.search-put').removeClass('flipy');e.stopPropagation()})}};$(function(){caList.init()});