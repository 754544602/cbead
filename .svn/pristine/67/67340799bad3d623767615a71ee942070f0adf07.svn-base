var classBoardList={init:function(){$("#txtDate1").calendar({speed:200,complement:true,readonly:true,lowerLimit:"2010/01/01",nowData:true,lowerLimit:$("#txtDate1"),dateFmt:"yyyy-MM-dd",callback:function(){classBoardList.classBoardListInfo()}});$("#txtDate2").calendar({speed:200,complement:true,readonly:true,lowerLimit:"2010/01/01",nowData:false,lowerLimit:$("#txtDate1"),dateFmt:"yyyy-MM-dd",callback:function(){classBoardList.classBoardListInfo()}});$("#txtDate2").val(classBoardList.halfData($("#txtDate1").val(),'next'));var dates=(new Date()).toLocaleDateString();dates=(new Date()).toLocaleDateString().replace('/','-');dates=dates.replace('/','-');classBoardList.classBoardListInfo();$('.halfmonth').off().click(function(){$("#txtDate1").val(dates);$("#txtDate2").val(classBoardList.halfData(dates,'next'));classBoardList.classBoardListInfo()});$('.thismonth').off().click(function(){$("#txtDate1").val(dates);$("#txtDate2").val(classBoardList.halfData(dates,'onemonth'));classBoardList.classBoardListInfo()})},classBoardListInfo:function(){$yt_baseElement.showLoading();$('.settlement-page').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"class/getClassKanBan",type:"post",data:{startTime:$("#txtDate1").val(),endTime:$("#txtDate2").val()},objName:'data',success:function(data){if(data.flag==0){$('.num').text(data.data.total);var htmlTbody=$('.list-tbody').empty();var htmlTr='';if(data.data.rows.length>0){$.each(data.data.rows,function(i,v){if(v.projectHead=="null"){v.projectHead=""}if(v.projectSell=="null"){v.projectSell=""}if(v.projectType==1){projectTypeName="计划"}if(v.projectType==2){projectTypeName="委托"}if(v.projectType==3){projectTypeName="选学"}if(v.projectType==4){projectTypeName="调训"}htmlTr='<tr><td>'+v.startDate+'</td><td style="text-align: left;"><a style="color: #3c4687;" class="projectName">'+v.projectName+'</a></td><td>'+projectTypeName+'</td><td style="text-align: left;">'+v.receptionActivities+'</td><td style="text-align: left;">'+v.personnelNamesTwo+'</td><td style="text-align: left;">'+v.personnelNamesOne+'</td><td style="text-align: left;">'+v.importantTrainee+'</td></tr>';htmlTr=$(htmlTr).data('data',v);htmlTbody.append(htmlTr)});$('.projectName').off().click(function(){window.location.href='calssBoardInfo.html?projectCode='+$(this).parents('tr').data('data').projectCode})}else{htmlTr+='<tr style="border:0px;background-color:#fff !important;" ><td colspan="7" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';htmlTbody.html(htmlTr)}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},halfData:function(dates,to){var date=new Date(dates);if(to=='next'){date.setTime(date.getTime()+15*24*60*60*1000);date=dateFormat('yyyy-MM-dd',date)}else if(to=='before'){date.setTime(date.getTime()-15*24*60*60*1000);date=dateFormat('yyyy-MM-dd',date)}else if(to=='onemonth'){date.setTime(date.getTime()+30*24*60*60*1000);date=dateFormat('yyyy-MM-dd',date)}return date;function dateFormat(fmt,d){var o={"M+":d.getMonth()+1,"d+":d.getDate(),"H+":d.getHours(),"m+":d.getMinutes(),"s+":d.getSeconds(),"q+":Math.floor((d.getMonth()+3)/3),"S":d.getMilliseconds()};if(/(y+)/.test(fmt)){fmt=fmt.replace(RegExp.$1,(d.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(fmt)){fmt=fmt.replace(RegExp.$1,(RegExp.$1.length==1)?(o[k]):(("00"+o[k]).substr((""+o[k]).length)))}}return fmt}}};$(function(){classBoardList.init()});