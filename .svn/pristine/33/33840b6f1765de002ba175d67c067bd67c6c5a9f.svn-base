var projectListInfo={init:function(){var projectType=$yt_common.GetQueryString("projectType");if(projectType==2||projectType==3){projectListInfo.getCompanyList();projectListInfo.getProjectListInfo()}else{projectListInfo.getNoDetailedList();if(projectType==1){projectListInfo.getDxProjectListInfo();$('.dx-table').show();$('.choose-table').hide()}}$(".page-return-btn").click(function(){window.location.href="projectBillInfo.html"});$('.project-company-tbody').on('click','.look-bill',function(){var projectType=$yt_common.GetQueryString("projectType");var groupId=$('.look-bill').children().val();if(projectType==4){projectListInfo.lookBiilInfo(groupId);projectListInfo.lookBillingInfoAlert()}});$('.search-btn').click(function(){})},getCompanyList:function(){$yt_baseElement.showLoading();var projectCode=$yt_common.GetQueryString("projectCode");$.ajax({async:true,url:$yt_option.base_path+"finance/settlement/getDetailedList",type:"post",data:{projectCode:projectCode},objName:'data',success:function(data){if(data.flag==0){var htmlTbody=$('.project-company-tbody');var htmlTr='';$(htmlTbody).empty();if(data.data.length>0){htmlTbody.empty();$.each(data.data.settlementGroupDetails,function(i,v){if(v.reconciliationState==0){v.reconciliationState="未入账"}else{v.reconciliationState="已入账"}htmlTr+='<tr><td style="text-align:left;">'+v.groupName+'</td><td class="already" style="text-align:right;">'+v.amountReceivable+'</td><td class="look-bill" style="text-align:right;color: #4169E1;">开票信息</td><td style="text-align:right;font-weight: bold;">'+v.netReceipts+'</td><td style="text-align:right;font-weight: bold;">'+v.uncollected+'</td><td style="text-align:right;font-weight: bold;">'+v.reconciliationState+'</td></tr>'})}else{htmlTbody.empty();htmlTr='<tr style="border:0px;background-color:#fff !important;" ><td colspan="6" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>'}htmlTbody.html(htmlTr);$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},getNoDetailedList:function(){$yt_baseElement.showLoading();var projectCode=$yt_common.GetQueryString("projectCode");$.ajax({async:true,url:$yt_option.base_path+"finance/settlement/getNoDetailedList",type:"post",data:{projectCode:projectCode},success:function(data){if(data.flag==0){var htmlTbody=$('.project-company-tbody');var htmlTr='';$(htmlTbody).empty();if(data.data.length>0){htmlTbody.empty();$.each(data.data,function(i,v){if(v.reconciliationState==0){v.reconciliationState=="未入账"}else{v.reconciliationState=="已入账"}htmlTr+='<tr><td style="text-align:left;"><input type="hidden" class="project-type" value="'+v.groupId+'" />'+v.groupName+'</td><td class="should" style="text-align:right;">'+v.amountReceivable+'</td><td class="already look-bill" style="text-align:right;color: #4169E1;"><input type="hidden" class="groupId" value="'+v.groupId+'" />开票信息</td><td class="account" style="text-align:right;">'+v.netReceipts+'</td><td style="text-align:right;font-weight: bold;">'+v.uncollected+'</td><td style="text-align:right;font-weight: bold;">'+v.reconciliationState+'</td></tr>'})}else{htmlTbody.empty();htmlTr='<tr style="border:0px;background-color:#fff !important;" ><td colspan="6" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>'}htmlTbody.html(htmlTr);$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},getProjectListInfo:function(){var projectCode=$yt_common.GetQueryString("projectCode");var selectParam=$('.selectParam').val();$('.project-student-page').pageInfo({async:true,pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"finance/settlement/getDetailedPersonalList",type:"post",data:{projectCode:projectCode,selectParam:selectParam},before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){var htmlTbody=$('.choose-tbody');var htmlTr='';if(data.data.rows.length>0){$.each(data.data.rows,function(i,v){$('.choose-tbody').empty();if(v.reconciliationState==0){v.reconciliationState=="未入账"}else{v.reconciliationState=="已入账"}if(v.gender==1){v.gender="男"}else{v.gender="女"}htmlTr+='<tr><td>'+i+'</td><td style="text-align:left"><input type="hidden" class="traineeId" value="'+v.traineeId+'" />'+v.groupName+'</td><td><a style="color: #4169E1;">'+v.realName+'</a></td><td>'+v.gender+'</td><td>'+v.phone+'</td><td style="text-align:right">'+v.trainingExpenseNegotiatedPrice+'</td><td style="text-align:right">'+v.quarterageNegotiatedPrice+'</td><td style="text-align:right">'+v.mealFeeNegotiatedPrice+'</td><td style="text-align:right">'+v.incidental+'</td><td style="text-align:right">'+v.trainingExpenseNegotiatedPrice+'</td><td style="text-align:right">'+v.cash+'</td><td style="text-align:right">'+v.uncollected+'</td><td style="text-align:right">'+v.reconciliationState+'</td></tr>'})}else{$('.choose-tbody').empty();htmlTr='<tr style="border:0px;background-color:#fff !important;" ><td class="project-student-td" colspan="13" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>'}htmlTbody.html(htmlTr);$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},getDxProjectListInfo:function(){var projectCode=$yt_common.GetQueryString("projectCode");var selectParam=$('.selectParam').val();$('.project-student-page').pageInfo({async:true,pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"finance/settlement/getNoDetailedPersonalList",type:"post",data:{projectCode:projectCode,selectParam:selectParam},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){var htmlTbody=$('.dx-tbody');var htmlTr='';if(data.data.rows.length>0){$('.dx-tbody').empty();$.each(data.data.rows,function(i,v){if(v.reconciliationState==0){v.reconciliationState=="未入账"}else{v.reconciliationState=="已入账"}if(v.gender==1){v.gender="男"}else{v.gender="女"}htmlTr+='<tr><td>'+i+'</td><td style="text-align:left"><input type="hidden" class="traineeId" value="'+v.traineeId+'" />'+v.groupName+'</td><td><a style="color: #4169E1;">'+v.realName+'</a></td><td>'+v.gender+'</td><td>'+v.phone+'</td><td style="text-align:right">'+v.otherCost+'</td><td style="text-align:right">'+v.otherCost+'</td><td style="text-align:right">'+v.netReceipts+'</td><td style="text-align:right">0.00</td><td style="text-align:right">'+v.reconciliationState+'</td></tr>'})}else{$('.dx-tbody').empty();htmlTr='<tr style="border:0px;background-color:#fff !important;" ><td class="project-student-td" colspan="10" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>'}htmlTbody.html(htmlTr);$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},projectTypeInfo:function(code){if(code==1){return "计划"}else if(code==2){return "委托"}else if(code==3){return "选学"}else if(code==4){return "调训"}else{return ''}},lookBiilInfo:function(groupId){var projectCode=$yt_common.GetQueryString("projectCode");$.ajax({type:"post",url:$yt_option.base_path+"finance/projectInvoice/getInvoice",data:{projectCode:projectCode,types:"1",traineeOrGroupId:groupId},success:function(data){if(data.flag==0){if(data.data.length>0){$('.look-bill-info-table .invoice-model-info').text(data.data.invoiceModel);$('.look-bill-info-table .org-name-info').text(ata.data.orgName);$('.look-bill-info-table .tax-number-info').text(ata.data.taxNumber);$('.look-bill-info-table .address-info').text(ata.data.address);$('.look-bill-info-table .telephone-info').text(ata.data.telephone);$('.look-bill-info-table .registered-bank-info').text(ata.data.registeredBank);$('.look-bill-info-table .account-info').text(ata.data.account)}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading()}}})},lookBillingInfoAlert:function(){$(".look-billing-inf-alert").show();$yt_alert_Model.setFiexBoxHeight($(".look-billing-inf-alert .alert-form"));$yt_alert_Model.getDivPosition($(".look-billing-inf-alert"));$yt_model_drag.modelDragEvent($(".look-billing-inf-alert .yt-edit-alert-title"));$('.look-billing-inf-alert .yt-eidt-model-bottom .yt-model-canel-btn').off().on("click",function(){$(".look-billing-inf-alert").hide();$("#pop-modle-alert").hide()});$('.look-billing-inf-alert .yt-eidt-model-bottom .yt-model-sure-btn').off().on("click",function(){$(".look-billing-inf-alert").hide();$("#pop-modle-alert").hide()})}};$(function(){projectListInfo.init()});