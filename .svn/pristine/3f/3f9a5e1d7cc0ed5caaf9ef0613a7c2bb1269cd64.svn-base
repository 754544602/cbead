var projectList={init:function(){$(".plan-list-model").css("min-height",$(window).height()-52-$(".heard-query-model").height());$(window).resize(function(){$(".plan-list-model").css("min-height",$(window).height()-52-$(".heard-query-model").height())});var path="class/openHonors/lookForByBacklog";projectList.getPlanListInfo(path);$('#btn-type').val("1");$(".tab-title-list button").click(function(){$(this).addClass("active").siblings().removeClass("active");operate=$(this).text();if(operate=="• 待审批"){$('#btn-type').val("1");var path="class/openHonors/lookForByBacklog";projectList.getPlanListInfo(path)};if(operate=="• 审批记录"){$('#btn-type').val("2");var path="class/openHonors/lookForByApprove";projectList.getPlanListInfo(path)}});$('.list-tbody').on('click','.class-name',function(){var num=1;var pkId=$(this).parent().parent().find('.pkId').val();var types=$(this).parent().parent().find('.types').val();var taskName=$(this).parent().parent().find('.taskName').val();var btnTpye=$('#btn-type').val();if(btnTpye==1){projectList.getOneListInfo(pkId,types,taskName)}if(btnTpye==2){window.location.href="onlyLookApprove.html?pkId="+pkId+"&types="+types+"&num="+num;}});$('.key-word').on('click','.search-btn',function(){var btnType=$('#btn-type').val();if(btnType==1){var path="class/openHonors/lookForByBacklog";projectList.getPlanListInfo(path)}else{var path="class/openHonors/lookForByApprove";projectList.getPlanListInfo(path)}})},getOneListInfo:function(pkId,types,taskName){var num=1;$.ajax({type:"post",url:$yt_option.base_path+"class/openHonors/getBeanById",async:false,data:{pkId:pkId,types:types},success:function(data){if(data.flag==0){var flowLog=data.data.flowLog;var length=flowLog.length;var tastKeyType=flowLog[0].tastKey;var deleteReason=flowLog[0].deleteReason;if(length==0){}else if(tastKeyType=="activitiStartTask"){window.location.href="amendApprove.html?pkId="+pkId+"&types="+types+"&num="+num}else{window.location.href="lookOneInfoApprove.html?pkId="+pkId+"&types="+types+"&num="+num}}}})},getPlanListInfo:function(path){$yt_baseElement.showLoading();var queryParams=$('#keyword').val();$('.page-info').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+path,type:"post",data:{searchParameters:queryParams},objName:'data',success:function(data){if(data.flag==0){var htmlTbody=$('.class-tbody');var htmlTr='';var type="";var xuhao=1;var states="";if(data.data.rows.length>0){$.each(data.data.rows,function(i,v){xuhao=i+1;if(v.types==1){type="开班式"}if(v.types==2){type="结业式"}htmlTr+='<tr class="td-list"><td style="display:none;"><input class="pkId" type="hidden" value="'+v.pkId+'"></td><td style="display:none;"><input class="taskName" type="hidden" value="'+v.taskName+'"></td><td style="text-align:center;" >'+xuhao+'</td><td style="text-align:left;"><a style="color:#3c4687;" class="fsize yt-link class-name">'+v.className+'</a></td><td style="text-align:center;"><input type="hidden" value="'+v.types+'" class="types">'+type+'</td><td class="userName">'+v.userName+'</td><td style="text-align:center;">'+v.startTimeString+'</td><td style="text-align:center;" class="createUserName">'+v.createUserName+'</td><td style="text-align:center;">'+v.createTimeString+'</td><td style="text-align:center;" class="dealingWithPeople">'+v.dealingWithPeople+'</td></tr>'})}else{htmlTr+='<tr style="border:0px;background-color:#fff !important;" ><td colspan="8" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';$('.list-page').hide()}htmlTbody.html(htmlTr);$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })}};$(function(){projectList.init()});