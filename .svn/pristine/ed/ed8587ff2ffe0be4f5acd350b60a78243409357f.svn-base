var projectSettlementList={init:function(){$(".yt-select").niceSelect();$(".start-time-start").calendar({controlId:"startDate",dateFmt:"yyyy-MM-dd",nowData:false,upperLimit:$(".start-time-end")});$(".start-time-end").calendar({controlId:"endDate",dateFmt:"yyyy-MM-dd",nowData:false,lowerLimit:$(".start-time-start")});$(".end-time-start").calendar({controlId:"startDate",dateFmt:"yyyy-MM-dd",nowData:false,upperLimit:$(".end-time-end")});$(".end-time-end").calendar({controlId:"endDate",dateFmt:"yyyy-MM-dd",nowData:false,lowerLimit:$(".end-time-start")});projectSettlementList.getSettlementListInf();$(".settlement-tbody").on("click",".project-name",function(){var projectCode=$(this).parents("tr").find('td.project-code').text();var pkId=$(".yt-table-active .pkId").val();var projectCode=$(".yt-table-active .project-code").text();var projectType=$(".yt-table-active .projectType").val();window.location.href="projectDetails.html?pkId="+pkId+"&projectCode="+projectCode+"&projectType="+projectType});$(".key-word .search-btn").click(function(){projectSettlementList.resertForm();projectSettlementList.getSettlementListInf()});projectSettlementList.hideSearch()},resertForm:function(){$(".search-box input").val("");$(".search-box .yt-select").setSelectVal("")},getSettlementListInf:function(){selectParam=$(".selectParam").val();var projectCode=$(".project-code").val();var projectName=$(".project-name").val();var projectSell=$(".project-sell").val();var projectHead=$(".project-head").val();var projectStartDateStart=$(".start-time-start").val();var projectStartDateEnd=$(".start-time-end").val();var projectEndDateStart=$(".end-time-start").val();var projectEndDateEnd=$(".end-time-end").val();var amountReceivableStart=$(".amount-start").val();var amountReceivableEnd=$(".amount-end").val();var netReceiptsStart=$(".net-start").val();var netReceiptsEnd=$(".net-end").val();var uncollectedStart=$(".uncoll-start").val();var uncollectedEnd=$(".uncoll-end").val();var expenditureStart=$(".expend-start").val();var expenditureEnd=$(".expend-end").val();var projectType=$("#projectType").val();$('.settlement-page').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"finance/settlement/lookForAll",type:"post",async:true,data:{selectParam:selectParam,projectCode:projectCode,projectName:projectName,projectSell:projectSell,projectHead:projectHead,projectStartDateStart:projectStartDateStart,projectStartDateEnd:projectStartDateEnd,projectEndDateStart:projectEndDateStart,projectEndDateEnd:projectEndDateEnd,amountReceivableStart:amountReceivableStart,amountReceivableEnd:amountReceivableEnd,netReceiptsStart:netReceiptsStart,netReceiptsEnd:netReceiptsEnd,uncollectedStart:uncollectedStart,uncollectedEnd:uncollectedEnd,expenditureStart:expenditureStart,expenditureEnd:expenditureEnd,projectType:projectType},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){var htmlTbody=$('.settlement-tbody');var htmlTr='';if(data.data.rows.length>0){$('.settlement-page').show();var projectTypeName="";$.each(data.data.rows,function(i,v){if(v.projectHead=="null"||v.projectHead==null){v.projectHead=""}if(v.projectSell=="null"||v.projectSell==null){v.projectSell=""}if(v.projectType==1){projectTypeName="计划"}else if(v.projectType==2){projectTypeName="委托"}else if(v.projectType==3){projectTypeName="选学"}else if(v.projectType==4){projectTypeName="中组部调训"}else if(v.projectType==5){projectTypeName="国资委调训"}v.amountReceivable=$yt_baseElement.fmMoney(v.amountReceivable);v.netReceipts=$yt_baseElement.fmMoney(v.netReceipts);v.uncollected=$yt_baseElement.fmMoney(v.uncollected);v.expenditure=$yt_baseElement.fmMoney(v.expenditure);htmlTr+='<tr><td class="project-code"><input type="hidden" value="'+v.pkId+'" class="pkId">'+v.projectCode+'</td><td style="text-align: left;"><a style="color: #3c4687;" class="project-name">'+v.projectName+'</a></td><td><input type="hidden" value="'+v.projectType+'" class="projectType">'+projectTypeName+'</td><td style="text-align: left;">'+v.projectSell+'</td><td style="text-align: left;">'+v.projectHead+'</td><td>'+v.projectDate+'</td><td style="text-align: right;">'+v.amountReceivable+'</td><td style="text-align: right;">'+v.netReceipts+'</td><td style="text-align: right;">'+v.uncollected+'</td><td style="text-align: right;">'+v.expenditure+'</td></tr>'})}else{$('.settlement-page').hide();htmlTr+='<tr style="border:0px;background-color:#fff !important;" ><td colspan="10" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>'}htmlTbody.html(htmlTr);$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},hideSearch:function(){var clickTime=0;$("button.senior-search-btn").click(function(e){if(clickTime%2==0){$(".search-box").show();$(".search-put").addClass('flipy')}else{$(".search-box").hide();$(".search-put").removeClass('flipy');}clickTime+=1;e.stopPropagation()});$(document).click(function(e){clickTime=0;$(".search-box").hide();$(".search-put").removeClass('flipy');e.stopPropagation()});$(".search-box .yt-model-reset-btn").click(function(){projectSettlementList.resertForm();projectSettlementList.getSettlementListInf()});$(".search-box .yt-model-sure-btn").click(function(){projectSettlementList.getSettlementListInf()})}};$(function(){projectSettlementList.init()});