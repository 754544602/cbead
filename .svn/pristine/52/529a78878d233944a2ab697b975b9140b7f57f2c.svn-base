var beforeApproList={searchInput:function(){$('.search').on('keydown',function(){if($(this).val()!=''){$('.clearImg').show()}});$('.clearImg').on('click',function(){$('.search').val('');$(this).hide();beforeApproList.getPendingList()});$("#resetBtn").off().on("click",function(){$('.search').val('');$(".clearImg").hide();beforeApproList.getPendingList()});$("#heardSearchBtn").off().on("click",function(){beforeApproList.getPendingList()});$(".wait-table").on('click','.process-state',function(){var processInstanceId=$(this).parents("tr").find(".processInstanceId").val();sysCommon.processStatePop(processInstanceId)})},getPendingList:function(){var queryParams=$('#keywordInput').val();$('.page1').pageInfo({pageIndex:1,pageNum:15,pageSize:10,url:'budget/appMain/myApplicationAppInfo',data:{queryParams:queryParams},objName:'data',success:function(data){var datas=data.data.rows;var htmlTbody=$('.wait-table .yt-tbody');htmlTbody.empty();var trStr="";if(data.flag==0){if(datas.length>0){$('.page1').show();sysCommon.isWorkFlowStateStr=','+sysCommon.isWorkFlowStateStr+',';$.each(datas,function(i,n){trStr+='<tr><td><input type="hidden" class="budgetAppId" value="'+n.budgetAppId+'"/><input type="hidden" class="processInstanceId" value="'+n.processInstanceId+'"/>'+n.applicantTime+'</td><td><a class="yt-link to-detail">'+n.budgetAppNum+'</a></td><td>'+n.budgetYear+'</td><td budgetStage="'+n.budgetStage+'">'+n.budgetStageName+'</td>';if(sysCommon.isWorkFlowStateStr.indexOf(','+n.workFlowState+',')==-1){trStr+='<td style=""><span class="yt-link process-state">'+n.nodeNowState+'</span></td>'}else{trStr+='<td style="">'+n.nodeNowState+'</td>'}trStr+='</tr>';trStr=$(trStr).data("dataStr",n);htmlTbody.append(trStr)});beforeApproList.goApprovePage();sysCommon.initQtip($(".log-mod"));beforeApproList.toDetails()}else{$('.page1').hide();htmlTbody.append(sysCommon.noDataTrStr(8))}}else{$('.page1').hide();htmlTbody.append(sysCommon.noDataTrStr(8));$yt_alert_Model.prompt(data.message)}},isSelPageNum:true })},toDetails:function(){$('.yt-link.to-detail').off("click").on('click',function(){$yt_baseElement.eventStopPageaction();var processInstanceId=$(this).parents('tr').find('.processInstanceId').val();var budgetAppId=$(this).parents('tr').find('.budgetAppId').val();var pageUrl="view/system-sasac/budget/module/approval/budgetDetails.html?processInstanceId="+processInstanceId+"&budgetAppId="+budgetAppId;$yt_baseElement.openNewPage(2,pageUrl)})},goApprovePage:function(){$(".apprv-btn").off().click(function(){var pageUrl='';if(state=='activitiStartTask'){pageUrl=''}else{pageUrl=''}parent.parent.$yt_baseElement.showLoading();window.location.href=$yt_option.websit_path+pageUrl})}};$(function(){beforeApproList.searchInput();beforeApproList.getPendingList();$("#reimApproList").css("min-height",$(window).height()-12)});