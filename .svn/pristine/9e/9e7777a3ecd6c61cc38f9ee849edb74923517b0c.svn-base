var budgetReport={init:function(){$("#budgetReport").css("min-height",$(window).height()-12);$("select").niceSelect();$(".budget-radio .yt-radio input").change(function(){budgetReport.tablePage($(".budget-year").val())});budgetReport.getBudgetYear();budgetReport.clickBudgetOrgan()},clickBudgetOrgan:function(){$(".budget-organ").click(function(){var selTrLen=$(".before-apply-table tbody tr.yt-table-active").length;var tableData=$(".before-apply-table tbody tr.yt-table-active").data("tableData");if(selTrLen==0){$yt_alert_Model.prompt("请选择一行数据进行操作")}else{window.location.href=$yt_option.websit_path+"view/system-sasac/budget/module/expenditure/budgetStatistics.html?tableId="+tableData.tableId+"&publishId="+tableData.publishTableId}})},getBudgetYear:function(){$.ajax({type:"post",url:"budget/report/getBudgetYear",async:false,success:function(data){var datas=data.data;if(data.flag==0){$.each(datas,function(i,n){$('select.budget-year').append('<option value="'+n.bookYear+'">'+n.bookYear+'</option>')});$("select.budget-year").niceSelect();budgetReport.tablePage($(".budget-year").val());budgetReport.getBudgetStageOption($(".budget-year").val());$("select.budget-year").change(function(){var thisYear=$(this).val();budgetReport.getBudgetStageOption(thisYear)})}}})},getBudgetStageOption:function(thisYear){$.ajax({type:"post",url:"budget/report/getBudgetStageOption",async:false,data:{budgetYear:thisYear},success:function(data){var datas=data.data;if(data.flag==0){$('.budget-radio input.docu-style[value="'+datas+'"]').setRadioState("check");budgetReport.tablePage(thisYear)}}})},tablePage:function(budgetYear){var budgetStage=$(".budget-radio .yt-radio input:checked").val();$('.before-table-page').pageInfo({pageIndex:1,pageNum:15,pageSize:5,url:"budget/report/getPageReportBudgetTableList",type:"post",async:false,data:{budgetYear:budgetYear,budgetStage:budgetStage},success:function(data){var htmlTbody=$('.before-apply-table .yt-tbody');htmlTbody.empty();var trStr="";if(data.flag==0){var datas=data.data.rows;if(datas.length>0){$('.before-table-page').show();var editorState='';$.each(datas,function(i,n){switch(n.editorState){case 1:editorState='未开始';break;case 2:editorState='编制中';break;case 3:editorState='编制完成';break}trStr+='<tr><td>'+n.tableCode+'</td><td>'+n.budgetTypeName+'</td><td style="text-align: left;" class="text-overflow" title="'+n.tableName+'">'+n.tableName+'</td><td>'+(n.budgetStage==1?'一上阶段':'二上阶段')+'</td><td>'+editorState+'</td><td style="text-align: right;" title="'+n.submitRemainTime+'">'+n.submitRemainTimeShort+'</td><td lockState="'+n.lockState+'">'+(n.submitState==1?'已提交（锁定）':'未提交')+'</td><td>'+n.lastUpdateTime.substring(0,n.lastUpdateTime.length-3)+'</td></tr>';trStr=$(trStr).data("tableData",n);htmlTbody.append(trStr)})}else{$('.before-table-page').hide();htmlTbody.html(sysCommon.noDataTrStr(9))}}else{$('.before-table-page').hide();htmlTbody.html(sysCommon.noDataTrStr(9));$yt_alert_Model.prompt(data.message)}},isSelPageNum:true })}};$(function(){budgetReport.init()});