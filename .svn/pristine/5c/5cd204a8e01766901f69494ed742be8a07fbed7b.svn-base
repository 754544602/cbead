var project={thisDate:"",init:function(){$("#paymentRequest").css("min-height",$(window).height()-12);project.events();$("#startDate").calendar({controlId:"startTime",upperLimit:$("#endDate"),speed:0,nowData:false,callback:function(){}});$("#endDate").calendar({controlId:"endTime",lowerLimit:$("#startDate"),speed:0,nowData:false,callback:function(){}});project.tablePage()},events:function(){$("#heardSearchBtn").click(function(){project.tablePage()});$("#resetBtn").click(function(){$(".query-text").val("");$("#startDate").val(project.thisDate);$("#endDate").val(project.thisDate);$(".date-sort-btn,.money-sort-btn,.clip-sort-btn,.bank-sort-btn").removeClass("sort-btn-style");project.tablePage()});},tablePage:function(){var queryParams=$(".query-text").val();var startDate=$("#startDate").val();var endDate=$("#endDate").val();$('.payment-table-page').pageInfo({pageIndex:1,pageNum:15,pageSize:5,url:'budget/prjApp/getBudgetPrjAppInfoToDraftsPageByParams',type:"post",async:false,data:{queryParams:queryParams,startTime:startDate,endTime:endDate},success:function(data,pageObj){var htmlTbody=$('.payment-table .yt-tbody');htmlTbody.empty();var trStr="";if(data.flag==0){var datas=data.data.rows;if(datas.length>0){$('.payment-table-page').show();$.each(datas,function(i,n){trStr+='<tr><td>'+n.applicantTime+'</td><td style="text-align: left;" class="text-overflow" title="'+n.prjName+'">'+n.prjName+'</td><td style="text-align: left;" class="text-overflow" title="'+n.prjUnitName+'">'+n.prjUnitName+'</td><td>'+n.prjClassifyName+'</td><td style="width: 150px;"><span class="operate-update" style="margin-right: 23px;"><img src="../../../../../resources-sasac/images/common/edit-icon.png"></span><span class="operate-del"><img src="../../../../../resources-sasac/images/common/del-icon.png"></span></td></tr>';trStr=$(trStr).data("draData",n);htmlTbody.append(trStr)})}else{$('.payment-table-page').hide();htmlTbody.append(sysCommon.noDataTrStr(5))}}project.clickUpdate();project.deleteBudgetPrjAppInfoById()},isSelPageNum:true })},clickUpdate:function(){$(".operate-update").off().click(function(){var draData=$(this).parents('tr').data('draData');var draCode="1";var pageUrl='view/system-sasac/budget/module/projectApproval/projectApplyApproval.html?budgetPrjAppId='+draData.budgetPrjAppId+'&processInstanceId='+draData.processInstanceId+"&draCode="+draCode;parent.parent.$yt_baseElement.showLoading();window.location.href=$yt_option.websit_path+pageUrl})},deleteBudgetPrjAppInfoById:function(){$('.operate-del').click(function(){var draData=$(this).parents('tr').data('draData');$yt_alert_Model.alertOne({alertMsg:"数据删除将无法恢复,确认删除吗?",confirmFunction:function(){$.ajax({type:"post",url:'budget/prjApp/deleteBudgetPrjAppInfoById',async:true,data:{budgetPrjAppId:draData.budgetPrjAppId},success:function(data){$yt_alert_Model.prompt(data.message);project.tablePage()}})}})})}};$(function(){project.init()});