var trainingProgramsList={init:function(){$("select").niceSelect();$(".chose-year").calendar({speed:200,complement:true,readonly:true,lowerLimit:"NaN",nowData:true,dateFmt:"yyyy",callback:function(){}});$(".addList").on('click',function(){window.location.href=$yt_option.base_path+"website/view/project/addProjectList.html"});$(".updateList").on('click',function(){if($("tr.yt-table-active").length==0){$yt_alert_Model.prompt("请选择要修改的数据");return false}window.location.href=$yt_option.base_path+"website/view/project/addProjectList.html?pkId="+$('.yt-table-active .pkId').val()});$(".train-tbody").on('click',".real-name-inf",function(){window.location.href=$yt_option.base_path+"website/view/project/projectDetails.html?pkId="+$('.yt-table-active .pkId').val()});$(".set-principal-btn").on('click',function(){if($("tr.yt-table-active").length==0){$yt_alert_Model.prompt("请选择要操作的数据");return false}trainingProgramsList.setPrincipal()});trainingProgramsList.getTrainingProgramsList();trainingProgramsList.getAnnualTarget();$(".amend-annual-target").click(function(){$(this).hide();$(".save-annual-target").show();$(".save-annual-target").click(function(){trainingProgramsList.saveAnnualTarget();$(this).hide();$(".amend-annual-target").show()})})},getTrainingProgramsList:function(){var selectParam=$(".selectParam").val();var years=$(".chose-year").val();$('.train-page').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"project/lookForAllByTrainClass",type:"post",data:{selectParam:selectParam,years:years},objName:'data',success:function(data){if(data.flag==0){var htmlTbody=$('.list-table .train-tbody');var htmlTr='';if(data.data.rows.length>0){$(htmlTbody).empty();$.each(data.data.rows,function(i,v){htmlTr='<tr><td><input type="hidden" value="'+v.pkId+'" class="pkId">'+v.projectCode+'</td><td><a href="#" class="real-name-inf" style=" color:blue">'+v.projectName+'</a></td><td>'+v.projectType+'</td><td>'+v.startDate+'</td><td>'+v.trainDateCount+'</td><td>'+v.projectSell+'</td><td>'+v.projectHead+'</td><td>'+v.traineeCount+'</td><td>'+(v.projectStates==4?"已立项":(v.projectStates==5?"培训中":(v.projectStates==6?"未结项":"已结项")))+'</td></tr>';htmlTbody.append($(htmlTr).data("legalData",v))})}}else{$yt_alert_Model.prompt("查询失败")}},isSelPageNum:true })},setPrincipal:function(){$(".set-principal-alert").show();$yt_alert_Model.getDivPosition($(".set-principal-alert"));$yt_model_drag.modelDragEvent($(".set-principal-alert .yt-edit-alert-title"));$('.set-principal-alert .yt-eidt-model-bottom .yt-model-canel-btn').off().on("click",function(){$(".set-principal-alert").hide();$("#pop-modle-alert").hide()})},getAnnualTarget:function(){var yearData=$(".chose-date").val();$.ajax({type:"post",url:$yt_option.base_path+"class/trainee/getTrainPlanByTear",data:{yearData:yearData},success:function(data){if(data.flag==0){$(".annual-target").setDatas(data.data)}else{$yt_alert_Model.prompt("本年度班次目标操作失败")}}})},saveAnnualTarget:function(){var yearData=$(".chose-date").val();var trainCount=$(".annual-target-inf").val();$.ajax({type:"post",url:$yt_option.base_path+"class/trainee/updateTrainPlanByTear",data:{yearData:yearData,trainCount:trainCount},success:function(data){if(data.flag==0){$yt_alert_Model.prompt("本年度班次目标保存成功")}else{$yt_alert_Model.prompt("本年度班次目标保存失败")}}})}};$(function(){trainingProgramsList.init()});