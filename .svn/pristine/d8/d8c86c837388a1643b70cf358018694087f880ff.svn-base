<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" >

	<head>
		<meta http-equiv="x-ua-compatible" content="ie=Edge	" />
		<link rel="icon" href="./resources/images/icons/ICO.png" type="image/x-icon">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" type="text/css" href="./resources/js/scroll/jquery.mCustomScrollbar.css?v=20171208" />
		<link rel="stylesheet" type="text/css" href="./resources/css/common/yt-common.min.css?v=20171208" />
		<link rel="stylesheet" type="text/css" href="./resources/css/common/yt-frame-base.min.css?v=20171208" />
		<!--[if lt IE 9 ]><link rel="stylesheet" type="text/css" href="./resources/css/common/yt-common-ie.min.css"/><![endif]-->
		<script type="text/javascript" src="./resources/js/common/jquery.min.js"></script>
		<!--滚动条js-->
		<script type="text/javascript" defer="defer" src="./resources/js/scroll/jquery.mCustomScrollbar.concat.min.js"></script>
		<script type="text/javascript" defer="defer" src="./resources/js/common/yt-option.js?v=20171208"></script>
		<script type="text/javascript" defer="defer" src="./resources/js/common/yt-common.min.js?v=20171208"></script>
		<script type="text/javascript" defer="defer" src="./resources/js/common/yt-frame.min.js?v=20171208"></script>
		<script type="text/javascript" defer="defer" src="./resources/js/valid/yt-valid.min.js?v=20171208"></script>
		
		<title>中国大连高级经理学院教学管理ERP信息系统</title>
	</head>
	<style>
		.qtip-default {
			display: none;
		}
		.cont-edit-test{
			box-shadow: none;
		}
		.revise-password-box tr,.revise-password-box td{
		 	    height: 40px;
		}   
	</style>

	<body>
		<div id="yt-index-head-nav">
			<!--<img class="top-img" src="resources/images/top-img.jpg" />-->
			<div class="head-top-nav">
				<img src="./resources/images/common/nav-logo.png" class="heard-top-img">
			</div>
			<div class="nav-right-model">
				<ul id="nav-fun-list">
					<li>
						<div class="home-model">
							<img class="nav-fun-icon" src="./resources/images/common/index-icon1.png" style="margin-bottom: 5px;" /><span>首页</span>
							<input type="hidden" class="nav-fun-hid" value="index" />
						</div>
					</li>
					<li>
						<div class="message-model">
							<img class="nav-fun-icon" src="./resources/images/common/message.png" /><span>消息</span>
							<input type="hidden" class="nav-fun-hid" value="" />
						</div>
					</li>
					<li>
						<div class="revise-model">
							<img class="nav-fun-icon" src="./resources/images/common/revise.png" /><span>修改密码</span>
							<input type="hidden" class="nav-fun-hid" value="" />
						</div>
					</li>
					<li>
						<div class="logout-model">
							<img class="nav-fun-icon" src="./resources/images/common/logo-out-icon1.png" /><span>注销</span>
							<input type="hidden" class="nav-fun-hid" value="out" />
						</div>
					</li>
					<li class="users-info-li"><!-- <img src="resources/images/common/user-photo-def.png" /> --><span class="logo-user-name"></span></li>
					<!--<li class="li-bak" style="display: none;"></li>-->
				</ul>
				<div style="clear: both;"></div>
			</div>
			<div id="heard-nav-bak"></div>
		</div>
		<div id="yt-index-bottom-nav">
			<!--左侧菜单START-->
			<div id="yt-index-left-nav">
				<div id="left-menu-cnt">
					<div id="nav-resource">
						
					</div>
				</div>
			</div>
			<!--左侧菜单END-->
			<!--右侧子页面内容START-->
			<div id="frame-right-model">
				<div id="yt-index-main-nav">
				</div>
			</div>
			<!--右侧子页面内容END-->

		</div>
		
			<!--新增来往记录弹窗STAR-->
			<div class="yt-pop-model yt-edit-alert revise-password-box" style="width: 480px;z-index: 9999;">
				<div class="yt-edit-alert-title ">
					<span class="main-title-span">修改密码</span>
				</div>
				<div class="yt-edit-alert-main cont-edit-test">
					<form action="">
						<table style="margin: 0 auto;">
							<tr><td style="text-align: right;">用户：</td><td class="yt-username"></td></tr>
							<tr>
								<td style="text-align: right;">原登录密码：</td>
								<td style="position: relative;">
									<input type="text" class="yt-input oldPassword" placeholder="请输入原登录密码" validform="{isNull:true,blurFlag:true,msg:'请输入原密码'}"/>
									<span class="valid-font"></span>
								</td>
							</tr>
							<tr>
								<td style="text-align: right;">新登录密码：</td>
								<td style="position: relative;">
									<input type="text" class="yt-input newPassword" placeholder="建议字母、数字以及符号的组合"  validform="{isNull:true,blurFlag:true,msg:'请输入新登录密码'}"/>
									<span class="valid-font"></span>
								</td>
							</tr>
							<tr>
								<td style="text-align: right;">重复新登录密码：</td>
								<td style="position: relative;">
									<input type="text" class="yt-input newPassword2" placeholder="请再次输入新登录密码" validform="{isNull:true,blurFlag:true,msg:'请再次输入新登录密码'}"/>
									<span class="valid-font"></span>
								</td>
							</tr>
						</table>
						
					</form>
				</div>
				<div class="yt-eidt-model-bottom select-teacher-btn-div">
					<input class="yt-model-bot-btn yt-model-sure-btn" id="submit" type="button" value="确定" />
					<input class="yt-model-bot-btn yt-model-canel-btn " type="button" value="取消" style="margin-left: 20px;" />
				</div>
			</div>
			<!--新增来往记录弹窗END-->
	</body>

</html>
<script>
	$(function() {
		$left_menu.init();
		var divMinHei = $(window).height() - 80;
		$(".web-criterion-model").css("min-height", divMinHei);
		//给滚动条设置高度
		$("#left-menu-cnt").css("height", divMinHei);
		//左菜单调用滚动条方法
		$(window).load(function() {
			$("#left-menu-cnt").mCustomScrollbar({
				autoHideScrollbar: true,
				theme: "square"
			});
		});
	/*
	 * 
	 * 修改密码
	 * 
	 * */
	$('.revise-model').click(function(){
		//初始化弹出框
		$(".revise-password-box .cont-edit-test input").val('');
		$(".revise-password-box .cont-edit-test input").removeClass('valid-hint');
		$(".revise-password-box .valid-font").text('');
		$('#pop-modle-alert').css('z-index','1000');
		$('#pop-modle-bg').css('z-index','10000');
		$('.loading-model').css('z-index','10001');
		/** 
			 * 显示编辑弹出框和显示顶部隐藏蒙层 
			 */
			$(".revise-password-box").show();
			/** 
			 * 调用算取div显示位置方法 
			 */
			$yt_alert_Model.getDivPosition($(".revise-password-box"));
			/* 
			 * 调用支持拖拽的方法 
			 */
			$yt_model_drag.modelDragEvent($(".revise-password-box .yt-edit-alert-title"));
			/** 
			 * 点击取消方法 
			 */
			$('.revise-password-box .yt-username').text($yt_common.user_info.userRealName);
			$('.revise-password-box .yt-eidt-model-bottom .yt-model-canel-btn').off().on("click", function() {
				//隐藏页面中自定义的表单内容  
				$(".revise-password-box").hide();
				//隐藏蒙层  
				$("#pop-modle-alert").hide().css('z-index','999');
			});
			$('.newPassword2').blur(function(){
				if($('.newPassword').val() != $('.newPassword2').val()){
					$('.newPassword2').siblings('.valid-font').text('两次密码输入不一致！')
				}
			})
			$('.revise-password-box #submit').click(function(){
				if($yt_valid.validForm($(".revise-password-box"))){
				if($('.newPassword').val() == $('.newPassword2').val() ){
					debugger
					$.ajax({
					type:"post",
					url:$acl_path + "api/user/updatePassword",
					async:true,
					beforeSend:function(){
						$yt_baseElement.showLoading();
					},
					data:{
						userItCode:$yt_common.user_info.userName,
						passwordNew:$('.newPassword').val(),
						passwordOld:$('.oldPassword').val()
					},
					success:function(data){
						if(data.success==0){
						$yt_baseElement.hideLoading(function(){
							$yt_alert_Model.prompt("修改成功");
							//隐藏页面中自定义的表单内容  
							$(".revise-password-box").hide();
							//隐藏蒙层  
							$("#pop-modle-alert").hide().css('z-index','999');
						});	
						}else{
						$yt_baseElement.hideLoading(function(){
							$yt_alert_Model.prompt(data.msg);
						});
						}
					},
					error:function(data){
						$yt_baseElement.hideLoading(function(){
							$yt_alert_Model.prompt("网络异常，请稍后重试");
						});	
					}
				});
				}else{
					$('.newPassword2').siblings('.valid-font').text('两次密码输入不一致！')
				}
				}
			})
			
	})
	
	});
	/**
	 * 关闭窗体方法
	 */
	function closeWindow(){
		window.opener=null;
		window.open('','_self');
		window.close();
	}
</script>