var printingList={init:function(){printingList.getprintingListInfo();$('.seach-btn').click(function(){printingList.getprintingListInfo()});$(".btn-invalid").click(function(){if($("tr.yt-table-active").length==0){$yt_alert_Model.prompt("请选择要修改的数据");return false}var states=4;printingList.amendPrintingStates(states);$yt_alert_Model.prompt("已作废")});$(".btn-restore").click(function(){if($("tr.yt-table-active").length==0){$yt_alert_Model.prompt("请选择要修改的数据");return false}var states=3;printingList.amendPrintingStates(states);$yt_alert_Model.prompt("已恢复")});$(".printing-tbody").on('click','.file-name',function(){window.location.href="printingDetails.html?pkId="+$('.yt-table-active .pkId').val()})},getprintingListInfo:function(){$yt_baseElement.showLoading();searchParameters=$('#keyword').val();$('.printing-page').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"class/printing/lookForAll",type:"post",data:{searchParameters:searchParameters,printingStates:"",startTime:"",endTime:"",createTimeStart:"",createTimeEnd:""},objName:'data',success:function(data){$yt_baseElement.showLoading();if(data.flag==0){var htmlTbody=$('.printing-tbody');var htmlTr='';var num=1;if(data.data.rows.length>0){$.each(data.data.rows,function(i,v){if(v.projectCode==null){v.projectCode=""}if(v.projectName==null){v.projectName=""}if(v.projectUserName=="null"){v.projectUserName=""}if(v.startDate==null){v.startDate=""}if(v.endDate==null){v.endDate=""}htmlTr+='<tr><td><input type="hidden" value="'+v.pkId+'" class="pkId">'+num++ +'</td><td><a class="file-name">'+v.fileName+'</a></td><td>'+v.createUser+'</td><td>'+v.createTimeString+'</td><td class="text-overflow">'+v.projectCode+'</td><td class="text-overflow">'+v.projectName+'</td><td>'+v.projectUserName+'</td><td>'+v.startDate+'</td><td>'+v.endDate+'</td><td>'+(v.states==1?"打印中":(v.states==2?"已完成":(v.states==3?"等待打印":"已作废")))+'</td></tr>'})}else{htmlTr+='<tr style="border:0px;background-color:#fff !important;" ><td colspan="10" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>'}htmlTbody.html(htmlTr);$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},amendPrintingStates:function(states){var pkId=$(".yt-table-active .pkId").val();$.ajax({type:"post",url:$yt_option.base_path+"class/printing/updatePrinting",data:{pkId:pkId,states:states},success:function(data){if(data.flag==0){$('.printing-page').pageInfo("refresh")}else{$yt_alert_Model.prompt("操作失败")}}})}};$(function(){printingList.init()});