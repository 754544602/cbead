/**
 * 费用支付反馈列表查询
 */
var projectList={init:function(){projectList.getPlanListInfo();$('.list-table').on("click",".class-name",function(){var pkId=$(this).parents("tr").find('.pkId').text();var expenseType=$(this).parents("tr").find('.expenseType').text();var workFlawState=$(this).parents("tr").find('.workFlawState').text();if(expenseType==1){if(workFlawState=='已开票'){window.location.href="reimbursementLook.html?pkId="+pkId}else{window.location.href="reimburDetailPayment.html?pkId="+pkId}}if(expenseType==2){if(workFlawState=='已开票'){window.location.href="reimburseTravelDetailsLook.html?pkId="+pkId}else{window.location.href="reimburseTravelDetailsPayment.html?pkId="+pkId}}});$('.back-btn').click(function(){window.history.back()});$('.search-btn').click(function(){projectList.getPlanListInfo()})},getPlanListInfo:function(){$yt_baseElement.showLoading();var queryParams=$('#keyword').val();$('.page-info').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"finance/teacherExpense/lookForAll",type:"post",data:{selectParam:queryParams,createTimeStart:"",createTimeEnd:"",teacherCountStart:"",teacherCountEnd:"",expenseMoneyStart:"",expenseMoneyEnd:"",expenseType:"",workFlawState:"已完成"},objName:'data',success:function(data){if(data.flag==0){var htmlTbody=$('.open-class-tbody').empty();var htmlTr='';var num=0;if(data.data.rows.length>0){$.each(data.data.rows,function(i,v){num+=1;var expenseType=Number(v.expenseType);if(expenseType==1){expenseType='教师课酬报销'}if(expenseType==2){expenseType='教师差旅报销'}htmlTr='<tr class="td-list"><td class="pkId" style="display:none;">'+v.pkId+'</td><td class="paymentState" style="display:none;">'+v.paymentState+'</td><td><a class="class-name"style="color: #3c4687;">'+v.flowNumber+'</a></td><td class="expenseType" style="display:none;">'+v.expenseType+'</td><td>'+expenseType+'</td><td>'+v.projectCode+'</td><td>'+v.projectName+'</td><td>'+v.projectHead+'</td><td>'+v.createTime+'</td><td>'+v.teacherCount+'</td><td>'+$yt_baseElement.fmMoney(v.expenseMoney,2)+'</td><td class="workFlawState">'+v.workFlawState+'</td></tr>';htmlTbody.append(htmlTr)})}if(num==0){htmlTr='<tr style="border:0px;background-color:#fff !important;" ><td colspan="8" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';htmlTbody.append(htmlTr)}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},deleteReimbursement:function(){if($("tr.yt-table-active").length==0){$yt_alert_Model.prompt("请选择要操作的数据");return false}var pkId=$(".yt-table-active .pkId").text();var downUrl=$yt_option.base_path+"finance/teacherExpense/removeBeanByIdTravel";$.ajaxDownloadFile({url:downUrl,data:{pkId:pkId,isDownload:true}})},refreshEffective:function(){$('.page-info').pageInfo("refresh")}};$(function(){projectList.init()});