var bankBillListInfo={init:function(){bankBillListInfo.getBillListInfo("2");bankBillListInfo.getBankStatementDetails();$(".page-return-btn").on("click",function(){window.location.href="bankBillList.html"});$(".check-box-load").on("change",function(){if($('.check-sure input[type="checkbox"]').is(':checked')){debugger;if($('.check-cancel input[type="checkbox"]').is(':checked')){bankBillListInfo.getBillListInfo("2")}else{bankBillListInfo.getBillListInfo("1")}}else{if($('.check-cancel input[type="checkbox"]').is(':checked')){bankBillListInfo.getBillListInfo("0")}else{$yt_baseElement.showLoading();htmlTr='<tr style="border:0px;background-color:#fff !important;" ><td colspan="18" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';$(".project-tbody").html(htmlTr);$yt_baseElement.hideLoading()}}});$(".bank-more-div").on("click",function(){$yt_baseElement.showLoading();if($(".bank-more-div").text()=="查看更多"){if($(".payment-list").hasClass("hide")){}else{$("#project-main").css("width",width+1500+"px")}var width=parseInt($("#project-main").css("width"));$("#project-main").css("width",width+1500+"px");$(".bank-th-hide").show();$(".bank-more-div").text("收起");$(".bank-more-div").css("right","-483px");var colspan=$(".bank-tbody-td").attr("colspan");$(".bank-tbody-td").attr("colspan",colspan+11)}else{var width=parseInt($("#project-main").css("width"));$("#project-main").css("width",width-1500+"px");$(".bank-th-hide").hide();$(".bank-more-div").text("查看更多");$(".bank-more-div").css("right","0px");var colspan=$(".bank-tbody-td").attr("colspan");$(".bank-tbody-td").attr("colspan",colspan-11)}$yt_baseElement.hideLoading()});$(".project-more-div").on("click",function(){$yt_baseElement.showLoading();debugger;if($(".project-more-div").text()=="查看更多"){var width=parseInt($("#project-main").css("width"));$("#project-main").css("width",width+385+"px");$(".project-th-hide").show();$(".project-more-div").text("收起");var colspan=$(".bank-tbody-td").attr("colspan");$(".bank-tbody-td").attr("colspan",colspan+3)}else{var width=parseInt($("#project-main").css("width"));$("#project-main").css("width",width-385+"px");$(".project-th-hide").show();$(".project-more-div").text("查看更多");var colspan=$(".bank-tbody-td").attr("colspan");$(".bank-tbody-td").attr("colspan",colspan-3)}$yt_baseElement.hideLoading()});$(".invalid-more-div").on("click",function(){$(".invalid-hide").show();$(".invalid-more-div").hide()});$(".account-entry-sure").on("click",function(){bankBillListInfo.accountEntryInfo("1")});$(".account-entry-cancel").on("click",function(){bankBillListInfo.accountEntryInfo("0")});$(".update-effective-true").on("click",function(){bankBillListInfo.updateEffectiveInfo("1")});$(".update-effective-cancel").on("click",function(){bankBillListInfo.updateEffectiveInfo("0")});$(".update-admission").on("click",function(){bankBillListInfo.updateAdmission("1")});$(".admission-manual").on("click",function(){var checkLength=$(".project-tbody").find('label input[type="checkbox"]:checked').length;if(checkLength==0){$yt_alert_Model.prompt("请选择一条信息进行入账");return false}bankBillListInfo.classAlertFunc()});$(".check-all").on("click",function(){if($(this).parent().hasClass("check")){$(this).parents("table").find("tbody input[type='checkbox']").setCheckBoxState("uncheck")}else{$(this).parents("table").find("tbody input[type='checkbox']").setCheckBoxState("check")}});$(".project-tbody,.person-tbody,.company-tbody").on("change","input[type='checkbox']",function(){if($(this).parents("table").find("tbody input[type='checkbox']").length!=$(this).parents("table").find("tbody input[type='checkbox']:checked").length){$(this).parents("table").find(".check-all").setCheckBoxState("uncheck")}else{$(this).parents("table").find(".check-all").setCheckBoxState("check")}})},classAlertFunc:function(){bankBillListInfo.getProjectInfo();$(".check-all").setCheckBoxState("uncheck");$(".project-name-select").setSelectVal("0");$(".project-name-select").niceSelect();bankBillListInfo.getNoDetailedList("0");bankBillListInfo.getDetailedPersonalList("0","");var identifications="";var bankStatementDetailsIds="";var htmlUl=$(".accountName");htmlUl.empty();$(".project-tbody").find('label input[type="checkbox"]:checked').each(function(i,v){var otherPartyName=$(this).parents("tr").find("td.otherPartyName").text();var htmlLi='<li>'+otherPartyName+'</li>';htmlUl.append(htmlLi);var identification=$(this).parents("tr").find("input.identification").val();var bankStatementDetailsId=$(this).parents("tr").find("input.pkId").val();if(i==0){identifications=identification;bankStatementDetailsIds=bankStatementDetailsId}else{identifications+=","+identification;bankStatementDetailsIds+=","+bankStatementDetailsId}});var projectCode="";$("select.project-name-select").change(function(){if($(this).val()=="OTHER"){$(".alert-table-div").hide();$(".alert-div-input").hide();$("#confiscate-amount").show();$("#user-name").css({float:"none",'margin':"8px 48px 8px 84px"});$("#last-amount").css({float:"none",'margin':"8px 0px 8px 42px"});$("#form-class").css({float:"none",'margin':"8px 48px 8px 84px"});$(".select-teacher-div").width("auto");$(".yt-edit-alert-main").height("auto");$('.association-sure-btn').off().on('click',function(){var uncollectedTotal=$(".uncollected-total").val();bankBillListInfo.addNotReconciliations("","","","",uncollectedTotal)});$yt_alert_Model.setFiexBoxHeight($(".select-teacher-div .yt-edit-alert-main"));$yt_alert_Model.getDivPosition($(".select-teacher-div"));$yt_model_drag.modelDragEvent($(".select-teacher-div .yt-edit-alert-title"));$("select").niceSelect()}else{$(".alert-table-div").show();$(".alert-div-input").show();$("#confiscate-amount").hide();$("#user-name").css({float:"left",'margin':"0px 0px 0px 20px"});$("#last-amount").css({float:"left",'margin':"0px 0px 0px 100px"});$("#form-class").css({float:"left",'margin':"0px 0px 0px 70px"});$(".select-teacher-div").width("1100px");$(".yt-edit-alert-main").height("736px");$yt_alert_Model.setFiexBoxHeight($(".select-teacher-div .yt-edit-alert-main"));$yt_alert_Model.getDivPosition($(".select-teacher-div"));$yt_model_drag.modelDragEvent($(".select-teacher-div .yt-edit-alert-title"));$("select").niceSelect();projectCode=$(this).val();bankBillListInfo.getNoDetailedList(projectCode);bankBillListInfo.getDetailedPersonalList(projectCode,"");$(".search-btn").click(function(){var keyword=$("#keyword").val();bankBillListInfo.getDetailedPersonalList(projectCode,keyword)});if($(".payment-list").hasClass("hide")||$(".identifications-div").text()!=""){var identifications=$(".identifications-div").text();bankBillListInfo.getProjectStatementByProjectCode(projectCode,identifications)}else{var identifications="";$(".project-tbody").find('label input[type="checkbox"]:checked').each(function(i,v){var identification=$(this).parents("tr").find("input.identification").val();if(i==0){identifications=identification}else{identifications+=","+identification}});bankBillListInfo.getProjectStatementByProjectCode(projectCode,identifications)}}});$(".association-sure-btn").on("click",function(){var paymentListAdd=[];$(".company-tbody,.person-tbody").find('label input[type="checkbox"]:checked').each(function(){if($(this).hasClass("statement-check")){}else{var paymentType="";var paymentValue=$(this).val();if($(this).parents("tr").find("td").length>6){paymentType="2"}else{paymentType="1"}var paymentListAddArr={paymentType:paymentType,paymentValue:paymentValue};paymentListAdd.push(paymentListAddArr)}});var paymentListDelete=[];$(".company-tbody,.person-tbody").find('input.statement-check').not("input:checked").each(function(){var paymentType="";var paymentValue=$(this).val();if($(this).parents("tr").find("td").length>6){paymentType="2"}else{paymentType="1"}var paymentListDeleteArr={paymentType:paymentType,paymentValue:paymentValue};paymentListDelete.push(paymentListDeleteArr)});var identifications="";$(".project-tbody").find('label input[type="checkbox"]:checked').each(function(i,v){var identification=$(this).parents("tr").find("input.identification").val();if(i==0){identifications=identification}else{identifications+=","+identification}});bankBillListInfo.addNotReconciliations(projectCode,identifications,bankStatementDetailsIds,JSON.stringify(paymentListDelete),JSON.stringify(paymentListAdd),"");});bankBillListInfo.getNotReconciliations(identifications);$(".alert-table-div").show();$(".alert-div-input").show();$("#confiscate-amount").hide();$("#user-name").css({float:"left",'margin':"0px 0px 0px 20px"});$("#last-amount").css({float:"left",'margin':"0px 0px 0px 100px"});$("#form-class").css({float:"left",'margin':"0px 0px 0px 70px"});$(".select-teacher-div").width("1100px");$(".yt-edit-alert-main").height("736px");$(".select-teacher-div").show();$yt_alert_Model.setFiexBoxHeight($(".select-teacher-div .yt-edit-alert-main"));$yt_alert_Model.getDivPosition($(".select-teacher-div"));$yt_model_drag.modelDragEvent($(".select-teacher-div .yt-edit-alert-title"));$("select").niceSelect();$('.select-teacher-canel-btn').click(function(){$(".yt-edit-alert,#heard-nav-bak").hide();$("#pop-modle-alert").hide()})},addNotReconciliations:function(projectCode,identifications,bankStatementDetailsIds,paymentListDelete,paymentListAdd,uncollectedTotal){$.ajax({url:$yt_option.base_path+"finance/projectStatement/addNotReconciliations",type:"post",before:function(){$yt_baseElement.showLoading()},data:{projectCode:projectCode,bankStatementDetailsIds:bankStatementDetailsIds,identifications:identifications,paymentListDelete:paymentListDelete,paymentListAdd:paymentListAdd,uncollectedTotal:uncollectedTotal},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("关联成功");$('.person-page').pageInfo("refresh");$('.page1').pageInfo("refresh")});$(".identifications-div").text(data.data)}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("关联失败")})}}})},getProjectStatementByProjectCode:function(projectCode,identifications){$.ajax({url:$yt_option.base_path+"finance/projectStatement/getProjectStatementByProjectCode",type:"post",data:{projectCode:projectCode,identifications:identifications},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){$.each(data.data,function(i,v){$(".company-tbody,.person-tbody").find('input[type="checkbox"]').each(function(j,n){if($(this).parents("tr").find("td").length<6){if($(this).val()==v.paymentValue&&v.paymentType=="1"){$(this).setCheckBoxState("check");$(this).addClass("statement-check")}}else{if($(this).val()==v.paymentValue&&v.paymentType=="2"){$(this).setCheckBoxState("check");$(this).addClass("statement-check")}}})})}else{$yt_alert_Model.alertOne("查询失败")}$yt_baseElement.hideLoading()}})},getBankStatementDetails:function(){var pkId=$yt_common.GetQueryString("pkId");$.ajax({url:$yt_option.base_path+"finance/bankStatement/getBankStatementDetails",type:"post",data:{pkId:pkId},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){$(".bill-info-table").setDatas(data.data);var htmlTr="";var htmlTbody=$(".invalid-tbody");var noEffectiveList=JSON.parse(data.data.noEffectiveList);htmlTbody.empty();$.each(noEffectiveList,function(i,v){htmlTr='<tr><td>'+(i+1)+'</td><td>'+v.exchangeHour+'</td><td class="invalid-hide" style="text-align:right;display:none">'+v.draw+'</td><td style="text-align:right;">'+v.income+'</td><td class="invalid-hide" style="text-align:right;display:none"">'+v.balance+'</td><td class="invalid-hide" style="display:none">'+v.currency+'</td><td>'+v.otherPartyName+'</td><td>'+v.otherPartyAccounts+'</td><td>'+v.otherPartyGroup+'</td><td class="invalid-hide" style="display:none">'+v.accountDate+'</td><td class="invalid-hide" style="display:none">'+v.bankTradeNumber+'</td><td class="invalid-hide" style="display:none">'+v.enterpriseTradeNumber+'</td><td class="invalid-hide" style="display:none">'+v.voucherType+'</td><td class="invalid-hide" style="display:none">'+v.voucherNo+'</td><td class="invalid-hide" style="display:none">'+v.associatedAccount+'</td><td class="invalid-hide" style="display:none">'+v.alias+'</td><td>'+v.abstractData+'</td><td>'+v.remarks+'</td></tr>';htmlTbody.append(htmlTr)});$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}}})},getBillListInfo:function(isAdmission){$yt_baseElement.showLoading();var keyword=$('#keyword').val();var pkId=$yt_common.GetQueryString("pkId");$('.page1').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"finance/bankStatement/getBankStatementDetailsList",type:"post",data:{selectParam:keyword,pkId:pkId,isAdmission:isAdmission,isClaimUser:"2"},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){var htmlTbody=$('.project-tbody');var htmlTr='';htmlTbody.empty();if(data.data!=null){var num=0;$.each(data.data.rows,function(i,v){num+=1;if(data.data.paymentList.length!=0){$.each(data.data.paymentList,function(j,n){var bool=true;if(v.identification==n.identification){htmlTr='<tr class="'+i+'"><td style="text-align: center;" class="merge"><label class="check-label yt-checkbox select-teacher-checkbox"><input type="checkbox" name="test" class="pkId" value="'+v.pkId+'"/></label></td><td class="merge">'+(i+1)+'</td><td class="merge">'+v.exchangeHour+'</td><td class="bank-th-hide merge" style="text-align:right;display:none">'+v.draw+'</td><td class="merge" style="text-align:right">'+v.income+'</td><td class="bank-th-hide merge" style="text-align:right;display:none">'+v.balance+'</td><td class="bank-th-hide merge" style="display:none">'+v.currency+'</td><td class="otherPartyName merge">'+v.otherPartyName+'</td><td class="bank-th-hide merge" style="display:none"><input class="identification" style="display:none;" value="'+v.identification+'">'+v.otherPartyAccounts+'</td><td class="bank-th-hide merge" style="display:none">'+v.otherPartyGroup+'</td><td class="bank-th-hide merge" style="display:none">'+v.accountDate+'</td><td class="bank-th-hide merge" style="display:none">'+v.abstractData+'</td><td class="merge">'+v.remarks+'</td><td class="bank-th-hide merge" style="display:none">'+v.enterpriseTradeNumber+'</td><td class="bank-th-hide merge" style="display:none">'+v.voucherType+'</td><td class="bank-th-hide merge" style="display:none">'+v.voucherNo+'</td><td class="bank-th-hide merge" style="display:none">'+v.associatedAccount+'</td><td class="bank-th-hide merge" style="display:none">'+v.alias+'</td><td class="merge">'+v.bankTradeNumber+'</td><td class="payment-list merge-last" style="border-bottom: 1px #fff solid;border-top: none;background: #FFFFFF;width: 10px;"></td><td class="project-th-hide payment-list merge-last" style="display: none;"><input class="identification-last" style="display:none;" value="'+n.identification+'">'+ +n.projectSell+'</td><td class="project-th-hide payment-list merge-last" style="display: none;">'+n.claimDate+'</td><td class="payment-list merge-last">'+n.projectName+'</td><td class="payment-list merge-last">'+n.projectDate+'</td><td class="payment-list merge-last">'+n.traineeOrGroupName+'</td><td class="project-th-hide payment-list merge-last" style="display: none;">'+n.orgName+'</td><td class="payment-list merge-last" style="text-align:right;">'+n.uncollectedTotal+'</td><td class="payment-list merge-last" style="text-align:right;">'+n.uncollectedTotal+'</td><td class="payment-list merge-last" style="text-align:right;">'+n.admissiontotal+'</td><td class="payment-list merge-last" style="text-align:right;">'+n.differencetotal+'</td><td class="payment-list merge-last">'+(bankBillListInfo.confirmFunc(n.reconciliationState))+'</td><td class="payment-list merge-last">'+n.admissionConfirmUser+'</td></tr>';htmlTbody.append(htmlTr);bool=false}else if(bool){htmlTr='<tr class="'+i+'"><td style="text-align: center;" class="merge"><label class="check-label yt-checkbox select-teacher-checkbox"><input type="checkbox" name="test" class="pkId" value="'+v.pkId+'"/></label></td><td class="merge">'+(i+1)+'</td><td class="merge">'+v.exchangeHour+'</td><td class="bank-th-hide merge" style="text-align:right;display:none">'+v.draw+'</td><td class="merge" style="text-align:right">'+v.income+'</td><td class="bank-th-hide merge" style="text-align:right;display:none">'+v.balance+'</td><td class="bank-th-hide merge" style="display:none">'+v.currency+'</td><td class="otherPartyName merge">'+v.otherPartyName+'</td><td class="bank-th-hide merge" style="display:none"><input class="identification" style="display:none;" value="'+v.identification+'">'+v.otherPartyAccounts+'</td><td class="bank-th-hide merge" style="display:none">'+v.otherPartyGroup+'</td><td class="bank-th-hide merge" style="display:none">'+v.accountDate+'</td><td class="bank-th-hide merge" style="display:none">'+v.abstractData+'</td><td class="merge">'+v.remarks+'</td><td class="bank-th-hide merge" style="display:none">'+v.enterpriseTradeNumber+'</td><td class="bank-th-hide merge" style="display:none">'+v.voucherType+'</td><td class="bank-th-hide merge" style="display:none">'+v.voucherNo+'</td><td class="bank-th-hide merge" style="display:none">'+v.associatedAccount+'</td><td class="bank-th-hide merge" style="display:none">'+v.alias+'</td><td class="merge">'+v.bankTradeNumber+'</td><td class="payment-list merge-last" style="border-bottom: 1px #fff solid;border-top: none;background: #FFFFFF;width: 10px;"></td><td class="project-th-hide payment-list merge-last" style="display: none;"><input class="identification-last" style="display:none;" value=""></td><td class="project-th-hide payment-list merge-last" style="display: none;"></td><td class="payment-list merge-last"></td><td class="payment-list merge-last"></td><td class="payment-list merge-last"></td><td class="project-th-hide payment-list merge-last" style="display: none;"></td><td class="payment-list merge-last" style="text-align:right;"></td><td class="payment-list merge-last" style="text-align:right;"></td><td class="payment-list merge-last" style="text-align:right;"></td><td class="payment-list merge-last" style="text-align:right;"></td><td class="payment-list merge-last"></td><td class="payment-list merge-last"></td></tr>';htmlTbody.append(htmlTr)}});if($(".payment-list").hasClass("hide")){$(".payment-list").removeClass("hide");$(".payment-list-show").show()}}else{htmlTr='<tr><td style="text-align: center;"><label class="check-label yt-checkbox select-teacher-checkbox"><input type="checkbox" name="test" class="pkId" value="'+v.pkId+'"/></label></td><td>'+(i+1)+'</td><td>'+v.exchangeHour+'</td><td class="bank-th-hide" style="text-align:right;display:none">'+v.draw+'</td><td style="text-align:right">'+v.income+'</td><td class="bank-th-hide" style="text-align:right;display:none">'+v.balance+'</td><td class="bank-th-hide" style="display:none">'+v.currency+'</td><td class="otherPartyName">'+v.otherPartyName+'</td><td class="bank-th-hide" style="display:none"><input class="identification" style="display:none;" value="'+v.identification+'">'+v.otherPartyAccounts+'</td><td class="bank-th-hide" style="display:none">'+v.otherPartyGroup+'</td><td class="bank-th-hide" style="display:none">'+v.accountDate+'</td><td class="bank-th-hide" style="display:none">'+v.abstractData+'</td><td>'+v.remarks+'</td><td class="bank-th-hide" style="display:none">'+v.enterpriseTradeNumber+'</td><td class="bank-th-hide" style="display:none">'+v.voucherType+'</td><td class="bank-th-hide" style="display:none">'+v.voucherNo+'</td><td class="bank-th-hide" style="display:none">'+v.associatedAccount+'</td><td class="bank-th-hide" style="display:none">'+v.alias+'</td><td>'+v.bankTradeNumber+'</td><td class="payment-list" style="border-bottom: 1px #fff solid;border-top: none;background: #FFFFFF;width: 10px;"></td><td class="project-th-hide payment-list" style="display: none;"></td><td class="project-th-hide payment-list" style="display: none;"></td><td class="payment-list"></td><td class="payment-list"></td><td class="payment-list"></td><td class="project-th-hide payment-list" style="display: none;"></td><td class="payment-list" style="text-align:right;"></td><td class="payment-list" style="text-align:right;"></td><td class="payment-list" style="text-align:right;"></td><td class="payment-list" style="text-align:right;"></td><td class="payment-list"></td><td class="payment-list"></td></tr>';htmlTbody.append(htmlTr);$(".payment-list").addClass("hide");$(".payment-list").hide();$(".bank-list-table").css("width","100%")}})}else{$yt_baseElement.showLoading();htmlTr='<tr style="border:0px;background-color:#fff !important;" ><td colspan="18" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';$(".project-tbody").html(htmlTr);$yt_baseElement.hideLoading()}debugger;var num=$(".project-tbody").find('label input[type="checkbox"]').length;$(".num").text(num);$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}$("project-tbody")},isSelPageNum:true })},getProjectInfo:function(){$yt_baseElement.showLoading();var selectParam="";$.ajax({async:true,url:$yt_option.base_path+"finance/projectStatement/getProjects",type:"post",data:{selectParam:selectParam},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){if(data.data&&data.data&&data.data.length>0){$.each(data.data,function(i,v){$("select.project-name-select").append($('<option value="'+v.projectCode+'">'+v.projectName+'</option>'))});$('select.project-name-select').niceSelect()}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败");$yt_baseElement.hideLoading()})}},})},getNoDetailedList:function(projectCode){$.ajax({url:$yt_option.base_path+"finance/settlement/getNoDetailedList",async:false,type:"post",data:{projectCode:projectCode},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){var htmlTbody=$('.company-tbody');var htmlTr='';htmlTbody.empty();if(data.data.length>0){$.each(data.data,function(i,v){htmlTr='<tr><td style="text-align: center;"><label class="check-label yt-checkbox unit-checkbox"><input type="checkbox" name="test" class="groupId" value="'+v.groupId+'"/></label></td><td style="text-align:left">'+v.groupName+'</td><td style="text-align:right">'+v.amountReceivable+'</td><td style="text-align:right">'+v.netReceipts+'</td><td style="text-align:right">'+v.uncollected+'</td></tr>';htmlTbody.append(htmlTr)})}else{htmlTbody.html("");htmlTr='<tr style="border:0px;background-color:#fff !important;" ><td colspan="5" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';htmlTbody.append(htmlTr)}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},getDetailedPersonalList:function(projectCode,keyword){$(".person-page").pageInfo({pageIndexs:1,pageNum:15,pageSize:10,async:false,url:$yt_option.base_path+"finance/settlement/getDetailedPersonalList",type:"post",data:{projectCode:projectCode,selectParam:keyword,trainingExpenseStart:"",trainingExpenseEnd:"",traineeNegotiatedPriceStart:"",traineeNegotiatedPriceEnd:"",quarterageStart:"",quarterageEnd:"",mealFeeStart:"",mealFeeEnd:"",otherChargesStart:"",otherChargesEnd:"",uncollectedStart:"",uncollectedEnd:""},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){var htmlTbody=$('.person-tbody');var htmlTr='';htmlTbody.empty();if(data.data.rows.length>0){$.each(data.data.rows,function(i,v){htmlTr='<tr><td style="text-align: center;"><label class="check-label yt-checkbox personal-checkbox"><input type="checkbox" value="'+v.traineeId+'"/></label></td><td>'+v.groupNum+'</td><td>'+v.realName+'</td><td>'+v.gender+'</td><td style="text-align:left">'+v.groupName+'</td><td style="text-align:left">'+v.groupOrgName+'</td><td style="text-align:right">'+v.smallPlan+'</td><td style="text-align:right">'+v.moneyTotal+'</td><td style="text-align:right">'+v.uncollected+'</td></tr>';htmlTbody.append(htmlTr)})}else{htmlTbody.html("");htmlTr='<tr style="border:0px;background-color:#fff !important;" ><td colspan="9" align="center" style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="../../resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';htmlTbody.append(htmlTr)}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},getNotReconciliations:function(identifications){$.ajax({url:$yt_option.base_path+"finance/projectStatement/getNotReconciliations",type:"post",data:{identifications:identifications},objName:'data',before:function(){$yt_baseElement.showLoading()},success:function(data){if(data.flag==0){$(".not-reconciliations").text(data.data.notReconciliations);$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}}})},accountEntryInfo:function(isAdmission){var pkIds="";$(".project-tbody").find('label input[type="checkbox"]:checked').each(function(i,v){var pkId=$(this).val();if(i==0){pkIds=pkId}else{pkIds+=","+pkId}});if(pkIds==""){$yt_alert_Model.prompt("请选中对账单进行操作")}else{$.ajax({type:"post",url:$yt_option.base_path+"finance/bankStatement/updateAdmission",data:{pkIds:pkIds,isAdmission:isAdmission},success:function(data){if(data.flag==0){$yt_baseElement.hideLoading(function(){if(isAdmission==1){$yt_alert_Model.prompt("确认入账成功")}else{$yt_alert_Model.prompt("取消入账成功")}});$('.page-info').pageInfo("refresh")}else{$yt_baseElement.hideLoading(function(){if(isAdmission==1){$yt_alert_Model.prompt("确认入账失败")}else{$yt_alert_Model.prompt("取消入账失败")}})}$(".bank-list-table").find(".check-all").setCheckBoxState("uncheck")}})}},updateEffectiveInfo:function(isEffective){var pkIds="";$(".project-tbody").find('label input[type="checkbox"]:checked').each(function(i,v){var pkId=$(this).val();if(i==0){pkIds=pkId}else{pkIds+=","+pkId}});if(pkIds==""){$yt_alert_Model.prompt("请选中对账单进行操作")}else{$.ajax({type:"post",url:$yt_option.base_path+"finance/bankStatement/updateEffective",data:{pkIds:pkIds,isEffective:isEffective},success:function(data){if(data.flag==0){$yt_baseElement.hideLoading(function(){if(isEffective==1){$yt_alert_Model.prompt("标记有效成功")}else{$yt_alert_Model.prompt("标记无效成功")}});$('.page-info').pageInfo("refresh")}else{$yt_baseElement.hideLoading(function(){if(isEffective==1){$yt_alert_Model.prompt("标记有效失败")}else{$yt_alert_Model.prompt("标记无效失败")}})}$(".bank-list-table").find(".check-all").setCheckBoxState("uncheck")}})}},updateAdmission:function(isPublish){var pkIds="";$(".project-tbody").find('label input[type="checkbox"]:checked').each(function(i,v){var pkId=$(this).val();if(i==0){pkIds=pkId}else{pkIds+=","+pkId}});if(pkIds==""){$yt_alert_Model.prompt("请选中对账单进行操作")}else{$.ajax({type:"post",url:$yt_option.base_path+"finance/bankStatement/updateAdmission",data:{pkIds:pkIds,isPublish:isPublish},success:function(data){if(data.flag==0){$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("认领成功")});$('.page-info').pageInfo("refresh")}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("认领失败")})}$(".bank-list-table").find(".check-all").setCheckBoxState("uncheck")}})}},mergeFunc:function(){var trClass="";var num=1;$(".project-tbody").children().each(function(){try{if(trClass==$(this).attr("class")){$(this).find("td.merge").remove();num+=1}}catch(e){}finally{trClass=$(this).attr("class");$("tr."+trClass).find("td.merge").attr("rowspan",num);}})},confirmFunc:function(confirm){if(confirm==1){return "已入账"}else if(confirm==0){return "未入账"}}};$(function(){bankBillListInfo.init()});