var projectList = {
	//差旅报销初始化方法
	init: function() {
		//获取一条详细信息
		projectList.getOneListInfo();
		
		//取消按钮
		/*
		$('#last-cancel').click(function(){
			window.location.href = "reimbursementList.html";
		});*/
		//返回按钮
		$('.back-btn').click(function(){
			window.location.href = "reimburseTravelDetails.html";
		});
	},

//----------------------------------------流程--------------------------------------------------------	
	//详细信息
	getOneListInfo: function() {
		$yt_baseElement.showLoading();
		var pkId = $yt_common.GetQueryString("pkId");
		
		$.ajax({
			type: "post",
			url: $yt_option.base_path + "finance/teacherExpense/getBeanByIdTravel",
			async: false,
			data: {
				pkId: pkId
			},
			objName: 'data',
			success: function(data) {
				if(data.flag == 0) {
					//班级名
					$('#projectName').text(data.data.projectName);
					//班级编号
					$('#projectCode').text(data.data.projectCode);
					//流水号
					$('#flowNumber').text(data.data.flowNumber);
					//项目主任
					$('#projectHead').text(data.data.projectHead);
					//申请人
					$('#createUser').text(data.data.createUser);
					//申请时间
					$('#createTimeString').text(data.data.createTimeString);
					//状态
					$('.state-type').text(data.data.workFlawState);
					//流程
					var flowLog = JSON.parse(data.data.flowLog);
					var middleStepHtml;
					var length=flowLog.length;
					$.each(flowLog, function(i,v) {
						//如果i等于0是最后一步流程
						/*if(i==0){
							//流程编号
							$('.last-step-order').text(length);
							//操作人名
							$('.last-step-operate-person-userName').text(v.userName);
							//操作状态
							$('.last-step-operationState').text(v.taskName);
							//停滞时间							
							$('.last-step-commentTime').text(v.commentTime);
						};*/
						//如果i等于length-1是流程的第一步
						if(i==length-1){
							//流程编号
							$('.first-step-order').text(1);
							//操作人名
							$('.first-step-operate-person-userName').text(v.userName);
							//当前审批节点名字
							$('.first-step-taskName').text(v.taskName);
							//时间
							$('.first-step-commentTime').text(v.commentTime);
							//审批意见
							$('.first-step-comment').text(v.comment);
							
						};
						//如果i不等于且不等于length-1，是流程的中间步骤
						if(i!= length-1){
							//流程序号
							var order=length-i;
							middleStepHtml='<div>'+	
												'<div style="height: 150; ">'+
													'<div class="number-name-box">'+
														'<span class="number-box-span middle-step-order middle-a-index" >'+order+'</span>'+
														'<span class="name-box-span middle-step-userName middle-a-index" >'+v.userName+'</span>'+
														'<img src="../../resources/images/open/open-sp.png" class="order-img" />'+
													'</div>'+
												'</div>'+
												'<div class="middle-step-box-div">'+
													'<ul class="middle-step-box-ul">'+
														'<li style="height: 30px;">'+
															'<span  class="middle-step-taskName view-taskName-span"  style="float: left;">'+v.taskName+'</span>'+
														'</li>'+
														'<li class="view-time-li middle-step-commentTime" style="width:200px;">'+v.commentTime+'</li>'+
														'<li class="operate-view-box-li">'+
															'<div class="operate-view-title-li">操作意见：</div>'+
															'<div class="operate-view-text-li middle-step-comment">'+v.comment+'</div>'+
														'</li>'+
													'</ul>'+
												'</div>'+
											'</div>';
							$('.last-step').append(middleStepHtml);
						};
					});
					$yt_baseElement.hideLoading();
				} else {
					$yt_baseElement.hideLoading(function (){
						$yt_alert_Model.prompt("查询失败");
					});
				}
			}
		});
	},

};
$(function() {
	//初始化方法
	projectList.init();
});