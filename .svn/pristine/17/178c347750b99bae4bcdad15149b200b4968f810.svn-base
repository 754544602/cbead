var versionMgr={init:function(){versionMgr.events();$("#versionMgr").css("min-height",$(window).height()-32);$("#beginDate").calendar({nowData:false,upperLimit:$("#endDate"),speed:0,callback:function(){}});$("#endDate").calendar({nowData:false,lowerLimit:$("#beginDate"),speed:0,callback:function(){}})},events:function(){$("#resetBtn").click(function(){$("#beginDate,#endDate,#versionId").val("");versionMgr.getVersionList()});$("#heardSearchBtn").click(function(){versionMgr.getVersionList()});$("#addBtn").click(function(){versionMgr.showAlert()});$("#upBtn").click(function(){var selTrLen=$("#tableList tbody tr.yt-table-active").length;if(selTrLen==0){$yt_alert_Model.prompt("请选择一行数据进行操作")}else{var thisTr=$("#tableList tbody tr.yt-table-active");var versionId=thisTr.find(".version-id").val();$(".yt-edit-alert .hid-version-id").val(thisTr.find(".version-id").val());$(".yt-edit-alert .version-num").val(thisTr.find(".version-num").text());$(".yt-edit-alert .version-description").val(thisTr.find(".version-description").text());versionMgr.showAlert()}})},getVersionList:function(numPage){var queryParams=$("#versionId").val();var startDate=$("#beginDate").val();var endDate=$("#endDate").val();$('.version-table-page').pageInfo({pageIndex:numPage==undefined?"1":numPage,pageNum:15,pageSize:10,url:"basicconfig/version/getVersionlistByParams",type:"post",data:{queryParams:queryParams,startDate:startDate,endDate:endDate},objName:'data',success:function(data){var htmlTbody=$('#tableList .yt-tbody');htmlTbody.empty();var trStr="";if(data.flag==0){var datas=data.data.rows;if(datas.length>0){$(".version-table-page").show();var trDoc='';$.each(datas,function(i,n){trDoc='<tr><td><input class="version-id" value="'+n.versionId+'" type="hidden"><span class="version-num">'+n.versionNum+'</span></td><td style="text-align: left;" class="version-description">'+n.versionDescription+'</td><td>'+n.versionTime+'</td></tr>';$("#tableList tbody").append(trDoc)})}else{htmlTbody.append(versionMgr.noDataTrStr(3));$(".version-table-page").hide()}}},isSelPageNum:true })},showAlert:function(){$(".yt-edit-alert,#heard-nav-bak").show();$yt_alert_Model.getDivPosition($(".yt-edit-alert"));$(".yt-edit-alert").off().on("click",".version-save-btn",function(){if($("input[name='versionNum']").val()==null||$.trim($("input[name='versionNum']").val()).length==0){$yt_alert_Model.prompt("版本号不能为空!");return}var versionId=$(".yt-edit-alert .hid-version-id").val();var versionNum=$(".yt-edit-alert .version-num").val();var versionDescription=$(".yt-edit-alert .version-description").val();if(!versionId){$.ajax({type:"post",url:"basicconfig/version/saveVersionInfo",data:{versionNum:versionNum,versionDescription:versionDescription},success:function(data){if(data.flag==0){$yt_alert_Model.prompt("提交成功");$("input[name='versionNum']").val("");$(".yt-edit-alert .hid-version-id").val("");$("textarea[name='versionDescription']").val("");$(".yt-edit-alert,#heard-nav-bak").hide();$("#pop-modle-alert").hide();var thisPage=$(".version-table-page .active").text();versionMgr.getVersionList(thisPage)}else{$yt_alert_Model.prompt("提交失败")}}})}else{$.ajax({type:"post",url:"basicconfig/version/updateVersionInfo",data:{versionId:versionId,versionNum:versionNum,versionDescription:versionDescription},success:function(data){if(data.flag==0){$yt_alert_Model.prompt("编辑成功");$("input[name='versionNum']").val("");$("textarea[name='versionDescription']").val("");$(".yt-edit-alert .hid-version-id").val("");$(".yt-edit-alert,#heard-nav-bak").hide();$("#pop-modle-alert").hide();var thisPage=$(".version-table-page .active").text();versionMgr.getVersionList(thisPage)}else{$yt_alert_Model.prompt("编辑失败")}}})}});$('.yt-edit-alert .yt-eidt-model-bottom .yt-model-canel-btn').off().on("click",function(){$(".yt-edit-alert .hid-version-id").val("");$("input[name='versionNum']").val("");$("textarea[name='versionDescription']").val("");$(".yt-edit-alert,#heard-nav-bak").hide();$("#pop-modle-alert").hide()})},noDataTrStr:function(trNum){var noDataStr='<tr style="border:0px;background-color:#fff !important;"><td  colspan="'+trNum+'" align="center"style="border:0px;"><div class="no-data" style="width: 280px;margin: 0 auto;"><img src="resources/images/common/no-data.png" alt="" style="padding: 35px 0 20px;"></div></td></tr>';return noDataStr}};$(function(){versionMgr.init();versionMgr.getVersionList()});