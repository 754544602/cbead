var classInfo={init:function(){classInfo.getPlanListInfo();$(".add-class").click(function(){$('.ticket-class-title-span').text("结业证编号分配");classInfo.clearAlert();var projectName=$('.yt-table-active .states').text();if(projectName=="待分配"){classInfo.distribution();classInfo.addShowAlert()}else{if(projectName=="已分配"){$yt_alert_Model.prompt("请选择未分配选项")}else{$yt_alert_Model.prompt("请选择待分配选项")}}});$(".winding-up").click(function(){$('.ticket-class-title-span').text("修改");var projectName=$('.yt-table-active .states').text();if(projectName==""){$yt_alert_Model.prompt("请选择要修改项")}else{classInfo.addShowAlert();var serialNumber=$('.yt-table-active .serialNumber').text();$('#serialNumber').val(serialNumber);classInfo.distribution()}});$('.key-word').off().on('click','.search-btn',function(){classInfo.getPlanListInfo()});$('.select-btn-div').off().on('click','.yt-model-sure-btn',function(){classInfo.addOrUpdateSerialNumber();classInfo.getPlanListInfo()})},clearAlert:function(){$('#projectCode').text("");$('#projectName').text("");$('#projectType').text("");$('#projectHead').text("");$('#checkInCount').text("");$('#distributionUser').text("");$('#distributionDate').text("");$('#serialNumber').val("")},distribution:function(){classInfo.clearAlert();var projectCode=$('.yt-table-active .projectCode').text();var projectName=$('.yt-table-active .projectName').text();var projectType=$('.yt-table-active .projectType').text();var projectHead=$('.yt-table-active .projectHead').text();var checkInCount=$('.yt-table-active .checkInCount').text();var distributionUser=$('.yt-table-active .distributionUser').text();var distributionDate=$('.yt-table-active .distributionDate').text();var serialNumber=$('.yt-table-active .serialNumber').text();$('#projectCode').text(projectCode);$('#projectName').text(projectName);$('#projectType').text(projectType);$('#projectHead').text(projectHead);$('#checkInCount').text(checkInCount);$('#distributionUser').text(distributionUser);$('#distributionDate').text(distributionDate);$('#serialNumber').val(serialNumber)},addOrUpdateSerialNumber:function(){var projectCode=$('#projectCode').text();var serialNumber=$('#serialNumber').val();$.ajax({type:"post",url:$yt_option.base_path+"class/addOrUpdateSerialNumber",data:{projectCode:projectCode,serialNumber:serialNumber},async:false,success:function(data){}})},getPlanListInfo:function(){$yt_baseElement.showLoading();var keyword=$('#keyword').val();$('.page-info').pageInfo({pageIndexs:1,pageNum:15,pageSize:10,url:$yt_option.base_path+"class/lookForAllByDistribution",type:"post",data:{selectParam:keyword},objName:'data',success:function(data){if(data.flag==0){var htmlTbody=$('.list-table .yt-tbody');var htmlTr='';var num=1;htmlTbody.empty();if(data.data.rows.length>0){var projectType;var states;var projectStates;$.each(data.data.rows,function(i,v){if(v.projectType==1){projectType="计划"};if(v.projectType==2){projectType="委托"};if(v.projectType==3){projectType="选学"};if(v.projectType==4){projectType="调训"};if(v.states==1){states="已分配"};if(v.states==2){states="待分配"};if(v.projectStates==1){projectStates="未开始"};if(v.projectStates==2){projectStates="培训中"};if(v.projectStates==3){projectStates="已结束"};i=i+1;htmlTr='<tr><td class="projectCode" style="display:none;">'+v.projectCode+'</td><td style="text-align:center;">'+i+'</td><td class="projectName">'+v.projectName+'</td><td style="text-align:center;" class="projectType">'+projectType+'</td><td class="projectHead">'+v.projectHead+'</td><td style="text-align:center;" class="projectStates">'+projectStates+'</td><td style="text-align:center;" class="distributionDate">'+v.distributionDate+'</td><td class="distributionUser">'+v.distributionUser+'</td><td style="text-align:right;" class="checkInCount">'+v.checkInCount+'</td><td style="text-align:center;" class="states">'+states+'</td><td style="text-align:right;" class="serialNumber">'+v.serialNumber+'</td></tr>';htmlTbody.append(htmlTr)})}$yt_baseElement.hideLoading()}else{$yt_baseElement.hideLoading(function(){$yt_alert_Model.prompt("查询失败")})}},isSelPageNum:true })},addShowAlert:function(){$(".add-shuttle-box").show();$yt_alert_Model.getDivPosition($(".add-shuttle-box"));$yt_model_drag.modelDragEvent($(".add-shuttle-box .yt-edit-alert-title"));$('.add-shuttle-box .yt-eidt-model-bottom .yt-model-canel-btn').off().on("click",function(){$(".yt-edit-alert,#heard-nav-bak").hide();$("#pop-modle-alert").hide()});$('.add-shuttle-box .yt-eidt-model-bottom .yt-model-sure-btn').off().on("click",function(){$(".yt-edit-alert,#heard-nav-bak").hide();$("#pop-modle-alert").hide()})}};$(function(){classInfo.init()});