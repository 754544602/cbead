var meetingCostApply={init:function(){$("#saveBtn").off().on("click",function(){$yt_valid.validForm($("#meetingDiv"))});$(".get-accommodation,.get-food,.get-other").on("focus",function(){if($(this).val()!=""){$(this).val($yt_baseElement.rmoney($(this).val()))}});$(".get-accommodation,.get-food,.get-other").on("blur",function(){if($(this).val()!=""){$(this).val($yt_baseElement.fmMoney($(this).val()))}});meetingCostApply.getTotalMoney();meetingCostApply.getInputChage()},getInputChage:function(){$("#calculationSession").change(function(){$("#calculationSession").removeClass("calculation-Identification")})},getTotalMoney:function(){$(".get-accommodation,.get-food,.get-other").on("blur",function(){var accommodation=$yt_baseElement.rmoney($(".get-accommodation").val()||'0');var food=$yt_baseElement.rmoney($(".get-food").val()||'0');var other=$yt_baseElement.rmoney($(".get-other").val()||'0');var total=accommodation+food+other;if(total!==0){$("#costTotal,.count-val-num").css("color","#333333").text($yt_baseElement.fmMoney(total));$('.total-money-up,#TotalMoneyUpper').text(arabiaToChinese(total))}else{$("#costTotal").css("color","#999").text("住宿费+伙食费+其他费用")}meetingCostApply.getDayMoney()})},getDayMoney:function(){if($("#calculationSession").hasClass('calculation-Identification')){$("#dailyAverageConsumption").css("color","#999").text("费用合计/【(参会人数+工作人员数量）*会期】")}else{var accommodation=$yt_baseElement.rmoney($(".get-accommodation").val()||'0');var food=$yt_baseElement.rmoney($(".get-food").val()||'0');var other=$yt_baseElement.rmoney($(".get-other").val()||'0');var meetOfNum=$('#meetOfNum').val();var meetWorkerNum=$('#meetWorkerNum').val();var total=accommodation+food+other;var numData= +($("#calculationSession").val());var result=total/[(meetOfNum+meetWorkerNum)*numData];if(result==Infinity){result=0}if(result!=undefined){$("#dailyAverageConsumption").css("color","#333333").text($yt_baseElement.fmMoney(result))}}},getData:function(){$("#startTime").calendar({nowData:false,upperLimit:$("#endTime"),speed:0,callback:function(){sysCommon.clearValidInfo($("#startTime"));var tdStartDate=$("#startTime").val();var tdEndDate=$('#endTime').val();var dateFrom=new Date(tdStartDate);var dateTo=new Date(tdEndDate);if(tdStartDate!=""&&tdEndDate!=""){var diff=dateTo.valueOf()-dateFrom.valueOf();var diff_day=parseInt(diff/(1000*60*60*24));$("#calculationSession").css("color","#333333").val(diff_day+1);$("#calculationSession").removeClass("calculation-Identification");meetingCostApply.getDayMoney()}}});$("#endTime").calendar({nowData:false,lowerLimit:$("#startTime"),speed:0,callback:function(){sysCommon.clearValidInfo($("#endTime"));var tdStartDate=$("#startTime").val();var tdEndDate=$('#endTime').val();var dateFrom=new Date(tdStartDate);var dateTo=new Date(tdEndDate);if(tdStartDate!=""&&tdEndDate!=""){var diff=dateTo.valueOf()-dateFrom.valueOf();var diff_day=parseInt(diff/(1000*60*60*24));$("#calculationSession").css("color","#333333").val(diff_day+1);$("#calculationSession").removeClass("calculation-Identification");meetingCostApply.getDayMoney()}}})},getDictInfoByTypeCode:function(code){$.ajax({type:"post",url:"basicconfig/dictInfo/getDictInfoByTypeCode",async:true,data:{dictTypeCode:'MEET_CODE'},success:function(data){var list=data.data||[];var start='<option value="">请选择</option>';$.each(list,function(i,n){start+='<option '+(code==n.value?'selected="selected"':'')+' value="'+n.value+'">'+n.disvalue+'</option>'});$('#meetingClassification').html(start).niceSelect()}})}};$(function(){$("#meetingDiv select").niceSelect();meetingCostApply.init();meetingCostApply.getData()});