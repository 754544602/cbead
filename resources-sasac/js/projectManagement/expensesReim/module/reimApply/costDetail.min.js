var costDetail={init:function(){costDetail.paymentTotal();var reimAmount=$(".reimAmount").text();if(reimAmount!=''){$(".reimAmount").text($yt_baseElement.fmMoney(reimAmount))}else{$(".reimAmount").text('0.00')};var reimAmountlSum=$("#reimAmountlSum").text();if(reimAmountlSum!=''){$("#reimAmountlSum").text($yt_baseElement.fmMoney(reimAmountlSum))}else{$("#reimAmountlSum").text('0.00')};$("#reimAmount").on("focus",function(){if($(this).val()!=""){$(this).val($yt_baseElement.rmoney($(this).val()))}});$("#reimAmount").on("blur",function(){if($(this).val()!=""){$(this).val($yt_baseElement.fmMoney($(this).val()))}});costDetail.event()},event:function(){$("#costList").on("click",".operate-update",function(){var thisObj=$(this);var reimContent=thisObj.parents('tr').find('.reimContent').text();var reimAmount=thisObj.parents('tr').find('.reimAmount').text();var reimInstructions=thisObj.parents('tr').find('.reimInstructions').text();costDetail.showAlert(thisObj);$("#reimContent").val(reimContent);$("#reimAmount").val(reimAmount);$("#instructions").val(reimInstructions=='无'?'':reimInstructions)});$("#costList").on("click",".operate-del",function(){var thisObj=$(this);$yt_alert_Model.alertOne({alertMsg:"数据删除将无法恢复,确认删除吗?",confirmFunction:function(){thisObj.parents("tr").remove();costDetail.paymentTotal()}})})},showAlert:function(thisObj){if(thisObj!=null){$(".save-btn").show();$(".sure-btn").hide()}else{$(".save-btn").hide();$(".sure-btn").show()}costDetail.clearCPMInfo();$(".yt-edit-alert,#heard-nav-bak").show();$yt_alert_Model.getDivPosition($(".yt-edit-alert"));$(".sure-btn").off().on("click",function(){var isTrue=$yt_valid.validForm($(".valid-tab"));if(isTrue){$yt_alert_Model.prompt("填写的信息已成功加入到列表");var reimContent=$("#reimContent").val();var reimAmount=$("#reimAmount").val();var instructions=$("#instructions").val();instructions=instructions||'无';var trHtml=' <tr class="yt-tab-row"> <td style="text-align:left;" class="reimContent">'+reimContent+'</td> <td style="text-align:right;" class="reimAmount">'+reimAmount+'</td> <td class="reimInstructions">'+instructions+'</td> <td> <span class="operate-update"><img src="../../../../../resources-sasac/images/common/edit-icon.png"></span> <span class="operate-del"><img src="../../../../../resources-sasac/images/common/del-icon.png"></span> </td> </tr>';$("#costList tbody .last").before(trHtml);costDetail.paymentTotal();costDetail.clearCPMInfo()}});$(".save-btn").off().on("click",function(){var isTrue=$yt_valid.validForm($(".valid-tab"));if(isTrue){$(".yt-edit-alert,#heard-nav-bak").hide();$("#pop-modle-alert").hide();var reimContent=$("#reimContent").val();var reimAmount=$("#reimAmount").val();var instructions=$("#instructions").val();thisObj.parents('tr').find('td').eq(0).text(reimContent);thisObj.parents('tr').find('td').eq(1).text(reimAmount);thisObj.parents('tr').find('td').eq(2).text(instructions||'无');costDetail.paymentTotal();costDetail.clearCPMInfo()}});$('.yt-edit-alert .yt-eidt-model-bottom .yt-cancel-btn').off().on("click",function(){costDetail.clearCPMInfo();$(".yt-edit-alert,#heard-nav-bak").hide();$("#pop-modle-alert").hide()})},clearCPMInfo:function(){$("#reimContent").val('').removeClass("valid-hint");$("#reimAmount").val('').removeClass("valid-hint");$(".cost-popm .valid-font").text('');$("#instructions").val('')},dataAttrList:function(){var list=[];var tr=null;var trs=$('#costList tbody tr:not(.last)');;$.each(trs,function(i,n){tr=$(n);list.push({normalId:tr.find('').text(),normalName:tr.find('.reimContent').text(),normalInstructions:tr.find('.reimInstructions').text(),normalAmount:$yt_baseElement.rmoney(tr.find(".reimAmount").text())})});return list},textbtn:function(){$(".text").off().on("click",function(){console.log(costDetail.dataAttrList())})},paymentTotal:function(){var tds=$('#costList tbody .reimAmount');var total=0;$.each(tds,function(i,n){total+=$yt_baseElement.rmoney($(n).text())});var fmTotal=$yt_baseElement.fmMoney(total);$('#applyTotalMoney,.count-val-num,#amountTotalMoney').text(fmTotal);$('#TotalMoneyUpper,.total-money-up').text(arabiaToChinese(total+''));$('#costList tbody #reimAmountlSum').text(fmTotal);var loanAmount=$('#loanAmount').text();loanAmount=loanAmount=='--'?0:$yt_baseElement.rmoney(loanAmount);var outstandingBalance=$yt_baseElement.rmoney($('#outstandingBalance').text());var writeOffAmount=total>=outstandingBalance?outstandingBalance:total;$('#writeOffAmount,#outWriteAmount').text($yt_baseElement.fmMoney(writeOffAmount));var replaceMoney=total>=outstandingBalance?total-writeOffAmount:'0';$('#replaceMoney').text($yt_baseElement.fmMoney(replaceMoney));$('#balanceMoney').text($yt_baseElement.fmMoney(total<outstandingBalance?outstandingBalance-total:'0'))}};$(function(){costDetail.init();costDetail.textbtn()});