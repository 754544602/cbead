var paymentRequest={thisDate:"",init:function(){$("#paymentRequest").css("min-height",$(window).height()-12);paymentRequest.events();$("#startDate").calendar({controlId:"startTime",nowData:true,upperLimit:$("#endDate"),speed:0,callback:function(){}});$("#endDate").calendar({controlId:"endTime",nowData:true,lowerLimit:$("#startDate"),speed:0,callback:function(){}});paymentRequest.thisDate=$("#endDate").val();paymentRequest.tablePage()},events:function(){$(".sort-btn-list").on("click",".date-sort-btn,.money-sort-btn,.clip-sort-btn,.bank-sort-btn",function(){var thisBtn=$(this);if(!thisBtn.hasClass("sort-btn-style")){$(".date-sort-btn,.money-sort-btn,.clip-sort-btn,.bank-sort-btn").removeClass("sort-btn-style");thisBtn.addClass("sort-btn-style")}paymentRequest.tablePage()});$('.export-excel').on('click',function(){var queryParams=$(".query-text").val();queryParams=encodeURI(encodeURI(queryParams));var startDate=$("#startDate").val();var endDate=$("#endDate").val();var sortBtn=$(".sort-btn-style").text();var property="cash";if(sortBtn=="按支出日期倒序排列"){property="paymentDate"}else if(sortBtn=="按公务卡支出金额倒序排列"){property="officialCard"}else if(sortBtn=="按银行转账支出金额倒序排列"){property="transfer"}else if(sortBtn=="按现金支出金额倒序排列"){property="cash"}var urlStr=$yt_option.base_path+'sz/expenditureApp/exportExpenditureInfoListToPageByParams?queryParams='+queryParams+'&startDate='+startDate+'&endDate='+endDate+'&property='+property+'&direction=DESC';if(typeof(downloadIframe)=="undefined"){var iframe=document.createElement("iframe");downloadIframe=iframe;document.body.appendChild(downloadIframe)}downloadIframe.src=urlStr;downloadIframe.style.display="none"});$("#heardSearchBtn").click(function(){paymentRequest.tablePage()});$("#resetBtn").click(function(){$(".query-text").val("");$("#startDate").val(paymentRequest.thisDate);$("#endDate").val(paymentRequest.thisDate);$(".date-sort-btn,.money-sort-btn,.clip-sort-btn,.bank-sort-btn").removeClass("sort-btn-style");paymentRequest.tablePage()});$('.payment-table').on('click','.to-detail',function(){var thisTr=$(this).parents("tr");var advanceAppId=thisTr.find('.appid-td').val();var pageUrl="view/system-sasac/expensesReim/module/reimApply/expenseDetail.html?appId="+advanceAppId;$yt_baseElement.openNewPage(2,pageUrl)})},tablePage:function(){var queryParams=$(".query-text").val();var startDate=$("#startDate").val();var endDate=$("#endDate").val();var sortBtn=$(".sort-btn-style").text();var property="cash";if(sortBtn=="按支出日期倒序排列"){property="paymentDate"}else if(sortBtn=="按公务卡支出金额倒序排列"){property="officialCard"}else if(sortBtn=="按银行转账支出金额倒序排列"){property="transfer"}else if(sortBtn=="按现金支出金额倒序排列"){property="cash"}$('.payment-table-page').pageInfo({pageIndex:1,pageNum:15,pageSize:5,url:'sz/expenditureApp/getExpenditureInfoListToPageByParams',type:"post",async:false,data:{queryParams:queryParams,startDate:startDate,endDate:endDate,property:property,direction:'DESC'},success:function(data,pageObj){var htmlTbody=$('.payment-table .yt-tbody');htmlTbody.empty();var trStr="";if(data.flag==0){$("#cashAmount").text($yt_baseElement.fmMoney(data.data.cashTotalAmount));$("#businessCardAmount").text($yt_baseElement.fmMoney(data.data.officialCardTotalAmount));$("#bankTransferAmount").text($yt_baseElement.fmMoney(data.data.transferTotalAmount));var datas=data.data.rows;if(datas.length>0){$('.payment-table-page').show();$.each(datas,function(i,n){trStr+='<tr><td><a class="yt-link to-detail"><input type="hidden" value="'+n.expenditureAppId+'" class="appid-td"/>'+n.expenditureAppNum+'</a></td><td style="text-align: right;">'+$yt_baseElement.fmMoney(n.cash)+'</td><td style="text-align: right;">'+$yt_baseElement.fmMoney(n.officialCard)+'</td><td style="text-align: right;">'+$yt_baseElement.fmMoney(n.transfer)+'</td><td style="text-align: right;">'+$yt_baseElement.fmMoney(n.paymentAmount)+'</td><td style="text-align: left;">'+n.expenditureAppName+'</td><td>'+n.applicantUserName+'</td><td>'+n.paymentDate+'</td></tr>'});htmlTbody.append(trStr)}else{$('.payment-table-page').hide();htmlTbody.append(sysCommon.noDataTrStr(8))}}},isSelPageNum:true })}};$(function(){paymentRequest.init()});