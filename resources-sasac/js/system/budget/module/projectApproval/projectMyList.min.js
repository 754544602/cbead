var project={thisDate:"",init:function(){$("#paymentRequest").css("min-height",$(window).height()-12);project.events();$("#startDate").calendar({controlId:"startTime",upperLimit:$("#endDate"),speed:0,nowData:false,callback:function(){}});$("#endDate").calendar({controlId:"endTime",lowerLimit:$("#startDate"),speed:0,nowData:false,callback:function(){}});project.tablePage()},events:function(){$("#heardSearchBtn").click(function(){project.tablePage()});$("#resetBtn").click(function(){$(".query-text").val("");$("#startDate").val(project.thisDate);$("#endDate").val(project.thisDate);project.tablePage()});$('.projetc-table').on('click','.to-detail',function(){var draData=$(this).parents('tr').data('draData');$yt_baseElement.eventStopPageaction();var pageUrl="view/system-sasac/budget/module/projectApproval/budgetApprovalDetails.html?budgetPrjAppId="+draData.budgetPrjAppId+'&processInstanceId='+draData.processInstanceId;$yt_baseElement.openNewPage(2,pageUrl)});$(".projetc-table").on('click','.process-state',function(){var draData=$(this).parents('tr').data('draData');sysCommon.processStatePop(draData.processInstanceId)})},tablePage:function(){var queryParams=$(".query-text").val();var startDate=$("#startDate").val();var endDate=$("#endDate").val();$('.payment-table-page').pageInfo({pageIndex:1,pageNum:15,pageSize:5,url:'budget/prjApp/getBudgetPrjAppInfoWFListToPageByParams',type:"post",async:false,data:{queryParams:queryParams,startTime:startDate,endTime:endDate},success:function(data,pageObj){var htmlTbody=$('.projetc-table .yt-tbody');htmlTbody.empty();var trStr="";if(data.flag==0){var datas=data.data.rows;if(datas.length>0){$('.payment-table-page').show();sysCommon.isWorkFlowStateStr=','+sysCommon.isWorkFlowStateStr+',';$.each(datas,function(i,n){trStr+='<tr><td>'+n.applicantTime+'</td><td><a class="yt-link to-detail">'+n.budgetPrjAppNum+'</a></td><td style="text-align: left;" class="text-overflow" title="'+n.prjName+'">'+n.prjName+'</td><td style="text-align: left;" class="text-overflow" title="'+n.prjUnitName+'">'+n.prjUnitName+'</td><td>'+n.prjClassifyName+'</td>';if(sysCommon.isWorkFlowStateStr.indexOf(','+n.workFlowState+',')==-1){trStr+='<td style=""><span class="yt-link process-state">'+n.nodeNowState+'</span></td>'}else{trStr+='<td style="">'+n.nodeNowState+'</td>'}trStr+='</tr>';trStr=$(trStr).data("draData",n);htmlTbody.append(trStr)})}else{$('.payment-table-page').hide();htmlTbody.append(sysCommon.noDataTrStr(6))}}},isSelPageNum:true })}};$(function(){project.init()});